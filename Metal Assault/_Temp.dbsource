GLOBAL pseu_old_saisie_clavier$
GLOBAL pseu_saisie_clavier$
GLOBAL pseu_ligne$
GLOBAL pseu_a_gauche_du_curseur$
GLOBAL pseu_a_droite_du_curseur$
GLOBAL pseu_ligne_final$
GLOBAL pseu_old_azerty
GLOBAL pseu_azerty
GLOBAL pseu_newtime
GLOBAL pseu_cursor_position=1
GLOBAL pseu_longueur_ligne
GLOBAL pseu_curseur_visible
GLOBAL Configjoueur$
GLOBAL Config_profilselect
GLOBAL CheminMA$
GLOBAL temp

type arme
name$ as string
price as integer
poid as integer
Chargeur_start as integer
BuletsparChargeur as integer
Bulets_Stock as integer
Bulets_encour as integer
Bulets_ametre as integer
endtype

type Goliath
X as integer
Y as integer
Z as integer
Vitesse as integer
Gachette_etat as integer
occupe as integer
endtype

type Vautour
X# as float
Y# as float
Z# as float
tourelle_occupe as integer
pilote_occupe as integer
xspeed# as float
yspeed# as float
anglX# as float
anglY# as float
oldX# as float
oldY# as float
oldZ# as float
porte as float
collide as float
endtype

type V2CI
X# as float
Y# as float
Z# as float
tourelle_occupe as integer
pilote_occupe as integer
xspeed# as float
yspeed# as float
anglX# as float
anglY# as float
oldX# as float
oldY# as float
oldZ# as float
porte as float
collide as float
endtype

type Coleoptere
X# as float
Y# as float
Z# as float
tourelle_occupe as integer
pilote_occupe as integer
xspeed# as float
yspeed# as float
anglX# as float
anglY# as float
oldX# as float
oldY# as float
oldZ# as float
porte as float
collide as float
collide2 as float
endtype

type Escompide
X# as float
Y# as float
Z# as float
tourelle_occupe as integer
pilote_occupe as integer
xspeed# as float
yspeed# as float
anglX# as float
anglY# as float
oldX# as float
oldY# as float
oldZ# as float
porte as float
collide as float
collide2 as float
endtype

type MotoD
X# as float
Y# as float
Z# as float
tourelle_occupe as integer
pilote_occupe as integer
xspeed# as float
yspeed# as float
anglX# as float
anglY# as float
oldX# as float
oldY# as float
oldZ# as float
porte as float
collide as float
collide2 as float
endtype

type txt
string$ as string
size as integer
red as integer
green as integer
blue as integer
X as integer
Y as integer
img_nb as integer
sprite_nb as integer
temp as integer
lastspeed as integer
endtype

type droide
name$ as string
Vie as integer
Decision as integer
DecisionDuree as integer
DecisionVitesse# as float
Precision as integer
temptir as integer
tirpossible as integer
cible as integer
objet as integer
tete as integer
collide as integer
tircollide as integer
x# as float
y# as float
z# as float
xtemp# as float
ytemp# as float
ztemp# as float
oX# as float
oY# as float
oZ# as float
tipe as integer
respawn_pt as integer
Rspn as integer
cible as integer
frag as integer
mort as integer
endtype

type Water
ObjNum as integer
ImgNum as integer
ImgNum2 as integer
ImgNum3 as integer
ImgNum4 as integer
FXNum as integer
technique as integer
Reflect as integer
Refract as integer
R as integer
G as integer
B as integer
Image$ as string
SX as integer
SZ as integer
X as integer
WaterHeight# as float
Z as integer
WaterCamY# as float
Ghost as integer
CamA as integer
CamB as integer
ClipY# as float
endtype



rem Chargement de la configuration du jeu
open to read 1,"metal Assault.ini"
read string 1,Configjoueur$
read string 1,Lireintro$
Lireintro = val(Lireintro$)
close file 1
CheminMA$ = get dir$()
dim param(60)
dim Config_keymap$(9)
dim Player_stats(10)
dim listarme(100) as arme
set dir CheminMA$+"\configs\"+Configjoueur$
load array "param.txt",param(60)
load array "keymap.txt",Config_keymap$(9)
load array "Stats.txt",Player_stats(10)
dim Solo_CarteNom$(256)
dim zikname$(256)
dim Solo_dompts(256,4)
dim Solo_dompts_Dcibles(256,4)
dim Script_datas$(10000)
dim Config_listeprofil$(10)
dim txt(256) as txt
dim contour(100,4)
dim Bot(10000) as droide
dim allie(10000) as droide
dim nomhumain$(41)
global dim Water(256) as water
Global Water_Exist = 0
dim Goliaths(100) as Goliath
dim Vautours(100) as Vautour
dim Escompides(100) as Escompide
dim V2CIs(100) as V2CI
dim MotoDs(100) as motoD
dim Coleopteres(100) as coleoptere
gosub Setup_database
randomize timer()


rem on vois si on peut enregistrer le chemin de MA dans un lieu sur, pour les MAJ
set dir windir$()+"\system32\"
if file exist("ma.ini") = 0
open to write 1,"ma.ini"
write string 1,CheminMA$
endif
close file 1

rem initialisation du Système
set display mode param(35),param(36),param(37)
cls
make memblock 154,1 : rem pour les DLLs
hide mouse
disable escapekey
set text font "arial",1

if Lireintro = 1 then gosub intro

debut:

menu_id = 0
draw sprites last

rem l'ecran de chargement
set dir CheminMA$+"\Jpegs\Menu"
set image colorkey 255,0,0
rand = rnd(3)
if rand = 0
load image "Chargement.jpg",4
endif
if rand = 1
load image "Chargement2.jpg",4
endif
if rand = 2
load image "Chargement3.jpg",4
endif
if rand = 3
load image "Chargement4.jpg",4
endif
set image colorkey 0,0,0
sprite 4,0,0,4
size sprite 4,param(35),param(36)
wait 1

rem l'objet de fond
rem menu_type = rnd(1)
if menu_type = 0
set dir CheminMA$+"\Models\Menus\1\"
load object "Menu.x",1
set object speed 1,100
set object interpolation 1,100
loop object 1
position camera 50,30,-130
point camera 20,-5,0
endif
if menu_type = 1
set dir CheminMA$+"\Models\Menus\2\"
load object "Menu.x",1
set object speed 1,10
set object interpolation 1,100
loop object 1
set object transparency 1,4
position camera 43,11,-31
point camera -16,3,48
make light 1
position light 1,camera position X(),camera position y(),camera position z()
autocam off
load object "skybox.x",2
scale object 2,1000,1000,1000
set object light 2,0
endif


delete sprite 4
position mouse param(35)/2,param(36)/2



rem le menu
set dir CheminMA$+"\jpegs\menu"
load image "Primaire.jpg",1,1
sprite 1,0,param(36)-420,1
set sprite 1,1,1
show sprite 1

rem création du tableau de coordonés bouttons
dim coorbouttons(11,4,2)
coorbouttons(1,1,1) = 50
coorbouttons(1,1,2) = param(36)-370
coorbouttons(1,2,1) = 230
coorbouttons(1,2,2) = param(36)-370
coorbouttons(1,3,1) = 50
coorbouttons(1,3,2) = param(36)-335
coorbouttons(1,4,1) = 230
coorbouttons(1,4,2) = param(36)-335
coorbouttons(2,1,1) = 50
coorbouttons(2,1,2) = param(36)-305
coorbouttons(2,2,1) = 230
coorbouttons(2,2,2) = param(36)-305
coorbouttons(2,3,1) = 50
coorbouttons(2,3,2) = param(36)-265
coorbouttons(2,4,1) = 230
coorbouttons(2,4,2) = param(36)-265
coorbouttons(3,1,1) = 50
coorbouttons(3,1,2) = param(36)-240
coorbouttons(3,2,1) = 230
coorbouttons(3,2,2) = param(36)-240
coorbouttons(3,3,1) = 50
coorbouttons(3,3,2) = param(36)-190
coorbouttons(3,4,1) = 230
coorbouttons(3,4,2) = param(36)-190
coorbouttons(4,1,1) = 50
coorbouttons(4,1,2) = param(36)-170
coorbouttons(4,2,1) = 230
coorbouttons(4,2,2) = param(36)-170
coorbouttons(4,3,1) = 50
coorbouttons(4,3,2) = param(36)-130
coorbouttons(4,4,1) = 230
coorbouttons(4,4,2) = param(36)-130
coorbouttons(5,1,1) = 50
coorbouttons(5,1,2) = param(36)-105
coorbouttons(5,2,1) = 230
coorbouttons(5,2,2) = param(36)-105
coorbouttons(5,3,1) = 50
coorbouttons(5,3,2) = param(36)-65
coorbouttons(5,4,1) = 230
coorbouttons(5,4,2) = param(36)-65
coorbouttons(6,1,1) = 275
coorbouttons(6,1,2) = param(36)-352
coorbouttons(6,2,1) = 430
coorbouttons(6,2,2) = param(36)-352
coorbouttons(6,3,1) = 275
coorbouttons(6,3,2) = param(36)-312
coorbouttons(6,4,1) = 430
coorbouttons(6,4,2) = param(36)-312
coorbouttons(7,1,1) = 275
coorbouttons(7,1,2) = param(36)-312
coorbouttons(7,2,1) = 430
coorbouttons(7,2,2) = param(36)-312
coorbouttons(7,3,1) = 275
coorbouttons(7,3,2) = param(36)-257
coorbouttons(7,4,1) = 430
coorbouttons(7,4,2) = param(36)-257
coorbouttons(8,1,1) = 275
coorbouttons(8,1,2) = param(36)-257
coorbouttons(8,2,1) = 430
coorbouttons(8,2,2) = param(36)-257
coorbouttons(8,3,1) = 275
coorbouttons(8,3,2) = param(36)-217
coorbouttons(8,4,1) = 430
coorbouttons(8,4,2) = param(36)-217
coorbouttons(9,1,1) = 275
coorbouttons(9,1,2) = param(36)-217
coorbouttons(9,2,1) = 430
coorbouttons(9,2,2) = param(36)-217
coorbouttons(9,3,1) = 275
coorbouttons(9,3,2) = param(36)-167
coorbouttons(9,4,1) = 430
coorbouttons(9,4,2) = param(36)-167
coorbouttons(10,1,1) = 275
coorbouttons(10,1,2) = param(36)-167
coorbouttons(10,2,1) = 430
coorbouttons(10,2,2) = param(36)-167
coorbouttons(10,3,1) = 275
coorbouttons(10,3,2) = param(36)-117
coorbouttons(10,4,1) = 430
coorbouttons(10,4,2) = param(36)-117
coorbouttons(11,1,1) = 275
coorbouttons(11,1,2) = param(36)-117
coorbouttons(11,2,1) = 430
coorbouttons(11,2,2) = param(36)-117
coorbouttons(11,3,1) = 275
coorbouttons(11,3,2) = param(36)-61
coorbouttons(11,4,1) = 430
coorbouttons(11,4,2) = param(36)-61
rem ouverture du menu a l'utilisateur
show mouse
disable escapekey

rem et boucle du menu (avec chargement des images en temp  réel)
menu_base:
sync off


do
NewExtrapolationTimer=timer()
Extrapolation=(NewExtrapolationTimer-OldExtrapolationTimer)/2
OldExtrapolationTimer=NewExtrapolationTimer
set cursor 0,0
inc temporel,Extrapolation*3
inc temporel2#
gosub menu_cammov

gosub menuaux_arivee
if mouseclick() = 1
if mousex()>50 and mousex()<230
if mousey()> coorbouttons(1,1,2) and mousey() < coorbouttons(1,3,2)
set dir CheminMA$+"\jpegs\menu"
if menu_id not 1 then delete image 2
load image "soloaux.jpg",2,1
menuaux_image = 2
menu_id = 1
endif
if mousey()> coorbouttons(2,1,2) and mousey() < coorbouttons(2,3,2)
set dir CheminMA$+"\jpegs\menu"
if menu_id not 2 then delete image 2
load image "multiaux.jpg",2,1
menuaux_image = 2
menu_id = 2
endif
if mousey()> coorbouttons(3,1,2) and mousey() < coorbouttons(3,3,2)
set dir CheminMA$+"\jpegs\menu"
if menu_id not 3 then delete image 2
load image "netaux.jpg",2,1
menuaux_image = 2
menu_id = 3
endif
if mousey()> coorbouttons(4,1,2) and mousey() < coorbouttons(4,3,2)
set dir CheminMA$+"\jpegs\menu"
if menu_id not 4 then delete image 2
load image "configaux.jpg",2,1
menuaux_image = 2
menu_id = 4
endif
if mousey()> coorbouttons(5,1,2) and mousey() < coorbouttons(5,3,2)
end
endif
endif
endif
goto menu_aux
show sprite 2

loop

rem les sous menus
menu_aux:
if mouseclick() = 1
if mouseX()>275 and mouseX()<430
if mousey()> coorbouttons(6,1,2) and mousey() < coorbouttons(6,3,2) and mouseclick() = 1
if menu_id = 4 then goto Config
if menu_id = 3 then goto Multi_Rejoindre
gosub beta
endif
if mousey()> coorbouttons(7,1,2) and mousey() < coorbouttons(7,3,2) and mouseclick() = 1
if menu_id = 1 then goto matchamort
gosub beta
endif
if mousey()> coorbouttons(8,1,2) and mousey() < coorbouttons(8,3,2) and mouseclick() = 1
gosub beta
endif
if mousey()> coorbouttons(9,1,2) and mousey() < coorbouttons(9,3,2) and mouseclick() = 1
if menu_id = 4 then goto Credits
gosub beta
endif
if mousey()> coorbouttons(10,1,2) and mousey() < coorbouttons(10,3,2) and mouseclick() = 1
if menu_id = 1 then goto Domination
gosub beta
endif
if mousey()> coorbouttons(11,1,2) and mousey() < coorbouttons(11,3,2) and mouseclick() = 1
gosub beta
endif
endif
endif
goto menu_base


Credits:
set dir CheminMA$+"\anims"
load animation "Credit.avi",1
place animation 1,0,0,param(35),param(36)
play animation 1
set animation speed 1,100
hide sprite 1
hide sprite 2
repeat
until animation playing(1) = 0 or returnkey() = 1 or escapekey() = 1
stop animation 1
place animation 1,0,0,1,1
delete animation 1

show sprite 1
show sprite 2
loop animation 1
goto menu_base

rem les fontions du menu
end
menuaux_arivee:
if menuaux_image=0 then return
sprite 2,215,param(36)-arrive,menuaux_image
inc arrive,40
if arrive > 400 then menuaux_image = 0 :arrive = 0
return

beta:
set dir CheminMA$+"\jpegs\menu"
load image "beta.jpg",3,1
sprite 3,364,364,3
do
if mouseclick() = 1
if mouseX() > 46+364 and mouseX() < 195+364
if mouseY() > 98+364 and mouseY() < 127+364
delete image 3
delete sprite 3
exit
endif
endif
endif
loop
wait 200
return


Menu_cammov:
if menu_type = 0
position camera 50+10*sin(temporel2#/4.5),30,-130+15*sin(temporel2#*1.5/4.5)
point camera 20,-5-abs(10*sin(temporel2#/4.5)),0
endif

return


Rem *** Include File: Game_Chargement.dba ***
Rem Created: 09/12/2007 09:49:21

Rem Included in Project: D:\DBP\Projects\Metal Assault\Metal Assault.dbpro

rem =========================================================================================================================
rem ============================================== Chargement du jeu ========================================================
rem =========================================================================================================================

load_game:
rem le système
set text font "time new roman",1
set camera range 10,50000
set text size 12
Autocam Off
Color Backdrop Rgb( 0, 0, 0 )



rem on détruit les anciennes images
stop object 1
delete object 1
if object exist(2) then delete object 2
if light exist(1) then delete light 1
delete sprite 4
delete image 4
delete sprite 5
delete image 5
delete sprite 6
delete image 7
delete sprite 7
delete image 8
cls


rem l'ecran de chargement
set dir CheminMA$+"\Jpegs\Menu"
set image colorkey 255,0,0
rand = rnd(3)
if rand = 0
load image "Chargement.jpg",4
endif
if rand = 1
load image "Chargement2.jpg",4
endif
if rand = 2
load image "Chargement3.jpg",4
endif
if rand = 3
load image "Chargement4.jpg",4
endif
set image colorkey 0,0,0
sprite 4,0,0,4
size sprite 4,param(35),param(36)
hide sprite 4
wait 1

rem les armes et le shopping
game_arme_a_charger = 1
dim game_arme_embaquee(100)
gosub market
gosub Config_arme

rem on montre l'ecran de chargement
show sprite 4
wait 1


rem les armes
for t = 0 to 100
if game_arme_embaquee(t) = 1
set dir CheminMA$+"\Models\Armes\"+listarme(t).name$
load object listarme(t).name$+".X",t+1000
disable object zdepth t+1000
loop object t+1000,0,30
set object speed t+1000,60
load image "Reticule.tga",t+1000,1
load sound "Fire.WAV",t+1000
exclude object on t+1000
inc nb_arme
endif
next t


rem la coresspondance enre n° d'arme et objet d'arme
dim game_arme_coress(nb_arme)
i= 0
   for t= 0 to 100
      if game_arme_embaquee(t) = 1 then game_arme_coress(i) = 1000 + t : inc i : listarme(t).Bulets_encour = listarme(t).BuletsparChargeur : listarme(t).Bulets_Stock =  listarme(t).BuletsparChargeur* listarme(t).Chargeur_start
   next t
arme  = nb_arme-1

rem les lazers, silencieux et companies

num = 1400
if Glock_17_Silencieux = 1
set dir CheminMA$+"\Models\Armes\Glock 17"
load object "Silencieux.x",num
disable object zdepth num
load sound "Silencieux.wav",num
Glock_17_Silencieux = num
inc num
endif
if Famas_Silencieux = 1
set dir CheminMA$+"\Models\Armes\Famas G2"
load object "Silencieux.x",num
disable object zdepth num
load sound "Silencieux.wav",num
Famas_Silencieux = num
inc num
endif
if Famas_Lazer = 1
set dir CheminMA$+"\Models\Armes\Famas G2"
load object "Lazer.x",num
disable object zdepth num
set dir CheminMA$+"\Jpegs\Jeu\"
load image "lazer.tga",num
Famas_Lazer = num
inc num
endif
if Famas_ACOG = 1
set dir CheminMA$+"\Models\Armes\Famas G2"
load object "ACOG.x",num
disable object zdepth num
Famas_ACOG = num
inc num
endif
if Famas_Vlourd = 1
listarme(40).Bulets_encour = 90
listarme(40).BuletsparChargeur = 90
listarme(40).Chargeur_start = 7
set dir CheminMA$+"\Models\Armes\Famas G2"
load object "Vlourd.x",num
disable object zdepth num
Famas_Vlourd = num
inc num
endif
if Ak_74_Silencieux = 1
set dir CheminMA$+"\Models\Armes\Kalachnikov AK-74"
load object "Silencieux.x",num
disable object zdepth num
load sound "Silencieux.wav",num
Ak_74_Silencieux = num
inc num
endif
if AK_74_Lazer = 1
set dir CheminMA$+"\Jpegs\Jeu\"
load image "lazer.tga",num
AK_74_Lazer = num
endif
if CsniperR_Silencieux = 1
set dir CheminMA$+"\Models\Armes\Classical Sniper-rifle"
load object "Silencieux.x",num
disable object zdepth num
load sound "Silencieux.wav",num
CsniperR_Silencieux = num
inc num
endif

rem intialisation du zoom
zoom = 60
dessomee = 1

rem l'ecran de chargement
set dir CheminMA$+"\Jpegs\Menu"
set image colorkey 255,0,0
rand = rnd(3)
if rand = 0
load image "Chargement.jpg",4
endif
if rand = 1
load image "Chargement2.jpg",4
endif
if rand = 2
load image "Chargement3.jpg",4
endif
if rand = 3
load image "Chargement4.jpg",4
endif
set image colorkey 0,0,0
sprite 4,0,0,4
size sprite 4,param(35),param(36)
wait 1


rem initialisation du moteur de physique
global radius# as double float : radius# = 20.0 : rem la ditance minimale entre le perso et un murrem a laisser vide pour éviter les bugs de la gravitée (c'est la faute de DBP)
global tailleperso# as double float : tailleperso# = 80 : rem 100 fait environ 2m
global genouperso# as double float : genouperso# = 35
global gravite# as float : gravite# = 9
make object sphere 2,radius#
position object 2,-80,15,-20
sc_setupObject 2,0,1
hide object 2
disable object zwrite 2
make object sphere 3,radius#/5
position object 3,-80,5,-20
sc_setupObject 3,0,1
hide object 3
disable object zwrite 3
make object sphere 4,radius#/2
position object 4,-80,15,-20
sc_setupObject 4,0,1
hide object 4
disable object zwrite 4


rem On charge la carte
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$
if file exist (game_carte$+".dbo") = 0
load object game_carte$+".x",1
else
load object game_carte$+".dbo",1
endif
sc_setupComplexObject 1,1,2
set object transparency 1,4
set object 1,1,1,1
set object light 1,0
set object texture 1,1,1
set normalization on

rem pour le déplacement
coef_ralentissement = 1
coef_ralentissement_2# = 1

rem et les points de respawn
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$
if file exist ("RespawnH.ini") = 1 and file exist ("RespawnD.ini") = 1
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
open to read 1,"RespawnH.ini"
read string 1,game_repawn_point_human_nb$
if left$(game_repawn_point_human_nb$,1) = "-"
game_repawn_point_human_nb = val(right$(game_repawn_point_human_nb$,len(game_repawn_point_human_nb$)))*-1
else
game_repawn_point_human_nb = val(game_repawn_point_human_nb$)
endif
close file 1
open to read 1,"RespawnD.ini"
read string 1,game_repawn_point_droide_nb$
if left$(game_repawn_point_droide_nb$,1) = "-"
game_repawn_point_droide_nb = val(right$(game_repawn_point_droide_nb$,len(game_repawn_point_droide_nb$)))*-1
else
game_repawn_point_droide_nb = val(game_repawn_point_droide_nb$)
endif
close file 1
dim game_repawn(2,game_repawn_point_human_nb + game_repawn_point_droide_nb,3)
open to read 1,"RespawnH.ini"
read string 1,temp$
for t = 1 to game_repawn_point_human_nb
read string 1,temp$
if left$(temp$,1) = "-"
game_repawn(1,t,1) = val(right$(temp$,len(temp$)-1))*-1
else
game_repawn(1,t,1) = val(temp$)
endif
read string 1,temp$
if left$(temp$,1) = "-"
game_repawn(1,t,2) = val(right$(temp$,len(temp$)-1))*-1
else
game_repawn(1,t,2) = val(temp$)
endif
read string 1,temp$
if left$(temp$,1) = "-"
game_repawn(1,t,3) = val(right$(temp$,len(temp$)-1))*-1
else
game_repawn(1,t,3) = val(temp$)
endif
next t
close file 1
open to read 1,"RespawnD.ini"
read string 1,temp$
for t = 1 to game_repawn_point_droide_nb
read string 1,temp$
if left$(temp$,1) = "-"
game_repawn(2,t,1) = val(right$(temp$,len(temp$)-1))*-1
else
game_repawn(2,t,1) = val(temp$)
endif
read string 1,temp$
if left$(temp$,1) = "-"
game_repawn(2,t,2) = val(right$(temp$,len(temp$)-1))*-1
else
game_repawn(2,t,2) = val(temp$)
endif
read string 1,temp$
if left$(temp$,1) = "-"
game_repawn(2,t,3) = val(right$(temp$,len(temp$)-1))*-1
else
game_repawn(2,t,3) = val(temp$)
endif
next t
close file 1
endif


rem le ciel
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$
make object sphere 5,100,15,60
scale object 5,-2500,-2500,-2500
load image "sky.jpg",10,1
texture object 5,10
rotate object 5,180,140,0
fix object pivot 5
set object light 5,0
sc_setupobject 5,5,0
sc_allowobjectscaling 5

Rem Les muns reloaders
if file open(1) =1 then close file 1
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$
if file exist(game_carte$+".ini")
set dir CheminMA$+"\Models\"
load object "Muns.x",1257
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$
open to read 1,game_carte$+".ini"
repeat
read string 1,temp$
if temp$ = "[Muns Pos]"
read string 1,temp$
Xmuns# = val(temp$)
read string 1,temp$
Ymuns# = val(temp$)
read string 1,temp$
Zmuns# = val(temp$)
endif
until file end (1) = 1
close file 1
position object 1257,Xmuns#,Ymuns#,Zmuns#
endif


rem les roquettes
set dir CheminMA$+"\Models\Armes\Double Lance Roquette\"
dim Game_roket_tir(60)
dim Game_roket_life(60)
Game_roket_select = 1102
Game_biroket_select = 1132
for t=1100 to 1130
load object "Roquette.x",t
exclude object on t
sc_setupobject t,0,2
next
for t=1131 to 1160
load object "BiRoquette.x",t
loop object t,0,20
exclude object on t
sc_setupobject t,0,2
next

rem l'ecran de chargement
set dir CheminMA$+"\Jpegs\Menu"
set image colorkey 255,0,0
rand = rnd(3)
if rand = 0
load image "Chargement.jpg",4
endif
if rand = 1
load image "Chargement2.jpg",4
endif
if rand = 2
load image "Chargement3.jpg",4
endif
if rand = 3
load image "Chargement4.jpg",4
endif
set image colorkey 0,0,0
sprite 4,0,0,4
size sprite 4,param(35),param(36)
wait 1

rem les balles du DCA
dim Game_DCA_ballife(10)
for t  = 1161 to 1170
make object sphere t,10
ghost object on t
sc_setupobject t,t,0
hide object t
next t

rem les sons
set dir CheminMA$+"\Sounds\"
rem sons 3 pris par le son de FRAG\mort
load sound "Droide_hit.wav",4


rem les images (réticule,entre autre)
set dir CheminMA$+"\Jpegs\Jeu"
load image "Snipe.tga",14
sprite 14,10000,100000,14


rem l'exploison
set dir CheminMA$+"\Models\"
load object "Explosion.X",1001
set object speed 1001,100
set object interpolation 1001,100
exclude object on 1001


rem le témoin d'ipact sur le joueur
make object cube 1002,50
sc_setupobject 1002,0,2
hide object 1002


rem les sons de frag
set dir CheminMA$+"\Sounds\Voix\Droides\"
if file exist ("index.ini") = 1
open to read 1,"index.ini"
read file 1,game_frag_droide_sound_nb
dim game_frag_droide_sound$(game_frag_droide_sound_nb)
for t = 1 to game_frag_droide_sound_nb
read string 1,temp$
game_frag_droide_sound$(t) = temp$
next t
close file 1
endif

rem les sons de mort
set dir CheminMA$+"\Sounds\Voix\Humain\"
if file exist ("index.ini") = 1
open to read 1,"index.ini"
read file 1,game_frag_human_sound_nb
dim game_frag_human_sound$(game_frag_human_sound_nb)
for t = 1 to game_frag_human_sound_nb
read string 1,temp$
game_frag_human_sound$(t) = temp$
next t
close file 1
endif

rem les droïdes
set dir CheminMA$+"\Models\"
for t = 0 to nbwarmachines-1
Bot(t).tipe = 0
next t
for t = nbwarmachines to nbsentinelles-1+nbwarmachines
Bot(t).tipe = 1
next t
Droide_objet_suivant = 5000
for t = 0 to NbBot-1
if Bot(t).tipe = 0
   temp = rnd(1)
   if temp = 0
   load object "Warmachine.X",Droide_objet_suivant
   rotate object Droide_objet_suivant,-90,0,0
   fix object pivot Droide_objet_suivant
   else
   load object "Warmachine2.X",Droide_objet_suivant
   rotate object Droide_objet_suivant,-90,0,0
   fix object pivot Droide_objet_suivant
   endif
   Bot(t).name$ = "Wm"+str$(rnd(1000000))
   Bot(t).Vie = 40
   Bot(t).objet = Droide_objet_suivant
   Bot(t).tete = Droide_objet_suivant
   sc_setupobject Bot(t).objet,0,1
endif
if Bot(t).tipe = 1
   temp = rnd(1)
   if temp = 0
   load object "Sentinelle.x",Droide_objet_suivant
   set object speed Droide_objet_suivant,30
   else
   load object "Sentinelle2.x",Droide_objet_suivant
   rotate object Droide_objet_suivant,-90,180,0
   fix object pivot Droide_objet_suivant
   endif
   Bot(t).name$ = "St"+str$(rnd(1000000))
   Bot(t).Vie = 100
   Bot(t).objet = Droide_objet_suivant
   Bot(t).tete = Droide_objet_suivant+1
   make object sphere Droide_objet_suivant+1,40
   hide object Droide_objet_suivant+1
   sc_setupobject Bot(t).objet+1,0,1
   sc_setupobject Bot(t).objet,0,1
endif
   exclude object on Droide_objet_suivant
   loop object Droide_objet_suivant
   sc_setupComplexObject Droide_objet_suivant,2,2
   if file exist ("respawnH.ini") = 1 and file exist ("respawnD.ini") = 1
      Bot(t).respawn_pt = rnd(game_repawn_point_droide_nb-1)+1
      Bot(t).X# = game_repawn(2,Game_resppawn_point,1)
      Bot(t).Z# = game_repawn(2,Game_resppawn_point,3)
      Bot(t).Y# = game_repawn(2,Game_resppawn_point,2)
   endif
   inc Droide_objet_suivant,2
   Bot(t).cible = rnd(nballies)
next t


rem les tirs de droides + autres sons
set dir CheminMA$+"\Sounds"
load sound "Snipe_tir.wav",1103
set dir CheminMA$+"\Sounds\player"
load sound "Pas_std.wav",100
load sound "saut.wav",101
load sound "Saut_ateriss.wav",102

rem les alliés
objet_humain_suivant = 12000
for t= 0 to nballies-1
set dir CheminMA$+"\Models\Human"
load object "Soldier.x",objet_humain_suivant+t
set object speed objet_humain_suivant+t,50
rotate object objet_humain_suivant+t,0,180,0
fix object pivot objet_humain_suivant+t
loop object objet_humain_suivant+t,516,595
scale object objet_humain_suivant+t,7500,7500,7500
allie(t).name$ = nomhumain$(rnd(40))
allie(t).Vie = 100
allie(t).objet = objet_humain_suivant+t
sc_setupobject objet_humain_suivant+t,0,0
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
if file exist ("respawnH.ini") = 1 and file exist ("respawnD.ini") = 1
Game_resppawn_point = rnd(game_repawn_point_human_nb-1)+1
allie(t).x# = game_repawn(1,Game_resppawn_point,1)
allie(t).z# = game_repawn(1,Game_resppawn_point,3)
allie(t).y# = game_repawn(1,Game_resppawn_point,2)
endif
position object objet_humain_suivant+t,allie(t).x#,allie(t).y#,allie(t).z#
point object objet_humain_suivant+t,0,allie(t).y#,0
repeat
allie(t).cible = rnd(Nbbot-1)
until Bot(allie(t).cible).Vie > 0
next t


rem l'ecran de chargement
set dir CheminMA$+"\Jpegs\Menu"
set image colorkey 255,0,0
rand = rnd(3)
if rand = 0
load image "Chargement.jpg",4
endif
if rand = 1
load image "Chargement2.jpg",4
endif
if rand = 2
load image "Chargement3.jpg",4
endif
if rand = 3
load image "Chargement4.jpg",4
endif
set image colorkey 0,0,0
sprite 4,0,0,4
size sprite 4,param(35),param(36)
wait 1

rem l'EC
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 100.avi",1
place animation 1,0,0,0,0

rem la console
dim game_console$(5)
dim game_console_time(5)

rem les images
set dir CheminMA$+"\Jpegs\jeu"
load image "Small Score.tga",17
sprite 17,param(35)/2-100,0,17
hide sprite 17
load image "Dammage_warn.tga",18
sprite 18,0,0,18
size sprite 18,param(35),param(36)
hide sprite 18
load image "Muns.tga",19
sprite 19,256,param(36)-50,19
hide sprite 19
load image "acog.tga",20
set dir CheminMA$+"\Models\Armes\"+listarme(40).name$
if game_arme_embaquee(40) = 1 then load image "mire.bmp",21
set dir CheminMA$+"\Models\Armes\"+listarme(41).name$
if game_arme_embaquee(41) = 1 then load image "mire.bmp",22
set dir CheminMA$+"\Jpegs\jeu\ATH"
set image colorkey 0,0,0
if armure_type = 4 then load image "Lourde.jpg",23
if armure_type = 5 then load image "Ultra Lourde.jpg",23
set dir CheminMA$+"\Jpegs\jeu"
load image "utiliser.tga",24
sprite 24,param(35)/2-64,param(36)/2-100,24
set sprite alpha 24,128
hide sprite 24
set dir CheminMA$+"\Jpegs\jeu\EC\"
load image "Pourtour.tga",25
sprite 25,0,param(36)-128,25
hide sprite 25
set dir CheminMA$+"\Jpegs\jeu"
rem 256 ==> 512 prises par les Txt pricipaux
rem 513 ==> 1281 prises par l'eau

rem le bouboules du mode domination
if type_game$="Domination"
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
if file exist ("dom.ini") = 1
open to read 1,"dom.ini"
read float 1,game_dompts#
game_dompts = int(game_dompts#)
for t= 0 to game_dompts
read file 1,temp
Solo_dompts(t,1) = temp
read file 1,temp
Solo_dompts(t,2) = temp
read file 1,temp
Solo_dompts(t,3) = temp
make object sphere t+1200,160,20,20
position object t+1200,Solo_dompts(t,1),Solo_dompts(t,2),Solo_dompts(t,3)
sc_setupobject t+1200,1200,0
next t
close file 1
endif
endif
Solo_iadom_cible_ateinte = 1


rem lecture de l'eventuel script de la carte
gosub Solo_Script_lecture


rem l'eau
if water > 0
Make_Ocean(1,6,513,514,515,516,1,Water_level,5000,5000,0,0,1,2)
rem Make_old_eau(1,6,513,1,30,31,2,255,255,255,"",5000,5000,0,Water_level,0,1)
endif


rem les Goliaths
set dir CheminMA$+"\FX\hologram"
load effect "hologram12.fx",2,1
set dir CheminMA$+"\Models\Tourelles\Goliath\"
make object sphere 8000,40
set object effect 8000,2
temp=make vector4(2)
Goliath_bal_en_cour = 8000
Goliath_nb_bal = 1
for t = 0 to nb_Goliath-1
load object "Goliath.x",t+1281
position object t+1281,Goliaths(t).x,Goliaths(t).y,Goliaths(t).z
yrotate object t+1281,180
fix object pivot t+1281
point object t+1281,0,object position Y(t+1281),0
sc_setupobject t+1281,t+1281,0
for a=  1 to 20
for g = 1 to 8
clone object Goliath_nb_bal+8000,8000
set object Goliath_nb_bal+8000,1,1,0
set object light Goliath_nb_bal+8000,0
set object effect Goliath_nb_bal+8000,2
zrotate object Goliath_nb_bal+8000,45*g
fix object pivot Goliath_nb_bal+8000
sc_setupobject Goliath_nb_bal+8000,Goliath_nb_bal+8000,0
position object Goliath_nb_bal+8000,0,90000000,0
hide object Goliath_nb_bal+8000
inc Goliath_nb_bal
next g
next a
next t
dim Goliath_bal_life(Goliath_nb_bal)
load sound "start.wav",8000
load sound "fire.wav",8001
load sound "end.wav",8002


rem les Vautours
if nb_vautour > 0
set dir CheminMA$+"\Models\Véhicules\Vautour"
for t = 0 to nb_vautour-1
load object "Vautour.x",t+1701
scale object  t+1701,600,600,600
position object t+1701,Vautours(t).x#,Vautours(t).y#,Vautours(t).z#
point object t+1701,0,object position y(t+1701),0
Sc_setupobject 1701+t,1,0
next t
endif

rem les Escompides
if nb_escompide > 0
set dir CheminMA$+"\Models\Véhicules\Escompide"
for t = 0 to nb_escompide-1
load object "Escompide.x",t+1801
scale object  t+1801,160,160,160
position object t+1801,escompides(t).x#,escompides(t).y#,escompides(t).z#
Sc_setupobject 1801+t,1,0
next t
endif


rem les V2CI
if nb_v2ci > 0
set dir CheminMA$+"\Models\Véhicules\V2CI"
for t = 0 to nb_v2ci-1
load object "V2CI.x",t+2001
scale object  t+2001,600,600,600
position object t+2001,V2cis(t).x#,V2cis(t).y#,V2cis(t).z#
point object t+2001,0,object position y(t+2001),0
Sc_setupobject 2001+t,1,0
next t
endif

rem les Motos Droides
if nb_motoD > 0
set dir CheminMA$+"\Models\Véhicules\MotoD"
for t = 0 to nb_motoD-1
load object "MotoD.x",t+2101
scale object  t+2101,160,160,160
position object t+2101,MotoDs(t).x#,MotoDs(t).y#,MotoDs(t).z#
Sc_setupobject 2101+t,1,0
next t
endif

rem les Chars Coléoptères
if nb_coleoptere > 0
set dir CheminMA$+"\Models\Véhicules\Coléoptère"
for t = 0 to nb_coleoptere-1
load object "coléoptère.x",t+2201
scale object  t+2201,650,650,650
position object t+2201,coleopteres(t).x#,coleopteres(t).y#,coleopteres(t).z#
rotate object t+2201,0,180,0
fix object pivot t+2201
Sc_setupobject 2201+t,1,0
next t
for t = 0 to nb_coleoptere-1
load object "coléoptère2.x",t+2301
scale object  t+2301,650,650,650
position object t+2301,coleopteres(t).x#,coleopteres(t).y#,coleopteres(t).z#
rotate object t+2301,0,180,0
fix object pivot t+2301
Sc_setupobject 2301+t,1,0
next t
endif

rem initialisation du flou
game_flou = 255

rem la vie
vie = 100

rem on est en mode FPS
gameplay_Type = 1

rem on enlève l'écran de chargement, la souris et on lance le jeu (très loin !!)
sync on
sync rate 0
sync
delete sprite 4
delete image 4
hide mouse
get image 4,0,0,param(35),param(36)
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
if file exist ("respawnH.ini") = 1 and file exist ("respawnD.ini") = 1
Game_resppawn_point = rnd(game_repawn_point_human_nb-1)+1
x# = game_repawn(1,Game_resppawn_point,1)
z# = game_repawn(1,Game_resppawn_point,3)
y# = game_repawn(1,Game_resppawn_point,2)
endif
position camera x#,y#,z#
rem effet de fondu (savoyarde !!!)
sprite 4,0,0,4
Game_Effect_fondu_alpha = 255
goto Exploration

rem =========================================================================================================================
rem ============================================== Lancement du jeu  ========================================================
rem =========================================================================================================================
rem ===================================== Transition de l'exploration vers le jeu ===========================================
rem =========================================================================================================================

Game_trans:


delete sprite 4

rem position de départ
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
if file exist ("respawnH.ini") = 1 and file exist ("respawnD.ini") = 1
Game_resppawn_point = rnd(game_repawn_point_human_nb-1)+1
x# = game_repawn(1,Game_resppawn_point,1)
z# = game_repawn(1,Game_resppawn_point,3)
y# = game_repawn(1,Game_resppawn_point,2)
endif
rotate object game_arme_coress(arme),camy#+270,camx#,0
position object 3,x#,y#,z#
position camera object position x(3),object position y(3)+tailleperso#,object position z(3)
position object 2,object position x(3),object position y(3)+tailleperso#,object position z(3)
position object 4,object position x(3),object position y(3)+genouperso#,object position z(3)
position object game_arme_coress(arme),object position x(3),object position y(3)+tailleperso#,object position z(3)

rem la musique
set dir CheminMA$+"\Musiques\Combat"
stop music 1
delete music 1
open to read 1,"index.ini"
read float 1,game_nb_baston_zik#
game_nb_baston_zik = int(game_nb_baston_zik#)
for t = 0 to game_nb_baston_zik
read string 1,zikname$(t)
next t
load music zikname$(rnd(game_nb_baston_zik-1)),1
loop music 1
set music volume 1,30

 rem l'IA
for t = 0 to NbBot-1
exclude object off Bot(t).objet
next t
for t = 0 to nballies-1
exclude object off 12000+t
next t

rem l'UI
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
show sprite 17
show sprite 19
show sprite 25

set text font "time new roman",1
set camera range 10,50000
set text size 16
draw sprites first

time = timer()
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
if file exist ("respawnH.ini") = 1 and file exist ("respawnD.ini") = 1
Game_resppawn_point = rnd(game_repawn_point_human_nb-1)+1
x# = game_repawn(1,Game_resppawn_point,1)
z# = game_repawn(1,Game_resppawn_point,3)
y# = game_repawn(1,Game_resppawn_point,2)
endif
exclude object off game_arme_coress(arme)
sync
break
sprite 15,param(35)/2,param(36)/2,game_arme_coress(arme)
offset sprite 15,sprite width(15)/2,sprite height(15)/2

goto Game


Rem *** Include File: Game_market.dba ***
Rem Created: 27/02/2008 12:04:29
Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro

market:
gosub Market_armure
Solde = Player_stats(0)
set dir CheminMA$+"\Models\Armes\"
open to read 1,"index.ini"
repeat
read string 1,temp$
if temp$ = "[arme]"
read string 1,temp$
read string 1,temp2$
listarme(int(val(temp2$))).name$ = temp$
read string 1,temp$
listarme(int(val(temp2$))).price = val(temp$)
read string 1,temp$
listarme(int(val(temp2$))).poid = val(temp$)
read string 1,temp$
listarme(int(val(temp2$))).Chargeur_start = val(temp$)
read string 1,temp$
listarme(int(val(temp2$))).BuletsparChargeur = val(temp$)
endif
until file end(1) = 1
close file 1

set dir CheminMA$+"\Jpegs\jeu\market"
show mouse
load image "principal.jpg",17,1
set image colorkey 10,10,10
market_start:
do
paste image 17,0,0
if boutton2(100,100,180,130) = 1 or keystate(2) = 1
delete image 17
load image "Pistolets.jpg",17,1
market_status = 1
endif
if boutton2(180,100,317,130) = 1 or keystate(3) = 1
delete image 17
load image "automatiques.jpg",17,1
market_status = 2
endif
if boutton2(317,100,400,130) = 1 or keystate(4) = 1
delete image 17
load image "a pompe.jpg",17,1
market_status = 3
endif
if boutton2(400,100,550,130) = 1 or keystate(5) = 1
delete image 17
load image "Fusils d'assaults.jpg",17,1
market_status = 4
endif
if boutton2(550,100,640,130) = 1 or keystate(6) = 1
delete image 17
load image "miniguns.jpg",17,1
market_status = 5
endif
if boutton2(640,100,695,130) = 1 or keystate(7) = 1
delete image 17
load image "Lourd.jpg",17,1
market_status = 6
endif
if boutton2(695,100,750,130) = 1 or keystate(8) = 1
delete image 17
load image "Snipe.jpg",17,1
market_status = 7
endif
if boutton2(750,100,825,130) = 1 or keystate(9) = 1
delete image 17
load image "Spécial.jpg",17,1
market_status = 8
endif
if boutton2(825,100,900,130) = 1 or keystate(10) = 1
delete image 17
load image "a main.jpg",17,1
market_status = 9
endif
set cursor 0,0
ink rgb(0,0,0),0
print screen fps()
if market_status > 4 then set cursor 200,170 : print "Solde : ",Solde," $" : set cursor 200,190 : print "Capacitée : ",Game_armure_force-poid_achat : else : set cursor 660,170 : print "Solde : ",Solde," $" : set cursor 660,190 : print "Capacitée : ",Game_armure_force-poid_achat
if boutton2(664,16,830,72) = 1 then goto market_end
if market_status = 0 then : else : goto market_sub
loop




market_sub:
set image colorkey 10,10,10
color backdrop rgb(0,0,0)
do
set dir CheminMA$+"\Jpegs\jeu\market"
paste image 17,0,0,1
if boutton2(100,100,180,130) = 1
delete image 17
load image "Pistolets.jpg",17,1
market_status = 1
endif
if boutton2(180,100,317,130) = 1
delete image 17
load image "automatiques.jpg",17,1
market_status = 2
endif
if boutton2(317,100,400,130) = 1
delete image 17
load image "a pompe.jpg",17,1
market_status = 3
endif
if boutton2(400,100,550,130) = 1
delete image 17
load image "Fusils d'assaults.jpg",17,1
market_status = 4
endif
if boutton2(550,100,640,130) = 1
delete image 17
load image "miniguns.jpg",17,1
market_status = 5
endif
if boutton2(640,100,695,130) = 1
delete image 17
load image "Lourd.jpg",17,1
market_status = 6
endif
if boutton2(695,100,750,130) = 1
delete image 17
load image "Snipe.jpg",17,1
market_status = 7
endif
if boutton2(750,100,825,130) = 1
delete image 17
load image "Spécial.jpg",17,1
market_status = 8
endif
if boutton2(825,100,900,130) = 1
delete image 17
load image "a main.jpg",17,1
market_status = 9
endif
set cursor 0,0
ink rgb(0,0,0),0
print screen fps()
if market_status > 4
set cursor 200,170
print "Solde : ",Solde," €"
set cursor 200,150
print "Coût de cette arme : ",market_priarme," $"
set cursor 200,190
print "Capacitée : ",Game_armure_force-poid_achat
set cursor 200,210
print "Poid de cette arme : ",market_poidarme," Kg"
else
set cursor 660,170
print "Solde : ",Solde," €"
set cursor 660,150
print "Coût de cette arme : ",market_priarme," $"
set cursor 660,190
print "Capacitée : ",Game_armure_force-poid_achat
set cursor 660,210
print "Poid de cette arme : ",market_poidarme," Kg"
endif
if boutton2(664,16,830,72) = 1 then goto market_end
rem ======================================
select market_status
case 1
set cursor 185,140
print listarme(10).name$
set cursor 185,180
print listarme(11).name$
set cursor 185,220
print listarme(12).name$
set cursor 185,260
print listarme(13).name$
set cursor 185,300
print listarme(14).name$
set cursor 185,340
print listarme(15).name$
set cursor 185,380
print listarme(16).name$
set cursor 185,420
print listarme(17).name$
set cursor 185,460
print listarme(18).name$
set cursor 185,500
print listarme(19).name$
endcase
case 2
set cursor 285,140
print listarme(20).name$
set cursor 285,180
print listarme(21).name$
set cursor 285,220
print listarme(22).name$
set cursor 285,260
print listarme(23).name$
set cursor 285,300
print listarme(24).name$
set cursor 285,340
print listarme(25).name$
set cursor 285,380
print listarme(26).name$
set cursor 285,420
print listarme(27).name$
set cursor 285,460
print listarme(28).name$
set cursor 285,500
print listarme(29).name$
endcase
case 3
set cursor 400,140
print listarme(30).name$
set cursor 400,180
print listarme(31).name$
set cursor 400,220
print listarme(32).name$
set cursor 400,260
print listarme(33).name$
set cursor 400,300
print listarme(34).name$
set cursor 400,340
print listarme(35).name$
set cursor 400,380
print listarme(36).name$
set cursor 400,420
print listarme(37).name$
set cursor 400,460
print listarme(38).name$
set cursor 400,500
print listarme(39).name$
endcase
case 4
set cursor 285,140
print listarme(40).name$
set cursor 285,180
print listarme(41).name$
set cursor 285,220
print listarme(42).name$
set cursor 285,260
print listarme(43).name$
set cursor 285,300
print listarme(44).name$
set cursor 285,340
print listarme(45).name$
set cursor 285,380
print listarme(46).name$
set cursor 285,420
print listarme(47).name$
set cursor 285,460
print listarme(48).name$
set cursor 285,500
print listarme(49).name$
endcase
case 5
set cursor 630,140
print listarme(50).name$
set cursor 630,180
print listarme(51).name$
set cursor 630,220
print listarme(52).name$
set cursor 630,260
print listarme(53).name$
set cursor 630,300
print listarme(54).name$
set cursor 630,340
print listarme(55).name$
set cursor 630,380
print listarme(56).name$
set cursor 630,420
print listarme(57).name$
set cursor 630,460
print listarme(58).name$
set cursor 630,500
print listarme(59).name$
endcase
case 6
set cursor 700,140
print listarme(60).name$
set cursor 700,180
print listarme(61).name$
set cursor 700,220
print listarme(62).name$
set cursor 700,260
print listarme(63).name$
set cursor 700,300
print listarme(64).name$
set cursor 700,340
print listarme(65).name$
set cursor 700,380
print listarme(66).name$
set cursor 700,420
print listarme(67).name$
set cursor 700,460
print listarme(68).name$
set cursor 700,500
print listarme(69).name$
endcase
case 7
set cursor 555,140
print listarme(70).name$
set cursor 555,180
print listarme(71).name$
set cursor 555,220
print listarme(72).name$
set cursor 555,260
print listarme(73).name$
set cursor 555,300
print listarme(74).name$
set cursor 555,340
print listarme(75).name$
set cursor 555,380
print listarme(76).name$
set cursor 555,420
print listarme(77).name$
set cursor 555,460
print listarme(78).name$
set cursor 555,500
print listarme(79).name$
endcase
case 8
set cursor 640,140
print listarme(80).name$
set cursor 640,180
print listarme(81).name$
set cursor 640,220
print listarme(82).name$
set cursor 640,260
print listarme(83).name$
set cursor 640,300
print listarme(84).name$
set cursor 640,340
print listarme(85).name$
set cursor 640,380
print listarme(86).name$
set cursor 640,420
print listarme(87).name$
set cursor 640,460
print listarme(88).name$
set cursor 640,500
print listarme(89).name$
endcase
case 9
set cursor 631,140
print listarme(90).name$
set cursor 631,180
print listarme(91).name$
set cursor 631,220
print listarme(92).name$
set cursor 631,260
print listarme(93).name$
set cursor 631,300
print listarme(94).name$
set cursor 631,340
print listarme(95).name$
set cursor 631,380
print listarme(96).name$
set cursor 631,420
print listarme(97).name$
set cursor 631,460
print listarme(98).name$
set cursor 631,500
print listarme(99).name$
endcase
endselect
rem ======================================
if mousey() > 135 and mousey() < 160
market_armacharger = market_status * 10 +0
endif
if mousey() > 160 and mousey() < 200
market_armacharger = market_status * 10 +1
endif
if mousey() > 200 and mousey() < 240
market_armacharger = market_status * 10 +2
endif
if mousey() > 240 and mousey() < 280
market_armacharger = market_status * 10 +3
endif
if mousey() > 280 and mousey() < 320
market_armacharger = market_status * 10 +4
endif
if mousey() > 320 and mousey() < 360
market_armacharger = market_status * 10 +5
endif
if mousey() > 360 and mousey() < 400
market_armacharger = market_status * 10 +6
endif
if mousey() > 400 and mousey() < 440
market_armacharger = market_status * 10 +7
endif
if mousey() > 440 and mousey() < 480
market_armacharger = market_status * 10 +8
endif
if mousey() > 480 and mousey() < 520
market_armacharger = market_status * 10 +9
endif
gosub market_chargarme
if mouseclick() = 1 and mousey()>135
select market_armacharger
case 10
if Solde >= 520 and game_arme_embaquee(market_armacharger) = 0 and Game_armure_force-poid_achat>=listarme(10).poid
dec solde,listarme(10).price
inc poid_achat,listarme(10).poid
game_arme_embaquee(market_armacharger) = 1
arme = 1000+market_armacharger
endif
endcase
case 30
if Solde >= 13000 and game_arme_embaquee(market_armacharger) = 0 and Game_armure_force-poid_achat>=listarme(30).poid
dec solde,listarme(30).price
inc poid_achat,listarme(30).poid
game_arme_embaquee(market_armacharger) = 1
arme = 1000+market_armacharger
endif
endcase
case 40
if Solde >= 5000 and game_arme_embaquee(market_armacharger) = 0 and Game_armure_force-poid_achat>=listarme(40).poid
dec solde,listarme(40).price
inc poid_achat,listarme(40).poid
game_arme_embaquee(market_armacharger) = 1
arme = 1000+market_armacharger
endif
endcase
case 41
if Solde >= 4825 and game_arme_embaquee(market_armacharger) = 0 and Game_armure_force-poid_achat>=listarme(41).poid
dec solde,listarme(41).price
inc poid_achat,listarme(41).poid
game_arme_embaquee(market_armacharger) = 1
arme = 1000+market_armacharger
endif
endcase
case 50
if Solde >= 2000 and game_arme_embaquee(market_armacharger) = 0 and Game_armure_force-poid_achat>=listarme(50).poid
dec solde,listarme(50).price
inc poid_achat,listarme(50).poid
game_arme_embaquee(market_armacharger) = 1
arme = 1000+market_armacharger
endif
endcase
case 51
if Solde >= 1500 and game_arme_embaquee(market_armacharger) = 0 and Game_armure_force-poid_achat>=listarme(51).poid
dec solde,listarme(51).price
inc poid_achat,listarme(51).poid
game_arme_embaquee(market_armacharger) = 1
arme = 1000+market_armacharger
endif
endcase
case 60
if Solde >= 10000 and game_arme_embaquee(market_armacharger) = 0 and Game_armure_force-poid_achat>=listarme(60).poid
dec solde,listarme(60).price
inc poid_achat,listarme(60).poid
game_arme_embaquee(market_armacharger) = 1
arme = 1000+market_armacharger
endif
endcase
case 70
if Solde >= 8000 and game_arme_embaquee(market_armacharger) = 0 and Game_armure_force-poid_achat>=listarme(70).poid
dec solde,listarme(70).price
inc poid_achat,listarme(70).poid
game_arme_embaquee(market_armacharger) = 1
arme = 1000+market_armacharger
endif
endcase
endselect

endif
loop


market_chargarme:
select market_armacharger
case 10
market_priarme = listarme(10).price
market_poidarme = listarme(10).poid
endcase
case 30
market_priarme = listarme(30).price
market_poidarme = listarme(30).poid
endcase
case 40
market_priarme = listarme(40).price
market_poidarme = listarme(40).poid
endcase
case 41
market_priarme = listarme(41).price
market_poidarme = listarme(41).poid
endcase
case 50
market_priarme = listarme(50).price
market_poidarme = listarme(50).poid
endcase
case 51
market_priarme = listarme(51).price
market_poidarme = listarme(51).poid
endcase
case 60
market_priarme = listarme(60).price
market_poidarme = listarme(60).poid
endcase
case 70
market_priarme = listarme(70).price
market_poidarme = listarme(70).poid
endcase
endselect
return



market_end:
hide mouse
set image colorkey 0,0,0
if Solde >= 520 and game_arme_embaquee(10) = 0
dec Solde,520
endif
game_arme_embaquee(10) = 1
exclude object on arme
Player_stats(0) = Solde
set dir CheminMA$+"\configs\"+Configjoueur$
delete file "stats.txt"
save array "Stats.txt",Player_stats(10)
return

Rem *** Include File: Game.dba ***
Rem Created: 30/08/2007 22:14:12

Rem Included in Project: C:\DBP\Projects\Metal Assault\Metal Assault.dbpro

game:

rem =__================================================================================================================================
rem |__)  __         __  |    ___       __   __  o  __   __  o  __   __  |    ___   =====================================================
rem |__) (__) (__(_ (___ |_, (__/_     |__) |  ' | |  ) (___ | |__) (__( |_, (__/_  =============================================================
rem                                    |                       |                     =======================================================
rem ===================================================================================================================================

do
sync
tempboucle_temoin = timer()

NewExtrapolationTimer=timer()
Extrapolation=(NewExtrapolationTimer-OldExtrapolationTimer)/2
OldExtrapolationTimer=NewExtrapolationTimer
inc temporel,Extrapolation*3

ink rgb(255,255,255),0
position mouse 0,0
set cursor 0,0
FPS = screen fps() : print "FPS : ",FPS
print "Polygones :", statistic(1)
print "X : ",object position x(game_arme_coress(arme)),"Y : ",object position y(game_arme_coress(arme)),"Z : ",object position z(game_arme_coress(arme))
print
print "NbBot : " ,NbBot
print Bot(0).objet
print "X : ",object position x(Bot(0).objet),"Y : ",object position y(game_arme_coress(arme)),"Z : ",object position z(game_arme_coress(arme))



if gameplay_Type = 1
gosub Game_first_person
endif

if gameplay_Type = 2
gosub Game_Goliath
endif

rem les checks du gameplay sont a l'intérieur, faut laisser pour les routines hors gameplay...

gosub game_Vehicules


gosub Game_aux

tempboucle_delta = timer()-tempboucle_temoin
loop

rem ===========================================================================================================================
rem *_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*
rem ==========================================================================================================================

game_aux:


if gameplay_Type = 1
rem on est mort si on touche le ciel
gosub skyfrag

rem le reaprovisionnement en munnition
gosub Reaprovisionement_Muns

rem on affiche l'ATH
gosub Game_UI

endif

rem on peut utiliser les vehicules
gosub switch_gameplay

espion2 = timer()
rem le texte pricipal (update)
for t = 0 to 254
if txt_exist(t) = 1 then Update_txt(t,Extrapolation/6)
next t

rem pon vreifie que tout les sprites seronts affichés
for t= 1 to 99999
if sprite exist (t) then set sprite priority t,1
next t

for t = 0 to Nbbot-1
if Bot(t).Vie > 0 then sc_updateobject Bot(t).objet
next t

rem les aux en tout genre
gosub dam_warn

rem l'administration de la partie
if type_game$="Match_mort"
gosub admin
endif
if type_game$="Domination"
gosub domadmin
endif

rem armes et tout le tralala
gosub armes

rem les enemeis et les alliés
if type_game$="Match_mort"
gosub IAmatchamort
endif

if type_game$="Domination"
gosub IAdomination
endif

rem on tourene eventuellement le ciel
gosub rotate_sky

rem les effets de flou
if vie < 20 then game_flou = 15+vie*2 : else : game_flou = 255
update_fx(abs(game_flou),0,0,timer()/1000)

rem l'eau
if water > 0
UpDate_old_eau(1)
endif


`=== Control Hologram Constants ===========================
 set vector4 2,camera position x(),camera position y(),camera position z(),0.0
 set effect constant vector 2,"EyePos",2

rem retour au menu principal
if escapekey() = 1
set dir CheminMA$+"\configs\"+Configjoueur$
delete file "stats.txt"
save array "Stats.txt",Player_stats(10)
close file 1
delete animation 1
delete music 1
for t = 1 to 60000
if object exist(t) = 1 then delete object t
next t
for t = 1 to 60000
if image exist(t) = 1 then delete image t
next t
for t = 1 to 60000
if sprite exist(t) = 1 then delete sprite t
next t
for t = 1 to 60000
if sound exist(t) = 1 then delete sound t
next t
for t = 1 to 60000
if light exist(t) = 1 then delete light t
next t
for t = 1 to 60000
if object exist(t)
SC_setupObject t,0,0
SC_removeObject t
endif
next t
set display mode param(35),param(36),param(37)
goto debut
else
goto game
endif

espi_delta2 =timer() - espion2
return


rem ===========================================================================================================================
rem *_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*
rem ==========================================================================================================================



Etat_Mort:
break
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 0.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
temp = 255
stop object game_arme_coress(arme)
sprite 16,0,-12000,16
game_morttime# =50
set current bitmap 0
ink rgb(255,0,0),0
box 0,0,param(35),param(36)
get image 17,0,0,param(35),param(36)
ink rgb(255,255,255),0
Game_tombee# = 0
Fragdaffile = 0


do
sync
if dam_warn > 0 then dec dam_warn
set sprite alpha 18,dam_warn
update_fx(10,0,0,timer()/1000)
NewExtrapolationTimer=timer()
Extrapolation=(NewExtrapolationTimer-OldExtrapolationTimer)/2
OldExtrapolationTimer=NewExtrapolationTimer
dec game_morttime#,Extrapolation*0.02
position camera object position x(3),object position y(3)+tailleperso#-Game_tombee#,object position z(3)
if Game_tombee# < tailleperso# then inc Game_tombee#,Extrapolation*0.2
oldcamy#=camy#
oldcamx#=camx#
camy#=camy#+mousemoveY()*0.005*zoom
camx#=camx#+mousemoveX()*0.005*zoom
if camy#>70 then camy#=70
if camy#<-100 then camy# = -100
yrotate camera camx#
xrotate camera camy#
zrotate camera Game_tombee#
if game_morttime# < 0 then exit
loop

delete sprite 100000
zrotate camera 0
set dir CheminMA$+"\Jpegs\jeu"
set image colorkey 255,255,255
if image exist(17) =1 then delete image 17
load image "Small Score.tga",17
sprite 17,param(35)/2-100,0,17
set image colorkey 0,0,0
loop object game_arme_coress(arme)
Vie = 100
return





remstart
======================================================================================================================================================================

 ______  __   __      _______ __   _ _____  _____  _______  ______
 |_____]   \_/        |______ | \  |   |   |_____] |______ |_____/
 |_____]    |         ______| |  \_| __|__ |       |______ |    \_

 ______  _____ __   _ _______ _____  ______ _______
 |_____]   |   | \  | |_____|   |   |_____/ |______
 |_____] __|__ |  \_| |     | __|__ |    \_ |______


 ====================================================================================================================================================
 remend



           Rem *** Include File: Game_FPS.dba ***
Rem Created: 14/05/2008 18:54:14

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
Game_first_person:

vitesse_joueur# = ((Extrapolation*Coeff_Vitesse_Joueur#*1.2)/coef_ralentissement)/coef_ralentissement_2#
if coef_ralentissement_2# > 1.0 then dec coef_ralentissement_2#,Extrapolation/3
if coef_ralentissement_2# < 1.0 then coef_ralentissement_2# = 1.0


if upkey() or KEYSTATE(param(48)) xor downkey() or KEYSTATE(param(49)) or leftkey() or KEYSTATE(param(51)) xor rightkey() = 1 or KEYSTATE(param(50)) then player_moving = 1 : else : player_moving = 0
if player_moving = 1 and sound looping(100)=0 then loop sound 100 : else : stop sound 100

if upkey() or KEYSTATE(param(48)) xor downkey() or KEYSTATE(param(49)) then player_mvt = 1 : else : player_mvt = 0
oldcamy#=camy#
oldcamx#=camx#
camy#=(camy#+mousemoveY()*0.005*zoom)+((sin(90*sin(200*timer()/((Player_MovHB#+1)*100)+90))/(-10))/2)*player_mvt
camx#=(camx#+mousemoveX()*0.005*zoom)+((sin(100*timer()/((Player_MovHB#+1)*100))/10)/2)*player_mvt
if camy#>70 then camy#=70
if camy#<-100 then camy# = -100
yrotate camera camx#
xrotate camera camy#

position object game_arme_coress(arme),object position x(3),object position y(3)+tailleperso#,object position z(3)
rotate object game_arme_coress(arme),camy#+270,camx#,0
   oldx# = object position x(3)
   oldy# = object position y(3)
   oldz# = object position z(3)
   oldx2# = object position x(2)
   oldy2# = object position y(2)
   oldz2# = object position z(2)
   oldx3# = object position x(4)
   oldy3# = object position y(4)
   oldz3# = object position z(4)
if Joueur_immobile = 0
Player_MovHB# = 0
Player_MovDG# = 0
if upkey()=1 or KEYSTATE(param(48)) = 1 then inc Player_MovHB#,vitesse_joueur#
if downkey()=1 or KEYSTATE(param(49)) = 1 then dec Player_MovHB#,vitesse_joueur#
if rightkey() = 1 or KEYSTATE(param(50)) = 1 then inc Player_MovDG#,vitesse_joueur#/2
if leftkey() = 1 or KEYSTATE(param(51)) = 1 then dec Player_MovDG#,vitesse_joueur#/2
Mov_VittHB# = curvevalue(Player_MovHB#,Mov_VittHB#,5)
Mov_VittDG# = curvevalue(Player_MovDG#,Mov_VittDG#,5)
if Player_MovHB# <> 0
x#=newxvalue(x#,camX#,Mov_VittHB#)
z#=newzvalue(z#,camx#,Mov_VittHB#)
endif
if Player_MovDG# <> 0
X# = NewXValue(X#,camx#+90,Mov_VittDG#)
Z# = NewZValue(Z#,camx#+90,Mov_VittDG#)
endif
endif
position object 3,x#,y#,z#
position camera object position x(3),object position y(3)+tailleperso#,object position z(3)
position object game_arme_coress(arme),object position x(3),object position y(3)+tailleperso#,object position z(3)
position object 1002,object position x(3),object position y(3)+tailleperso#,object position z(3) : sc_updateobject 1002
position object 2,object position x(3),object position y(3)+tailleperso#,object position z(3)
position object 4,object position x(3),object position y(3)+genouperso#,object position z(3)
   x2# = object position x(3)
   y2# = object position y(3)
   z2# = object position z(3)
   x3# = object position x(2)
   y3# = object position y(2)
   z3# = object position z(2)
   x4# = object position x(4)
   y4# = object position y(4)
   z4# = object position z(4)
 rem gravitée
 if on_saute  = 0
 dec y#,gravite#
 y# = y# - gravite#
 endif
 collide = sc_SphereSlideGroup(0,oldx2#,oldy2#-45,oldz2#,x3#,y3#-45,z3#,radius#,0)
   if collide>0
   if temoin_saut = 1 then play sound 102
   temoin_saut = 0
      x# = sc_getCollisionSlideX()
      y# = sc_getCollisionslideY()
      z# = sc_getCollisionSlideZ()
      position object 3,x#,y#,z#
      position camera object position x(3),object position y(3)+tailleperso#,object position z(3)
      position object game_arme_coress(arme),object position x(3),object position y(3)+tailleperso#,object position z(3)
      position object 1002,object position x(3),object position y(3)+tailleperso#,object position z(3) : sc_updateobject 1002
      position object 2,object position x(3),object position y(3)+tailleperso#,object position z(3)
      position object 4,object position x(3),object position y(3)+genouperso#,object position z(3)
   endif
 rem gravitée
 if on_saute  = 0
 y# = y# - gravite#
 endif
rem la fin de la gravitée si on touche par terre
   collide2 = sc_SphereSlideGroup(0,oldx#,oldy#,oldz#,x2#,y2#,z2#,radius#,0)
   if collide2>0
   if temoin_saut = 1 then play sound 102
   temoin_saut = 0
      y# = sc_getCollisionslideY()
      position object 3,x#,y#,z#
      position camera object position x(3),object position y(3)+tailleperso#,object position z(3)
      position object game_arme_coress(arme),object position x(3),object position y(3)+tailleperso#,object position z(3)
      position object 1002,object position x(3),object position y(3)+tailleperso#,object position z(3) : sc_updateobject 1002
      position object 2,object position x(3),object position y(3)+tailleperso#,object position z(3)
      position object 4,object position x(3),object position y(3)+genouperso#,object position z(3)
   endif
 rem gravitée
 if on_saute  = 0
 y# = y# - gravite#
 endif
 collide3 = sc_SphereSlideGroup(0,oldx3#,oldy3#,oldz3#,x4#,y4#,z4#,radius#,0)
   if collide3>0 and collide=0
   if temoin_saut = 1 then play sound 102
   temoin_saut = 0
     inc y#,gravite#+0.1
     position object 3,x#,y#,z#
     position camera object position x(3),object position y(3)+tailleperso#,object position z(3)
     position object game_arme_coress(arme),object position x(3),object position y(3)+tailleperso#,object position z(3)
     position object 1002,object position x(3),object position y(3)+tailleperso#,object position z(3) : sc_updateobject 1002
     position object 2,object position x(3),object position y(3)+tailleperso#,object position z(3)
     position object 4,object position x(3),object position y(3)+genouperso#,object position z(3)
   endif
 rem gravitée
 if on_saute  = 0
 y# = y# - gravite#
 endif


   sc_updateObject 1
   sc_updateObject 2
   sc_updateObject 3
   sc_updateObject 4
   sc_updateObject 5

rem saut
if KEYSTATE(57) = 1 and on_saute = 0
if temoin_saut = 0
on_saute = 1
tenpsaut# = 0
play sound 101
endif
endif
if on_saute = 1
inc y#,valsaut#
valsaut# = 4*sqrt(tenpsaut#)
inc tenpsaut#,Extrapolation/1.5
endif
if tenpsaut# > 90 then tenpsaut# = 0 : on_saute  = 0 : temoin_saut = 1
   return



Rem *** Include File: Armes.dba ***
Rem Created: 31/12/2007 17:42:44

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
armes:
OLDvie  = vie
rem  on dit si l'arme peut tirer
if mouseclick() =1 and time+1000<timer()
Game_tir_possible =1
Game_DCA_tir_possible = 1
else
Game_tir_possible =0
Game_DCA_tir_possible = 0
endif
if mouseclick() =1 and time+100<timer()
Game_minigun_tir_possible =1
else
Game_minigun_tir_possible =0
endif
if object playing(game_arme_coress(arme)) = 0
temp = game_arme_coress(arme)
select temp
case 1030
loop object game_arme_coress(arme),0,30
endcase
case default
loop object game_arme_coress(arme),0,20
endcase
endselect
endif
if mouseclick() =1 or mouseclick() = 3 and time+55<timer()
Game_Famas_tir_possible =1
else
Game_Famas_tir_possible =0
endif
if mouseclick() =1 and time+200<timer()
Game_m81_tir_possible =1
Game_acog_tir_possible =1
else
Game_m81_tir_possible =0
Game_acog_tir_possible =0
endif
if mouseclick() =1 and time+25<timer()
Game_ak74_tir_possible =1
else
Game_ak74_tir_possible =0
endif


rem on s'occupe des roquettes
if LRmode = 0
temp = 0
for t = 1100 to 1159
inc temp
if Game_roket_life(temp) > 0
move object t+1,Extrapolation*4
Game_roket_life(temp) = Game_roket_life(temp)-1
sc_updateobject t+1
for i= 0 to nbbot-1
collide = sc_objectcollision(t+1,Bot(i).objet)
if collide > 0 then exit
next i
if collide > 0 and Bot(i).Vie > 0
if t <=30 then dec Bot(i).Vie, rnd(150): play sound 4
if t > 30 then dec Bot(i).Vie, rnd(50) : play sound 4
endif
endif
next t
endif
if LRmode = 1
temp = 0
for t = 1100 to 1159
inc temp
if Game_roket_life(temp) > 0
move object t+1,Extrapolation*4
Game_roket_life(temp) = Game_roket_life(temp)-1
sc_updateobject t+1
for i= 0 to nbbot-1
collide = sc_objectcollision(t+1,Bot(i).objet)
if collide > 0 then exit
next i
if collide > 0 and Bot(i).Vie > 0
if t <=30 then dec Bot(i).Vie, rnd(150): play sound 4
if t > 30 then dec Bot(i).Vie, rnd(50) : play sound 4
endif
endif
next t
endif
if game_arme_coress(arme)  = 1060 and mouseclick() =1 then inc game_Lr_chargement

rem on s'occupe des balles du DCA
for t= 0 to 9
if Game_DCA_ballife(t)>0
move object t+1161,60
sc_updateobject t+1161
Game_DCA_ballife(t) = Game_DCA_ballife(t)-1
for i= 0 to nbbot-1
DCAcollide = SC_objectcollision(t+1161,1)*4
if DCAcollide > 0 then exit
DCAcollide = SC_objectcollision(t+1161,Bot(i).objet)
if DCAcollide > 0 then exit
next t
if DCAcollide >= 1 then Game_DCA_ballife(t) = 0 : hide object t+1161
if DCAcollide = 1 then play sound 4 : dec Bot(i).Vie,10+rnd(20)
endif
if Game_DCA_ballife(t)<=0 then hide object t+1161
next t


rem on s'occupe des balles du goliath
t= 8000
for t= 8000 to 8000+Goliath_nb_bal-32
if Goliath_bal_life(t-8000) <= 0 then  hide object t+1 : position object t+1,0,90000000,0
if Goliath_bal_life(t-8000) > 0
   move object t+1,30
   sc_updateobject t+1
   dec Goliath_bal_life(t-8000)
    for i= 0 to nbbot-1
    Gholiath_collide = sc_objectcollision(t+1,Bot(i).objet)
    if Gholiath_collide > 0 then exit
    next i
   if Gholiath_collide > 0 then dec Bot(i).Vie,rnd(50) : Goliath_bal_life(t-8000) = 0
   else
   position object t+1,0,90000000,0
   sc_updateobject t+1
   hide object t+1
   endif
next t

if gameplay_Type = 1
rem =============================================== changement d'arme =========================================================
rem ==========================================================================================================================
if Dans_le_goliath_le_joueur_est = 0

oldmousZ# = mousZ#
mousZ# = mousZ# + mousemoveZ()
if oldmousZ#-mousZ# = 0
else
oldarme = arme
exclude object on game_arme_coress(arme)
for t = 1400 to 1700
if object exist(t) = 1 then position object t,0,90000000,0
next t
   if oldmousZ#-mousZ# > 0
      inc arme
      if arme > nb_arme-1 then arme = 0
      exclude object off game_arme_coress(arme)
   endif

   if oldmousZ#-mousZ# < 0
      dec arme
      if arme < 0 then arme = nb_arme-1
      exclude object off game_arme_coress(arme)
   endif
   if zoom not 60 then dessomee = 1 : zoom = 60 :set camera fov zoom : hide sprite 14: exclude object off game_arme_coress(arme)
   exclude object off game_arme_coress(arme)
endif
if arme > nb_arme-1 then arme = 0
if arme < 0 then arme = nb_arme-1


temp = game_arme_coress(arme)
select temp

Rem ================================================= Classical Sniper Rifle ====================================================
rem =========================================================================================================================

   case 1070
   set cursor param(35)-256,param(36)-60
   print "Classical Sniper Rifle"
   set cursor param(35)-256,param(36)-40
   print "Equipé d'une lunette 3-9.50"
   if CsniperR_Silencieux > 0
   position object CsniperR_Silencieux,object position x(3),object position y(3)+tailleperso#,object position z(3)
   rotate object CsniperR_Silencieux,camy#+270,camx#,0
   endif
   rem tir
   if mouseclick() = 1 and Game_tir_possible =1 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   time = timer()
   stop object game_arme_coress(arme)
   Rand = rnd(1)
   select rand
   case 1
   play object game_arme_coress(arme),25,30
   if CsniperR_Silencieux > 0 then play object CsniperR_Silencieux,25,30
   endcase
   case 0
   play object game_arme_coress(arme),45,50
   if CsniperR_Silencieux > 0 then play object CsniperR_Silencieux,45,50
   endcase
   endselect
   if CsniperR_Silencieux = 0
   play sound 1070
   else
   play sound CsniperR_Silencieux
   endif
   tX# = camera position X()
   tY# = camera position y()
   tZ# = camera position z()
   move camera 12000
   Xtemp# = camera position X()
   Ytemp# = camera position y()
   Ztemp# = camera position z()
   move camera -12000
   collide=SC_rayCast(0,tX#,tY#,tZ#,Xtemp#,Ytemp#,Ztemp#,0)
   if collide > 0
   inc p
   if p > 10 then p = 1
   Xtemp# = SC_getStaticCollisionX()
   Ytemp# = SC_getStaticCollisionY()
   Ztemp# = SC_getStaticCollisionZ()
   rx#=SC_getCollisionNormalX()
   ry#=SC_getCollisionNormalY()
   rz#=SC_getCollisionNormalZ()
   endif
   endif

   rem zoom
   if mouseclick() = 2 and zoom = 60 and zoom_encour = 0  and dessomee = 1
   zoom = 59
   zoom_encour = 1
   sprite 14,1,1,14
   show sprite 14
   exclude object on game_arme_coress(arme)
   if CsniperR_Silencieux > 0 then exclude object on CsniperR_Silencieux
   set camera fov zoom
   endif

   if mouseclick() = 2 and zoom < 60 and zoom_encour = 1
   dec zoom,5
   if zoom < 10 then zoom = 10
   set camera fov zoom
   endif

   if mouseclick() = 0 and zoom < 60 and zoom_encour = 1 then zoom_encour = 0 : desoomee = 1

   if mouseclick() = 2 and zoom < 60 and zoom_encour = 0 and desoomee = 1
   inc zoom,30
   if zoom > 60
      zoom = 60
      hide sprite 14
      exclude object off game_arme_coress(arme)
      if CsniperR_Silencieux > 0 then exclude object off CsniperR_Silencieux
   endif
   if zoom = 60
      hide sprite 14
      exclude object off game_arme_coress(arme)
      if CsniperR_Silencieux > 0 then exclude object off CsniperR_Silencieux
   endif
   set camera fov zoom
   dessomee = 0
   endif

   if mouseclick() = 0 and dessomee = 0 then dessomee = 1

   endcase

Rem ================================================= Double Lance-roquette =================================================
rem =========================================================================================================================

   case 1060
   set cursor param(35)-256,param(36)-100
   print "Double Lance Roquettes"
   set cursor param(35)-256,param(36)-60
   print "(deux Superbazookas assemblés)"
   if mouseclick() =0 then game_Lr_chargementOLD = game_Lr_chargement : game_roket_dejatire = 0
   if Game_roket_select > 1129 then Game_roket_select = 1102
   if Game_biroket_select > 1159 then Game_biroket_select = 1132
   if Game_roket_life(Game_roket_select-1100) < 0 then dec Game_roket_select
   if Game_roket_life(Game_biroket_select-1100) < 0 then dec Game_biroket_select

   if  game_Lr_chargement = game_Lr_chargementOLD and game_Lr_chargementOLD > 0 and time+1000<timer() and  game_roket_dejatire = 0 and  game_Lr_chargement > 10 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0
   dec listarme(game_arme_coress(arme)-1000).bulets_encour,
   time = timer()
   stop object game_arme_coress(arme)
   play object game_arme_coress(arme),45,50
   play sound 1060
   exclude object off Game_biroket_select
   loop object Game_biroket_select,0,20
   rotate object Game_biroket_select,camera angle X(),camera angle y(),camera angle z()
   position object Game_biroket_select,camera position X(),camera position y(),camera position z()
   Game_roket_life(Game_biroket_select-1100) = 1000
   inc Game_biroket_select
   game_Lr_chargement = 0
   game_roket_dejatire = 1
   endif

   if game_Lr_chargement = game_Lr_chargementOLD and game_Lr_chargementOLD > 0 and time+1000<timer() and  game_roket_dejatire = 0 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   time = timer()
   stop object game_arme_coress(arme)
   play object game_arme_coress(arme),25,30
   play sound 1060
   exclude object off Game_roket_select
   rotate object Game_roket_select,camera angle X(),camera angle y(),camera angle z()
   position object Game_roket_select,camera position X(),camera position y(),camera position z()
   Game_roket_life(Game_roket_select-1100) = 1000
   inc Game_roket_select
   game_Lr_chargement = 0
   game_roket_dejatire = 1
   endif

   if mouseclick() =2
   if mouseclick() = 2 and LRmode = 0 then LRmode = 1 : goto Game_lr_suite
   if mouseclick() = 2 and LRmode = 1 then LRmode = 0
   Game_lr_suite:
   do
   if mouseclick() = 0 then exit
   loop
   endif

   endcase

Rem ================================================= Minigun ===============================================================
rem =========================================================================================================================

   case 1050
   set cursor param(35)-256,param(36)-100
   print "Double Minigun"
   set cursor param(35)-256,param(36)-60
   print "(deux M61 Soudés ensembles)"
   if mouseclick() = 1 and Game_minigun_tir_possible =1 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   time = timer()
   play sound 1050
   play object game_arme_coress(arme),50,100
   rotate camera camera angle X()+rnd(4)-2,camera angle Y()+rnd(4)-2,camera angle Z()
   tX# = camera position X()
   tY# = camera position y()
   tZ# = camera position z()
   move camera 12000
   Xtemp# = camera position X()
   Ytemp# = camera position y()
   Ztemp# = camera position z()
   move camera -12000
   collide=SC_rayCast(0,tX#,tY#,tZ#,Xtemp#,Ytemp#,Ztemp#,0)
   if collide > 0
   inc p
   if p > 10 then p = 1
   Xtemp# = SC_getStaticCollisionX()
   Ytemp# = SC_getStaticCollisionY()
   Ztemp# = SC_getStaticCollisionZ()
   rx#=SC_getCollisionNormalX()
   ry#=SC_getCollisionNormalY()
   rz#=SC_getCollisionNormalZ()
   endif
   endif
   endcase

rem ====================================================== DCA ===============================================================
rem =========================================================================================================================

   case 1030
   set cursor param(35)-256,param(36)-100
   print "Canon DCA"
   set cursor param(35)-256,param(36)-60
   print "Défence Anti-Automates"
   if mouseclick() = 1 and Game_DCA_tir_possible =1 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   time = timer()
   stop object game_arme_coress(arme)
   play object game_arme_coress(arme),0,100
   play sound 1030
   for t = 1161 to 1170
   position object t,camera position x(),camera position y()-genouperso#,camera position z()
   rotate object t,camera angle x()+rnd(10)-5,camera angle y()+rnd(10)-5,camera angle z()+rnd(10)-5
   show object t
   Game_DCA_ballife(t-1161)=1000
   next t
   endif
   endcase
rem ====================================================== Famas ===============================================================
rem =========================================================================================================================

   case 1040
   set cursor param(35)-256,param(36)-100
   print "Famas G2"
   if Famas_Vlourd > 1
   position object Famas_Vlourd,object position x(3),object position y(3)+tailleperso#,object position z(3)
   rotate object Famas_Vlourd,camy#+270,camx#,0
   endif
   if Famas_acog > 1
   position object Famas_acog,object position x(3),object position y(3)+tailleperso#,object position z(3)
   rotate object Famas_acog,camy#+270,camx#,0
   endif
   if Famas_lazer > 1
   position object Famas_lazer,object position x(3),object position y(3)+tailleperso#,object position z(3)
   rotate object Famas_lazer,camy#+270,camx#,0
   endif
   if Famas_Silencieux > 1
   position object Famas_Silencieux,object position x(3),object position y(3)+tailleperso#,object position z(3)
   rotate object Famas_Silencieux,camy#+270,camx#,0
   endif

   if mouseclick() = 1 and Game_Famas_tir_possible =1 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0 and zoom = 60
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   time = timer()
   if Famas_Silencieux = 0
   play sound 1040
   else
   play sound Famas_Silencieux
   endif
   stop object game_arme_coress(arme)
   play object game_arme_coress(arme),50,55
   if zoom = 60
   rotate camera camera angle X()+rnd(4)-2,camera angle Y()+rnd(4)-2,camera angle Z()
   endif
   tX# = camera position X()
   tY# = camera position y()
   tZ# = camera position z()
   move camera 12000
   Xtemp# = camera position X()
   Ytemp# = camera position y()
   Ztemp# = camera position z()
   move camera -12000
   collide=SC_rayCast(0,tX#,tY#,tZ#,Xtemp#,Ytemp#,Ztemp#,0)
   if collide > 0
   inc p
   if p > 10 then p = 1
   Xtemp# = SC_getStaticCollisionX()
   Ytemp# = SC_getStaticCollisionY()
   Ztemp# = SC_getStaticCollisionZ()
   rx#=SC_getCollisionNormalX()
   ry#=SC_getCollisionNormalY()
   rz#=SC_getCollisionNormalZ()
   endif
   endif

   if mouseclick() = 3 and Game_Famas_tir_possible =1 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0 and Famas_mire = 1
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   time = timer()
   if Famas_Silencieux = 0
   play sound 1040
   else
   play sound Famas_Silencieux
   endif
   stop object game_arme_coress(arme)
   play object game_arme_coress(arme),50,55
   if zoom = 60
   rotate camera camera angle X()+rnd(4)-2,camera angle Y()+rnd(4)-2,camera angle Z()
   endif
   tX# = camera position X()
   tY# = camera position y()
   tZ# = camera position z()
   move camera 12000
   Xtemp# = camera position X()
   Ytemp# = camera position y()
   Ztemp# = camera position z()
   move camera -12000
   collide=SC_rayCast(0,tX#,tY#,tZ#,Xtemp#,Ytemp#,Ztemp#,0)
   if collide > 0
   inc p
   if p > 10 then p = 1
   Xtemp# = SC_getStaticCollisionX()
   Ytemp# = SC_getStaticCollisionY()
   Ztemp# = SC_getStaticCollisionZ()
   rx#=SC_getCollisionNormalX()
   ry#=SC_getCollisionNormalY()
   rz#=SC_getCollisionNormalZ()
   endif
   endif


   if mouseclick() = 1 and Game_acog_tir_possible =1 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0 and zoom < 60
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   time = timer()
   if Famas_Silencieux = 0
   play sound 1040
   else
   play sound Famas_Silencieux
   endif
   stop object game_arme_coress(arme)
   play object game_arme_coress(arme),50,55
   if zoom = 60
   rotate camera camera angle X()+rnd(0.5)-0.25,camera angle Y()+rnd(0.5)-0.25,camera angle Z()
   endif
   tX# = camera position X()
   tY# = camera position y()
   tZ# = camera position z()
   move camera 12000
   Xtemp# = camera position X()
   Ytemp# = camera position y()
   Ztemp# = camera position z()
   move camera -12000
   collide=SC_rayCast(0,tX#,tY#,tZ#,Xtemp#,Ytemp#,Ztemp#,0)
   if collide > 0
   inc p
   if p > 10 then p = 1
   Xtemp# = SC_getStaticCollisionX()
   Ytemp# = SC_getStaticCollisionY()
   Ztemp# = SC_getStaticCollisionZ()
   rx#=SC_getCollisionNormalX()
   ry#=SC_getCollisionNormalY()
   rz#=SC_getCollisionNormalZ()
   endif
   endif


   rem zoom
   if Famas_acog > 1

   if mouseclick() = 2 and zoom = 60 and zoom_encour = 0  and dessomee = 1
   zoom = 59
   zoom_encour = 1
   sprite 14,1,1,20
   show sprite 14
   hide sprite 15
   exclude object on game_arme_coress(arme)
   if Famas_Silencieux > 0 then exclude object on Famas_Silencieux
   set camera fov zoom
   endif

   if mouseclick() = 2 and zoom < 60 and zoom_encour = 1
   dec zoom,5
   if zoom < 10 then zoom = 10
   set camera fov zoom
   endif

   if mouseclick() = 0 and zoom < 60 and zoom_encour = 1 then zoom_encour = 0 : desoomee = 1

   if mouseclick() = 2 and zoom < 60 and zoom_encour = 0 and desoomee = 1
   inc zoom,30
   if zoom > 60
      zoom = 60
      hide sprite 14
      show sprite 15
      exclude object off game_arme_coress(arme)
      if Famas_Silencieux > 0 then exclude object off Famas_Silencieux
   endif
   if zoom = 60
      hide sprite 14
      show sprite 15
      exclude object off game_arme_coress(arme)
      if Famas_Silencieux > 0 then exclude object off Famas_Silencieux
   endif
   set camera fov zoom
   dessomee = 0
   endif

   if mouseclick() = 0 and dessomee = 0 then dessomee = 1
   endif

if Famas_acog = 0
   if mouseclick() = 2
   oldfamasmire = Famas_mire
   Famas_mire = 1
   sprite 14,1,1,21
   show sprite 14
   hide sprite 15
   exclude object on game_arme_coress(arme)
   if Famas_Silencieux > 0 then exclude object on Famas_Silencieux
   if Famas_Vlourd > 0 then exclude object on Famas_Vlourd
   if Famas_lazer > 0 then exclude object on Famas_lazer
   coef_ralentissement_2# = 3
   if Famas_Lazer > 1
   Game_lazer_visible = 1
   endif
   endif
   if mouseclick() = 1
   oldFamasmire = Famas_mire
   Famas_mire = 0
   hide sprite 14
   show sprite 15
   coef_ralentissement_2# = 1
   Game_lazer_visible = 0
   endif
   if mouseclick() = 0
   oldFamasmire = Famas_mire
   Famas_mire = 0
   hide sprite 14
   show sprite 15
   coef_ralentissement_2# = 1
   Game_lazer_visible = 0
   endif
   if oldfamasmire = 1 and famas_mire = 0
   exclude object off game_arme_coress(arme)
   if Famas_Silencieux > 0 then exclude object off Famas_Silencieux
   if Famas_Vlourd > 0 then exclude object off Famas_Vlourd
   if Famas_lazer > 0 then exclude object off Famas_lazer
   coef_ralentissement_2# = 1
   endif
endif

   endcase

Rem ================================================= M81 mini ===============================================================
rem =========================================================================================================================

   case 1051
   set cursor param(35)-256,param(36)-100
   print "M81 mini"
   set cursor param(35)-256,param(36)-60
   print "(M61 trafiqué et allégé)"
   if mouseclick() = 1 and Game_m81_tir_possible =1 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   time = timer()
   play sound 1051
   stop object game_arme_coress(arme)
   play object game_arme_coress(arme),50,100
   rotate camera camera angle X()+rnd(4)-2,camera angle Y()+rnd(4)-2,camera angle Z()
   tX# = camera position X()
   tY# = camera position y()
   tZ# = camera position z()
   move camera 12000
   Xtemp# = camera position X()
   Ytemp# = camera position y()
   Ztemp# = camera position z()
   move camera -12000
   collide=SC_rayCast(0,tX#,tY#,tZ#,Xtemp#,Ytemp#,Ztemp#,0)
   if collide > 0
   inc p
   if p > 10 then p = 1
   Xtemp# = SC_getStaticCollisionX()
   Ytemp# = SC_getStaticCollisionY()
   Ztemp# = SC_getStaticCollisionZ()
   rx#=SC_getCollisionNormalX()
   ry#=SC_getCollisionNormalY()
   rz#=SC_getCollisionNormalZ()
   endif
   endif
   endcase

Rem ================================================= AK 74 ===============================================================
rem =========================================================================================================================

   case 1041
   set cursor param(35)-256,param(36)-100
   print "AK-74"
   set cursor param(35)-300,param(36)-60
   print "Avtomat Kalachnikova modèle 1974"
   rem si on a un silencieux
   if Ak_74_Silencieux > 0
   set cursor param(35)-300,param(36)-40
   print "Et en plus elle est munie d'un silencieux, a l'assault !"
   position object Ak_74_Silencieux,object position x(3),object position y(3)+tailleperso#,object position z(3)
   rotate object Ak_74_Silencieux,camy#+270,camx#,0
   endif


   if mouseclick() = 1 and Game_ak74_tir_possible =1 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   time = timer()
   if Ak_74_Silencieux = 0
   play sound 1041
   else
   play sound Ak_74_Silencieux
   endif
   stop object game_arme_coress(arme)
   play object game_arme_coress(arme),50,55
   rotate camera camera angle X()+rnd(4)-2,camera angle Y()+rnd(4)-2,camera angle Z()
   tX# = camera position X()
   tY# = camera position y()
   tZ# = camera position z()
   move camera 12000
   Xtemp# = camera position X()
   Ytemp# = camera position y()
   Ztemp# = camera position z()
   move camera -12000
   collide=SC_rayCast(0,tX#,tY#,tZ#,Xtemp#,Ytemp#,Ztemp#,0)
   if collide > 0
   inc p
   if p > 10 then p = 1
   Xtemp# = SC_getStaticCollisionX()
   Ytemp# = SC_getStaticCollisionY()
   Ztemp# = SC_getStaticCollisionZ()
   rx#=SC_getCollisionNormalX()
   ry#=SC_getCollisionNormalY()
   rz#=SC_getCollisionNormalZ()
   endif
   endif

   if mouseclick() = 3 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   time = timer()
   if Ak_74_Silencieux = 0
   play sound 1041
   else
   play sound Ak_74_Silencieux
   endif
   rand = rnd(1)
   if rand = 1 then rotate camera camera angle X()+rnd(2)-1,camera angle Y()+rnd(2)-1,camera angle Z()
   tX# = camera position X()
   tY# = camera position y()
   tZ# = camera position z()
   move camera 12000
   Xtemp# = camera position X()
   Ytemp# = camera position y()
   Ztemp# = camera position z()
   move camera -12000
   collide=SC_rayCast(0,tX#,tY#,tZ#,Xtemp#,Ytemp#,Ztemp#,0)
   if collide > 0
   inc p
   if p > 10 then p = 1
   Xtemp# = SC_getStaticCollisionX()
   Ytemp# = SC_getStaticCollisionY()
   Ztemp# = SC_getStaticCollisionZ()
   rx#=SC_getCollisionNormalX()
   ry#=SC_getCollisionNormalY()
   rz#=SC_getCollisionNormalZ()
   endif
   endif

   if mouseclick() = 2
   oldakmire = AK74_mire
   AK74_mire = 1
   sprite 14,1,1,22
   show sprite 14
   hide sprite 15
   exclude object on game_arme_coress(arme)
   if Ak_74_Silencieux > 0 then exclude object on Ak_74_Silencieux
   coef_ralentissement_2# = 3
   if AK_74_Lazer > 1
   Game_lazer_visible = 1
   endif
   endif
   if mouseclick() = 1
   oldakmire = AK74_mire
   AK74_mire = 0
   hide sprite 14
   show sprite 15
   coef_ralentissement_2# = 1
   Game_lazer_visible = 0
   endif
   if mouseclick() = 0
   oldakmire = AK74_mire
   AK74_mire = 0
   hide sprite 14
   show sprite 15
   coef_ralentissement_2# = 1
   Game_lazer_visible = 0
   endif
   if oldakmire = 1 and AK74_mire = 0
   exclude object off game_arme_coress(arme)
   if Ak_74_Silencieux > 0 then exclude object off Ak_74_Silencieux
   coef_ralentissement_2# = 1
   endif


   endcase
Rem ================================================= Glock ===============================================================
rem =========================================================================================================================

   case 1010
   set cursor param(35)-256,param(36)-100
   print "Glock 17"
   set cursor param(35)-300,param(36)-60
   print "Pistolet 9mm Parabellum en polymère "
   if Glock_17_Silencieux > 0
   set cursor param(35)-380,param(36)-40
   print "Evitez les detecteurs de métaux, on a pas encore inventé les silencieux en plastique"
   position object Glock_17_Silencieux,object position x(3),object position y(3)+tailleperso#,object position z(3)
   rotate object Glock_17_Silencieux,camy#+270,camx#,0
   endif
   if mouseclick() = 1 and tir_glock_phase = 0 and listarme(game_arme_coress(arme)-1000).bulets_encour > 0
   dec listarme(game_arme_coress(arme)-1000).bulets_encour
   tir_glock_phase = 1
   if Glock_17_Silencieux = 0
   play sound 1010
   else
   play sound Glock_17_Silencieux
   endif
   stop object game_arme_coress(arme)
   play object game_arme_coress(arme),50,55
   tX# = camera position X()
   tY# = camera position y()
   tZ# = camera position z()
   move camera 12000
   Xtemp# = camera position X()
   Ytemp# = camera position y()
   Ztemp# = camera position z()
   move camera -12000
   collide=SC_rayCast(0,tX#,tY#,tZ#,Xtemp#,Ytemp#,Ztemp#,0)
   if collide > 0
   inc p
   if p > 10 then p = 1
   Xtemp# = SC_getStaticCollisionX()
   Ytemp# = SC_getStaticCollisionY()
   Ztemp# = SC_getStaticCollisionZ()
   rx#=SC_getCollisionNormalX()
   ry#=SC_getCollisionNormalY()
   rz#=SC_getCollisionNormalZ()
   endif
   endif
   if mouseclick() = 0 and tir_glock_phase = 1 then tir_glock_phase = 0
   endcase

endselect

endif

rem =================================================================================================================================
rem ***-[__]-******-[__]-******-[__]-******-[__]-******-[__]-******-[__]-******-[__]-******-[__]-******-[__]-******-[__]-******-[__]-***
rem ______________________________________________________________________________________________________________________________
rem '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
rem ********************************************************************************************************************************


for i = 0 to  nbBot-1
   if collide = Bot(i).Objet and Bot(i).Vie > 0
   temp =game_arme_coress(arme)
    select temp
    case 1010
    dec Bot(i).Vie,rnd(7)
    endcase
    case 1040
    dec Bot(i).Vie,rnd(10)
    endcase
    case 1041
    dec Bot(i).Vie,rnd(7)
    endcase
    case 1050
    dec Bot(i).Vie,rnd(20)
    endcase
    case 1051
    dec Bot(i).Vie,rnd(30)
    endcase
    case 1070
    dec Bot(i).Vie,rnd(80)
    endcase
    endselect
    endif
   if collide = Bot(i).tete and Bot(i).Vie > 0 and Bot(i).tipe = 1
    dec Bot(i).Vie,rnd(9999)
    if txt_exist(2) = 0 then New_txt(2,"Headshot",26,170,170,170,screen width()/2,screen height()/2-150,257,257)
    exclude object on Bot(i).Objet
    position object Bot(i).Objet,9999999,99999999,99999999
    sc_updateobject Bot(i).objet
    drespawn = 100
   endif
Next i
if gameplay_Type = 1
if listarme(game_arme_coress(arme)-1000).Bulets_encour = 0 and listarme(game_arme_coress(arme)-1000).bulets_Stock > 0
listarme(game_arme_coress(arme)-1000).Bulets_encour = -41-rnd(20)
endif
if keystate(19) = 1
   if listarme(game_arme_coress(arme)-1000).bulets_Stock > 0
   listarme(game_arme_coress(arme)-1000).Bulets_encour = -41-rnd(20)
   endif
endif

if listarme(game_arme_coress(arme)-1000).Bulets_encour < -1 then inc listarme(game_arme_coress(arme)-1000).Bulets_encour

if listarme(game_arme_coress(arme)-1000).Bulets_encour = -1
listarme(game_arme_coress(arme)-1000).Bulets_ametre = listarme(game_arme_coress(arme)-1000).BuletsparChargeur - listarme(game_arme_coress(arme)-1000).Bulets_encour
if listarme(game_arme_coress(arme)-1000).bulets_Stock >= listarme(game_arme_coress(arme)-1000).Bulets_ametre
dec listarme(game_arme_coress(arme)-1000).bulets_Stock,listarme(game_arme_coress(arme)-1000).Bulets_ametre
listarme(game_arme_coress(arme)-1000).Bulets_encour = listarme(game_arme_coress(arme)-1000).Bulets_encour + listarme(game_arme_coress(arme)-1000).Bulets_ametre
else
listarme(game_arme_coress(arme)-1000).Bulets_encour = listarme(game_arme_coress(arme)-1000).bulets_Stock
listarme(game_arme_coress(arme)-1000).bulets_Stock = 0
endif
endif
endif


endif
return

Rem *** Include File: Persos.dba ***
Rem Created: 01/01/2008 15:53:13

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro

IAmatchamort:

for i = 0 to nbBot-1

if Bot(i).cible > 0
if Bot(Bot(i).cible).Vie <= 0
oldcible = Bot(i).cible
   repeat
   inc Bot(i).cible
   if Bot(i).cible = Nbbot then Bot(i).cible = 0
   if Bot(i).cible = oldcible then Bot(i).cible = (Bot(i).cible+1)*-1
   until Bot(Bot(i).cible).Vie > 0
endif
endif

if Bot(i).cible < 0
if (Bot(i).cible+1)*-1 > 0 then Bot(i).cible = (Bot(i).cible+1)*-1
endif

sc_updateobject Bot(i).objet
if Bot(i).Vie > 0
position object Bot(i).objet,Bot(i).X#,Bot(i).Y#,Bot(i).Z#
if Bot(i).cible = nballies
point object Bot(i).objet,object position x(1002),object position y(1002),object position z(1002)
else
point object Bot(i).objet,object position x(allie(Bot(i).cible).objet),object position y(allie(Bot(i).cible).objet),object position z(allie(Bot(i).cible).objet)
endif
if distance(Bot(i).objet,3)> 300
Bot(i).oX# = object position X(Bot(i).objet)
Bot(i).oY# = object position Y(Bot(i).objet)
Bot(i).oZ# = object position Z(Bot(i).objet)

rem le décisionel
if Bot(i).DecisionDuree <= 0
Bot(i).DecisionDuree = 80+rnd(40)
IA_Decision_TempVal_DecisionVitesse = rnd(1200)
Bot(i).DecisionVitesse# = IA_Decision_TempVal_DecisionVitesse/1000
if distance(Bot(i).objet,3) < 400
Bot(i).Decision = 4
else
Bot(i).Decision = rnd(4)
endif
if distance(Bot(i).objet,3) > 2000
Bot(i).Decision = 3
else
Bot(i).Decision = rnd(6)
endif
endif

rem l'executif
if Bot(i).Decision = 0
   dec Bot(i).DecisionDuree,Extrapolation*Bot(i).DecisionVitesse#
endif
if Bot(i).Decision = 1
   move object left Bot(i).objet,Extrapolation*Bot(i).DecisionVitesse#*0.8
   Bot(i).DecisionDuree = Bot(i).DecisionDuree - int(Extrapolation*Bot(i).DecisionVitesse#*0.8)
endif
if Bot(i).Decision = 2
   move object right Bot(i).objet,Extrapolation*Bot(i).DecisionVitesse#*0.8
   dec Bot(i).DecisionDuree,Extrapolation*Bot(i).DecisionVitesse#*0.8
endif
if Bot(i).Decision = 3
   move object Bot(i).objet,Extrapolation*Bot(i).DecisionVitesse#
   dec Bot(i).DecisionDuree,Extrapolation*Bot(i).DecisionVitesse#
endif
if Bot(i).Decision = 4
   move object Bot(i).objet,(Extrapolation*Bot(i).DecisionVitesse#)*-1
   dec Bot(i).DecisionDuree,Extrapolation*Bot(i).DecisionVitesse#
endif
if Bot(i).Decision = 5
   move object Bot(i).objet,Extrapolation*Bot(i).DecisionVitesse#
   dec Bot(i).DecisionDuree,Extrapolation*Bot(i).DecisionVitesse#
endif
if Bot(i).Decision = 6
   move object Bot(i).objet,Extrapolation*Bot(i).DecisionVitesse#
   dec Bot(i).DecisionDuree,Extrapolation*Bot(i).DecisionVitesse#
endif



Bot(i).X# = object position X(Bot(i).objet)
Bot(i).Y# = object position Y(Bot(i).objet)
Bot(i).Z# = object position Z(Bot(i).objet)
Bot(i).Y# = Bot(i).Y# -gravite#
if Bot(i).tipe = 0
Bot(i).collide = SC_SphereCast(1,Bot(i).ox#,Bot(i).oy#,Bot(i).oz#,Bot(i).X#,Bot(i).Y#,Bot(i).Z#,40,0)
endif
if Bot(i).tipe = 1
Bot(i).collide = SC_SphereCast(1,Bot(i).ox#,Bot(i).oy#,Bot(i).oz#,Bot(i).X#,Bot(i).Y#,Bot(i).Z#,80,0)
endif
if Bot(i).collide
Bot(i).X# = SC_getcollisionslideX()
Bot(i).Y# = SC_getcollisionslideY()
Bot(i).Z# = SC_getcollisionslideZ()
endif
position object Bot(i).objet,Bot(i).X#,Bot(i).Y#,Bot(i).Z#
endif
if Bot(i).tipe = 1 then position object  Bot(i).tete,Bot(i).x#,Bot(i).y#+180,Bot(i).z# : sc_updateobject Bot(i).tete
Bot(i).Precision  = 130-3*sqrt(distance(Bot(i).objet,3))+52+distance(Bot(i).objet,3)^(1/3)
endif


if Bot(i).temptir+1000<timer() and Bot(i).Tipe = 1
Bot(i).tirpossible = 1
else
Bot(i).tirpossible = 0
endif
if Bot(i).temptir+3000<timer() and Bot(i).Tipe = 0
Bot(i).tirpossible = 1
else
Bot(i).tirpossible = 0
endif

if Bot(i).tirpossible = 1
Bot(i).X# = object position X(Bot(i).objet)
Bot(i).Y# = object position Y(Bot(i).objet)
Bot(i).Z# = object position Z(Bot(i).objet)
move object Bot(i).objet,20000
Bot(i).Xtemp# = object position X(Bot(i).objet)
Bot(i).Ytemp# = object position Y(Bot(i).objet)
Bot(i).Ztemp# = object position Z(Bot(i).objet)
move object Bot(i).objet,-20000
Bot(i).temptir = timer()+rnd(1200)-600

Bot(i).tircollide = SC_rayCast(0,Bot(i).X#,Bot(i).Y#+20,Bot(i).Z#,Bot(i).Xtemp#,Bot(i).Ytemp#,Bot(i).Ztemp#,Bot(i).objet)
if Bot(i).cible = nballies
if Bot(i).tircollide = 1002 and Bot(i).tirpossible = 1
play sound 1103
temp = rnd(100)
Bot(i).tircollide = SC_rayCast(0,Bot(i).X#,Bot(i).Y#,Bot(i).Z#,X#,Y#,Z#,Bot(i).objet)
if temp < Bot(i).Precision and Bot(i).tircollide = 0 : rem le pourcentage du droîde et verification que la balle ne traverse pas un mur
if Bot(i).tipe = 0 then dec vie,(30+rnd(5))
if Bot(i).tipe = 1 then dec vie,(45+rnd(5))
if Vie < 0 then killer_name$ = Bot(i).Name$ : killer_num = i
coef_ralentissement_2# = 5
inc dam_warn,200
if dam_warn > 255 then dam_warn = 255
Bot(i).tirpossible =0
endif
endif
else
if Bot(i).tircollide = allie(Bot(i).cible).objet and Bot(i).tirpossible = 1
play sound 1103
temp = rnd(100)
Bot(i).tircollide = SC_rayCast(0,Bot(i).X#,Bot(i).Y#,Bot(i).Z#,allie(Bot(i).cible).X#,allie(Bot(i).cible).Y#,allie(Bot(i).cible).Z#,Bot(i).objet)
if temp < Bot(i).Precision and Bot(i).tircollide = 0 : rem le pourcentage du droîde et verification que la balle ne traverse pas un mur
if Bot(i).tipe = 0 then dec allie(Bot(i).cible).vie,(30+rnd(5))
if Bot(i).tipe = 1 then dec allie(Bot(i).cible).vie,(45+rnd(5))
Bot(i).tirpossible =0
endif
endif
endif
endif

next i

rem ========================================================================================================================
rem ======================================= Les Alliés =====================================================================
rem *_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_**********_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*_*
rem ¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°
rem ¨_.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-._.-*°¨°*-
rem ========================================================================================================================
rem ========================================================================================================================
for i = 0 to nballies-1

if allie(i).cible > 0
if Bot(allie(i).cible).Vie <= 0
oldcible = allie(i).cible
   repeat
   inc allie(i).cible
   if allie(i).cible = Nbbot then allie(i).cible = 0
   if allie(i).cible = oldcible then allie(i).cible = (allie(i).cible+1)*-1
   until Bot(allie(i).cible).Vie > 0
endif
endif

if allie(i).cible < 0
if (allie(i).cible+1)*-1 > 0 then allie(i).cible = (allie(i).cible+1)*-1
endif

sc_updateobject allie(i).objet


if allie(i).Vie > 0
if allie(t).cible => 0
position object allie(i).objet,allie(i).X#,allie(i).Y#,allie(i).Z#
point object allie(i).objet,object position x(bot(allie(i).cible).objet),object position y(bot(allie(i).cible).objet),object position z(bot(allie(i).cible).objet)
if distance(allie(i).objet,3)> 300
allie(i).oX# = object position X(allie(i).objet)
allie(i).oY# = object position Y(allie(i).objet)
allie(i).oZ# = object position Z(allie(i).objet)

rem le décisionel
if allie(i).DecisionDuree <= 0
allie(i).DecisionDuree = 180+rnd(40)
if distance(allie(i).objet,3) < 400
allie(i).Decision = 4
else
allie(i).Decision = rnd(4)
endif
if distance(allie(i).objet,3) > 2000
allie(i).Decision = 3
else
allie(i).Decision = rnd(6)
endif
endif

rem l'executif
if allie(i).Decision = 0
   dec allie(i).DecisionDuree,Extrapolation*1.2
   loop object allie(i).objet,516,595
endif
if allie(i).Decision = 1
   move object left allie(i).objet,Extrapolation*0.5
   dec allie(i).DecisionDuree,Extrapolation*1.2
   loop object allie(i).objet,3065,3089
endif
if allie(i).Decision = 2
   move object right allie(i).objet,Extrapolation*0.5
   dec allie(i).DecisionDuree,Extrapolation*1.2
   loop object allie(i).objet,3090,3114
endif
if allie(i).Decision = 3
   move object allie(i).objet,Extrapolation*0.5
   dec allie(i).DecisionDuree,Extrapolation*1.2
   loop object allie(i).objet,3021,3045
endif
if allie(i).Decision = 4
   move object allie(i).objet,(Extrapolation*1.2)*-0.5
   dec allie(i).DecisionDuree,Extrapolation*1.2
   loop object allie(i).objet,3046,3064
endif
if allie(i).Decision = 5
   move object allie(i).objet,Extrapolation*0.5
   dec allie(i).DecisionDuree,Extrapolation*1.2
   loop object allie(i).objet,3021,3045
endif
if allie(i).Decision = 6
   move object allie(i).objet,Extrapolation*0.5
   dec allie(i).DecisionDuree,Extrapolation*1.2
   loop object allie(i).objet,3021,3045
endif




allie(i).X# = object position X(allie(i).objet)
allie(i).Y# = object position Y(allie(i).objet)
allie(i).Z# = object position Z(allie(i).objet)
allie(i).Y# = allie(i).Y# -gravite#
allie(i).collide =SC_objectCollision(allie(i).objet,0)
if allie(i).collide
allie(i).X# = SC_getcollisionslideX()
allie(i).Y# = SC_getcollisionslideY()
allie(i).Z# = SC_getcollisionslideZ()
endif
position object allie(i).objet,allie(i).X#,allie(i).Y#,allie(i).Z#
endif
if allie(i).tipe = 1 then position object  allie(i).tete,allie(i).x#,allie(i).y#+180,allie(i).z# : sc_updateobject allie(i).tete
allie(i).Precision  = 130-3*sqrt(distance(allie(i).objet,3))+52+distance(allie(i).objet,3)^(1/3)
endif


if allie(i).temptir+500<timer() and allie(i).Tipe = 0
allie(i).tirpossible = 1
else
allie(i).tirpossible = 0
endif

if allie(i).tirpossible = 1
allie(i).X# = object position X(allie(i).objet)
allie(i).Y# = object position Y(allie(i).objet)
allie(i).Z# = object position Z(allie(i).objet)
move object allie(i).objet,20000
allie(i).Xtemp# = object position X(allie(i).objet)
allie(i).Ytemp# = object position Y(allie(i).objet)
allie(i).Ztemp# = object position Z(allie(i).objet)
move object allie(i).objet,-20000
allie(i).temptir = timer()+rnd(600)-300
allie(i).tircollide = SC_rayCast(0,allie(i).X#,allie(i).Y#+20,allie(i).Z#,allie(i).Xtemp#,allie(i).Ytemp#,allie(i).Ztemp#,allie(i).objet)
if allie(i).tircollide = bot(allie(i).cible).objet and allie(i).tirpossible = 1
play sound 1103
temp = rnd(100)
allie(i).tircollide = SC_rayCast(0,allie(i).X#,allie(i).Y#,allie(i).Z#,X#,Y#,Z#,allie(i).objet)
if temp < allie(i).Precision and allie(i).tircollide = 0 : rem le pourcentage du bonhomme et verification que la balle ne traverse pas un mur
dec Bot(allie(i).cible).Vie,(40+rnd(5))
if Bot(allie(i).cible).Vie < 0 then  allie_meutrieur = t
coef_ralentissement_2# = 5
allie(i).tirpossible =0
endif
endif
endif
endif
next i













return




Rem *** Include File: Admin.dba ***
Rem Created: 03/01/2008 14:17:05

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
admin:
if sound exist(3) = 1
if sound playing(3) = 0 then delete sound 3
endif
rem ========================================================================================================================
rem *=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=
rem _.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=
rem ========================================================================================================================
rem le respawn des droides
for i = 0 to nbBot-1
if Bot(i).Vie <= 0
if Bot(i).Vie = -100000000
else
if allie_meutrieur = 0
New_txt(1,"Vous avez cassé " + Bot(i).Name$,26,0,0,255,screen width()/2,screen height()/2-50,256,256)
if Fragdaffile = 4 and Fragdaffile_temoin = 1 then Fragdaffile_temoin = 0 : New_txt(3,"Folie Meurtrière",26,0,0,255,screen width()/2,screen height()/2-150,256,256)
if Fragdaffile = 9 and Fragdaffile_temoin = 1 then Fragdaffile_temoin = 0 : New_txt(3,"Domination !",26,120,120,255,screen width()/2,screen height()/2-150,256,256)
if Fragdaffile = 14 and Fragdaffile_temoin = 1 then Fragdaffile_temoin = 0 : New_txt(3,"== Comme un Dieu ==",26,255,255,255,screen width()/2,screen height()/2-150,256,256)
rand = rnd(10)
select rand
case 0
game_console_txtametr$ = Configjoueur$+" a cassé " + Bot(i).Name$
endcase
case 1
game_console_txtametr$ = Configjoueur$+" a étalé " + Bot(i).Name$
endcase
case 2
game_console_txtametr$ = Configjoueur$+" a fait un trou dans " + Bot(i).Name$
endcase
case 3
game_console_txtametr$ = Bot(i).Name$ + " est en pieces détachés a cause de "+Configjoueur$
endcase
case 4
game_console_txtametr$ = Configjoueur$+" est devenu plieur de tôles"
endcase
case 5
game_console_txtametr$ = Bot(i).Name$ + " n'existe plus"
endcase
case 6
game_console_txtametr$ = Configjoueur$+" a perforé " + Bot(i).Name$
endcase
case 7
game_console_txtametr$ = Bot(i).Name$ + " a été court-circuité"
endcase
case 8
game_console_txtametr$ = Bot(i).Name$ + " a désormais de quoi jongler"
endcase
case 9
game_console_txtametr$ = Configjoueur$+" a fragué"
endcase
case 10
game_console_txtametr$ = Configjoueur$+" est intervenu"
endcase
endselect
inc Frag
inc Fragdaffile
Fragdaffile_temoin = 1
else
rand = rnd(10)
select rand
case 0
game_console_txtametr$ = allie(i).Name$+" a cassé " + Bot(i).Name$
endcase
case 1
game_console_txtametr$ = allie(i).Name$+" a étalé " + Bot(i).Name$
endcase
case 2
game_console_txtametr$ = allie(i).Name$+" a fait un trou dans " + Bot(i).Name$
endcase
case 3
game_console_txtametr$ = Bot(i).Name$ + " est en pieces détachés a cause de "+allie(i).Name$
endcase
case 4
game_console_txtametr$ = allie(i).Name$+" est devenu plieur de tôles"
endcase
case 5
game_console_txtametr$ = Bot(i).Name$ + " n'existe plus"
endcase
case 6
game_console_txtametr$ = allie(i).Name$+" a perforé " + Bot(i).Name$
endcase
case 7
game_console_txtametr$ = Bot(i).Name$ + " a été court-circuité"
endcase
case 8
game_console_txtametr$ = Bot(i).Name$ + " a désormais de quoi jongler"
endcase
case 9
game_console_txtametr$ = allie(i).Name$+" a fragué"
endcase
case 10
game_console_txtametr$ = allie(i).Name$+" est intervenu"
endcase
endselect
inc allie(i).frag
endif
inc Bot(i).mort
Player_stats(0) = Player_stats(0) + (200+ nbsentinelles*1000)
if Bot(i).tipe = 0
position object 1001,Bot(i).X#,Bot(i).Y#-tailleperso#,Bot(i).Z#
endif
if Bot(i).tipe = 1
position object 1001,Bot(i).X#,Bot(i).Y#-tailleperso#-60,Bot(i).Z#
endif
point object 1001,X#,Bot(i).Y#-tailleperso#+ nbwarmachines*60,Z#
rotate object 1001,object angle X(1001),object angle Y(1001)+180,object angle Z(1001)
exclude object off 1001
play object 1001
exclude object on Bot(i).objet
position object Bot(i).objet,9999999,99999999,99999999
sc_updateobject Bot(i).objet
Bot(i).Vie = -100000000
Bot(i).Rspn = 100
if sound exist(3) = 1
 delete sound 3
endif
set dir CheminMA$+"\Sounds\Voix\Humain\"
load sound game_frag_human_sound$(rnd(game_frag_human_sound_nb-1)+1),3
play sound 3

endif
endif
rem =============================
rem =============================
if Bot(i).Rspn >= 1 and Bot(i).Vie = -100000000
dec Bot(i).Rspn
if Bot(i).Rspn = 1
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
if file exist ("respawnH.ini") = 1 and file exist ("respawnD.ini") = 1
Game_resppawn_point = rnd(game_repawn_point_droide_nb-1)+1
Bot(i).x# = game_repawn(2,Game_resppawn_point,1)
Bot(i).z# = game_repawn(2,Game_resppawn_point,3)
Bot(i).y# = game_repawn(2,Game_resppawn_point,2)
endif
position object Bot(i).objet,Bot(i).X#,Bot(i).Y#,Bot(i).Z#
if Bot(i).tipe = 1 then position object Bot(i).tete,Bot(i).x#,Bot(i).y#+180,Bot(i).z# : sc_updateobject Bot(i).tete
exclude object off Bot(i).objet
if Bot(i).tipe = 0 then Bot(i).Vie = 40
if Bot(i).tipe = 1 then Bot(i).Vie = 100
endif
endif

next i
allie_meutrieur = 0
rem ========================================================================================================================
rem *=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=
rem _.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=*=-._.-=
rem ========================================================================================================================




if Vie <= 0
rand = rnd(10)
New_txt(1,"Vous avez été tué par " + killer_name$,26,255,0,0,screen width()/2,screen height()/2-50,256,256)
select rand
case 0
game_console_txtametr$ = killer_name$ + " est devenu efficace, il a tué "+Configjoueur$
endcase
case 1
game_console_txtametr$ = killer_name$ + " a démontré sa perfection"
endcase
case 2
game_console_txtametr$ = Configjoueur$+" a été saigné"
endcase
case 3
game_console_txtametr$ = Configjoueur$+" a été assaciné"
endcase
case 4
game_console_txtametr$ = "On dirait que " + killer_name$ + " a été débugué"
endcase
case 5
game_console_txtametr$ = killer_name$ + " a recu un patch"
endcase
case 6
game_console_txtametr$ = "Un point de plus pour " + killer_name$
endcase
case 7
game_console_txtametr$ = "Le fusil de " + killer_name$ + " fonctionne"
endcase
case 8
game_console_txtametr$ = Configjoueur$+" s'est fait mathématiquement éradiquer"
endcase
case 9
game_console_txtametr$ = Configjoueur$+" ne se réveillera plus"
endcase
case 10
game_console_txtametr$ = Configjoueur$ +" n'avais pas vus " + killer_name$
endcase
endselect

if sound exist(3) = 1 then delete sound 3
set dir CheminMA$+"\Sounds\Voix\Droides\"
load sound game_frag_Droide_sound$(rnd(game_frag_Droide_sound_nb-1)+1),3
play sound 3
inc mort
inc Bot(killer_num).frag
Player_stats(0) = Player_stats(0) +(200+ Bot(killer_num).tipe*1000)
gosub Etat_Mort
coef_ralentissement_2# = 1.0
Vie = 100
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
if file exist ("respawnH.ini") = 1 and file exist ("respawnD.ini") = 1
Game_resppawn_point = rnd(game_repawn_point_human_nb-1)+1
x# = game_repawn(1,Game_resppawn_point,1)
z# = game_repawn(1,Game_resppawn_point,3)
y# = game_repawn(1,Game_resppawn_point,2)
endif
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 100.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif

RHL_PTS = 0
for t= 0 to Nballies-1
inc RHL_PTS,Allie(t).frag
next t
inc RHL_PTS,frag
CID_PTS = 0
for t= 0 to NbBot-1
inc CID_PTS,Bot(t).frag
next t
if RHL_PTS > Fraglimit-1 or CID_PTS > Fraglimit-1 then goto Scores
return



Rem *** Include File: UI.dba ***
Rem Created: 26/05/2008 18:21:44

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
Game_UI:
if armure_type > 3 then paste image 23,0,0,1
rem l'affichage du lazer si besoin il y a
if Game_lazer_visible = 1
   if AK_74_Lazer>0
   sprite 20,param(35)/2-13,param(36)/2-13,AK_74_Lazer
   endif
   if Famas_Lazer>0
   sprite 20,param(35)/2-13,param(36)/2-13,Famas_Lazer
   endif
else
   if Famas_Lazer>0
   sprite 20,100000,1000000,Famas_Lazer
   endif
   if AK_74_Lazer>0
   sprite 20,100000,1000000,AK_74_Lazer
   endif
endif

rem la console\le chat
gosub console

rem le petit indicateur de score
if armure_type > 2
set cursor param(35)/2-30,15
print CID_PTS
set cursor param(35)/2+25,15
print RHL_PTS
endif

rem pareil au HUD du zoom
if sprite visible(14) and game_arme_coress(arme) = 1070
set cursor 55,32
print vie
endif

rem affiche le nom du persomage pointé
if armure_type > 1
dxScreen = object screen X(5000)
dyScreen = object screen Y(5000)
DistanceBotselectauret = distance2D(param(35)/2,param(36)/2,dxScreen,dyScreen)
if DistanceBotselectauret < 100 then center text param(35)/2,param(36)/2+20,nombot$
endif

rem l'indicateur de munition
set cursor 327,param(36)-35
print listarme(game_arme_coress(arme)-1000).bulets_encour
set cursor 374,param(36)-40
print listarme(game_arme_coress(arme)-1000).bulets_Stock

rem l'anim de l'EC
if Vie <> OLDvie
delete animation 1
if vie > 100
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 100++.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie = 100
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 100.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie < 100 and vie => 90
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 100.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie < 90 and vie => 80
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 90.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie < 80 and vie => 70
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 80.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie < 70 and vie => 60
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 70.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie < 60 and vie => 50
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 60.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie < 50 and vie => 40
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 50.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie < 40 and vie => 30
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 40.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie < 30 and vie => 20
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 30.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie < 20 and vie => 10
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 20.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie < 10 and vie > 0
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 10.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
if vie = 0
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 0.avi",1
place animation 1,20,param(36)-95,170,param(36)-20
loop animation 1
endif
endif

rem réticule
sprite 15,param(35)/2,param(36)/2,game_arme_coress(arme)

return

Rem *** Include File: Solo_Domination_Persos.dba ***
Rem Created: 05/04/2008 20:02:11

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro


IAdomination:
i = 0
print
rem def des pts a prendre
for t = 1 to game_dompts
temp = Solo_dompts(t,4)
select temp
case 0
inc i
Solo_dompts_Dcibles(i) = t+1200
Solo_iadom_nbcibles = i
endcase
case 2
inc i
Solo_dompts_Dcibles(i) = t+1200
Solo_iadom_nbcibles = i
endcase
endselect
print object position x(i), "    ",object position y(i),"    ",object position z(i)
print
next t
if Solo_iadom_cible_ateinte = 1
Solo_iadom_cible = rnd(Solo_iadom_nbcibles-1)+1201
endif
Solo_iadom_cible_ateinte = 0
if distance(5000,Solo_iadom_cible)<80
color object Solo_iadom_cible,RGB(0,0,255)
Solo_dompts(Solo_iadom_cible-1200,4) = 1
Solo_iadom_cible_ateinte = 1
endif




if VieD > 0




position object 5000,dX#,dY#,dZ#
point object 5000,object position x(Solo_iadom_cible),object position y(Solo_iadom_cible),object position z(Solo_iadom_cible)
if distance(5000,3)> 300
oX# = object position X(5000)
oY# = object position Y(5000)
oZ# = object position Z(5000)
move object 5000,((FPS*-1)+400)/20
dX# = object position X(5000)
dY# = object position Y(5000)
dZ# = object position Z(5000)
dec dY#,nbwarmachines*5
botcollide = SC_SphereCast(1,ox#,oy#,oz#,dX#,dY#,dZ#,20+ nbsentinelles*50,0)
if botcollide
dX# = SC_getcollisionslideX()
dY# = SC_getcollisionslideY()
dZ# = SC_getcollisionslideZ()
endif
position object 5000,dX#,dY#,dZ#
if nbsentinelles = 1 then position object 5001,dx#,dy#+180,dz#
endif


if dtime+1000 + nbwarmachines*1000<timer()
IA_tir_possible = 1
else
IA_tir_possible =0
endif

if IA_tir_possible = 1
point object 5000,object position x(3),object position y(3)+tailleperso#,object position z(3)
dX# = object position X(5000)
dY# = object position Y(5000)
dZ# = object position Z(5000)
move object 5000,20000
dXtemp# = object position X(5000)
dYtemp# = object position Y(5000)
dZtemp# = object position Z(5000)
move object 5000,-20000
point object 5000,object position x(Solo_iadom_cible),object position y(Solo_iadom_cible),object position z(Solo_iadom_cible)
IAcollide = SC_rayCast(0,dX#,dY#,dZ#,dXtemp#,dYtemp#,dZtemp#,0)
if IAcollide = 1002 and IA_tir_possible = 1
temp = rnd(100)
IAtircollide = SC_rayCast(0,dX#,dY#,dZ#,X#,Y#,Z#,0)
play sound 1103
if temp < 65 - nbwarmachines*20 and IAtircollide = 0 : rem le pourcentage du droîde
dec vie,rnd(40)
dam_warn = 200
IA_tir_possible =0
dtime  = timer()
endif
endif
endif

endif


return

Rem *** Include File: DomAdmin.dba ***
Rem Created: 03/01/2008 14:17:05

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
domadmin:

rem les pts
for t= 0 to game_dompts
if sc_spherecast(t+1200,oldx3#,oldy3#,oldz3#,x4#,y4#,z4#,radius#,0)
color object t+1200,RGB(255,0,0)
Solo_dompts(t,4) = 2 : rem 1 pour les droides
endif
rem pour le droide, voir le fichier IA

if Solo_dompts(t,4) = 2
inc rhlpts_temp#,0.05
RHL_PTS = int(rhlpts_temp#)
endif

if Solo_dompts(t,4) = 1
inc cidpts_temp#,0.05
CID_PTS = int(cidpts_temp#)
endif

next t

rem la Domination


rem ===========================================================FRAG==========================================================

if VieD <= 0
rand = rnd(10)
select rand
case 0
game_console_txtametr$ = Configjoueur$+" a cassé " + nombot$
endcase
case 1
game_console_txtametr$ = Configjoueur$+" a étalé " + nombot$
endcase
case 2
game_console_txtametr$ = Configjoueur$+" a fait un trou dans " + nombot$
endcase
case 3
game_console_txtametr$ = nombot$ + " est en pieces détachés a cause de "+Configjoueur$
endcase
case 4
game_console_txtametr$ = Configjoueur$+" est devenu plieur de tôles"
endcase
case 5
game_console_txtametr$ = nombot$ + " n'existe plus"
endcase
case 6
game_console_txtametr$ = Configjoueur$+" a perforé " + nombot$
endcase
case 7
game_console_txtametr$ = nombot$ + " a été court-circuité"
endcase
case 8
game_console_txtametr$ = nombot$ + " a désormais de quoi jongler"
endcase
case 9
game_console_txtametr$ = Configjoueur$+" a fragué"
endcase
case 10
game_console_txtametr$ = Configjoueur$+" est intervenu"
endcase
endselect
position object 1001,dX#,dY#-tailleperso#+ nbwarmachines*60,dZ#
point object 1001,X#,dY#-tailleperso#+ nbwarmachines*60,Z#
rotate object 1001,object angle X(1001),object angle Y(1001)+180,object angle Z(1001)
exclude object off 1001
play object 1001
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
if file exist ("respawnH.ini") = 1 and file exist ("respawnD.ini") = 1
Game_resppawn_point = rnd(game_repawn_point_droide_nb-1)+1
dx# = game_repawn(2,Game_resppawn_point,1)
dz# = game_repawn(2,Game_resppawn_point,3)
dy# = game_repawn(2,Game_resppawn_point,2)
endif
Player_stats(0) = Player_stats(0) +(200+ nbsentinelles*500)
position object 5000,dX#,dY#,dZ#
if nbsentinelles = 1 then position object 5001,dx#,dy#+180,dz# : sc_updateobject 5001

VieD = 100 - nbwarmachines*60

if sound exist(3) = 1
 delete sound 3
endif
set dir CheminMA$+"\Sounds\Voix\Humain\"
load sound game_frag_human_sound$(rnd(game_frag_human_sound_nb-1)+1),3
play sound 3
endif

rem =======================================================Mort===============================================================

if Vie <= 0
rand = rnd(10)
select rand
case 0
game_console_txtametr$ = nombot$ + " est devenu efficace, il a tué "+Configjoueur$
endcase
case 1
game_console_txtametr$ = nombot$ + " a démontré sa perfection"
endcase
case 2
game_console_txtametr$ = Configjoueur$+" a été saigné"
endcase
case 3
game_console_txtametr$ = Configjoueur$+" a été assaciné"
endcase
case 4
game_console_txtametr$ = "On dirait que " + nombot$ + " a été débugué"
endcase
case 5
game_console_txtametr$ = nombot$ + " a recu un patch"
endcase
case 6
game_console_txtametr$ = "Un point de plus pour " + nombot$
endcase
case 7
game_console_txtametr$ = "Le fusil de " + nombot$ + " fonctionne"
endcase
case 8
game_console_txtametr$ = Configjoueur$+" s'est fait mathématiquement éradiquer"
endcase
case 9
game_console_txtametr$ = Configjoueur$+" ne se réveillera plus"
endcase
case 10
game_console_txtametr$ = Configjoueur$ +" n'avais pas vus " + nombot$
endcase
endselect

if sound exist(3) = 1
 delete sound 3
endif
set dir CheminMA$+"\Sounds\Voix\Droides\"
load sound game_frag_Droide_sound$(rnd(game_frag_Droide_sound_nb-1)+1),3
play sound 3

gosub Etat_Mort
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
if file exist ("respawnH.ini") = 1 and file exist ("respawnD.ini") = 1
Game_resppawn_point = rnd(game_repawn_point_human_nb-1)+1
x# = game_repawn(1,Game_resppawn_point,1)
z# = game_repawn(1,Game_resppawn_point,3)
y# = game_repawn(1,Game_resppawn_point,2)
endif
Player_stats(0) = Player_stats(0) -(200+ nbsentinelles*500)
Vie = 100
set dir CheminMA$+"\Jpegs\Jeu\EC"
load animation "EC 100.avi",1
place animation 1,0,param(36)-128,256,param(36)
loop animation 1
endif


rem =================================================Scores==================================================================

if CIDpts > Scorelimit-1 or RHlpts > Scorelimit-1
gosub scores
endif

return


Rem *** Include File: Game_Exploration.dba ***
Rem Created: 09/12/2007 12:55:40

Rem Included in Project: D:\DBP\Projects\Metal Assault\Metal Assault.dbpro


Exploration:
rem la musique
set dir CheminMA$+"\Musiques\"
if music exist(1) = 1
stop music 1
delete music 1
endif
load music "Exploration.mp3",1
set music volume 1,30
loop music 1

do
sync
NewExtrapolationTimer=timer()
Extrapolation=(NewExtrapolationTimer-OldExtrapolationTimer)/2
OldExtrapolationTimer=NewExtrapolationTimer
dec Game_Effect_fondu_alpha,Extrapolation/4
if Game_Effect_fondu_alpha < 0 then Game_Effect_fondu_alpha = 0 : hide sprite 4
if Game_Effect_fondu_alpha > 0 then set sprite alpha 4,Game_Effect_fondu_alpha
x# = camera position X()
Y# = camera position Y()
Z# = camera position Z()
if water > 0
UpDate_old_eau(1)
endif
position mouse 0,0
set cursor 0,0
FPS = screen fps()
print "Fps :",fps
set cursor param(35)-200,0
ink RGB(0,0,255),0
print "X : ",x#
set cursor param(35)-200,30
ink RGB(0,255,0),0
print "Y : ",y#
set cursor param(35)-200,60
ink RGB(255,0,0),0
print "Z : ",z#
ink rgb(255,255,255),0
if Game_comptearebour = 0
center text param(35)/2,param(36)/2,game_carte$
center text param(35)/2,param(36)/2+32,"Apuyez sur tir pour commencer"
endif
vitesse_joueur# = ((FPS*-1)+400)/20
oldcamy#=camy#
oldcamx#=camx#
camy#=camy#+mousemoveY()*0.2
camx#=camx#+mousemoveX()*0.2
if camy#>70 then camy#=70
if camy#<-100 then camy# = -100
yrotate camera curveangle(camx#,oldcamx#,25)
xrotate camera curveangle(camy#,oldcamy#,25)
if upkey()=1 or KEYSTATE(param(48)) = 1 then move camera vitesse_joueur#
if downkey()=1 or KEYSTATE(param(49)) = 1 then move camera -vitesse_joueur#
if mouseclick() = 1 and Game_comptearebour = 0
Game_comptearebour = 1 : comptearebour = 100
endif
if Game_comptearebour = 1
set cursor param(35)/2,param(36)/2
print comptearebour
set cursor 0,0
comptearebour = comptearebour - ((FPS*-1)+400)/200
endif
if comptearebour < 0 then goto Game_trans
vitesse_joueur# = Extrapolation*Coeff_Vitesse_Joueur#*1.2
loop


Rem *** Include File: Solo_matchamort.dba ***
Rem Created: 16/01/2008 07:41:04

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
rem le match a mort
matchamort:
Fraglimit = 10
set dir CheminMA$+"\jpegs\menu"
hide sprite 1
hide sprite 2
load image "Solo_select.jpg",4,1
sprite 4,-257,0,4
load image "Solo_preview.jpg",5,1
sprite 5,param(35)-512,-257,5
load image "Solo_Brefing.jpg",6,1
sprite 6,param(35),param(36)-512,6
load image "Solo_Descrition.jpg",7,1
sprite 7,param(35)/2,param(36),7
Solo_arrive = 0

for Partie_solo = 6 to 246 step 10
rem on bouge la camera
NewExtrapolationTimer=timer()
Extrapolation=(NewExtrapolationTimer-OldExtrapolationTimer)/2
OldExtrapolationTimer=NewExtrapolationTimer
inc temporel,Extrapolation*3
inc temporel2#
gosub menu_cammov

wait 0
inc Solo_arrive,10
sprite 4,-257+Solo_arrive,0,4
sprite 5,param(35)-512,-257+Solo_arrive,5
sprite 6,param(35)-Solo_arrive,param(36)-512,6
sprite 7,param(35)/2,param(36)-Solo_arrive,7
next Partie_solo

set dir CheminMA$+"\Cartes\Match_Mort"
open to read 1,"index.ini"
read float 1,Solo_nbCartes#
Solo_nbCartes = int(Solo_nbCartes#)
if Solo_nbCartes = 0 then exit prompt "Il n'y a aucune carte dans le jeu !","Metal assault Erreur" : end
for Carteliste_solo = 0 to Solo_nbCartes
read string 1,Solo_CarteNom$(Carteliste_solo)
next Carteliste_solo
close file 1

rem config default
nbsentinelles = 1
nbwarmachines = 0


do
rem on bouge la camera
NewExtrapolationTimer=timer()
Extrapolation=(NewExtrapolationTimer-OldExtrapolationTimer)/2
OldExtrapolationTimer=NewExtrapolationTimer
inc temporel,Extrapolation*3
inc temporel2#
gosub menu_cammov

rem affichage des noms des cartes
         set text size 16
         set text to bolD
         create bitmap 1,256,256
         if Solo_nbCartes > 0
         print Solo_CarteNom$(0)
         get image 10,0,0,200,20
         sprite 10,0,95,10
         cls
         endif
         delete bitmap 1
         create bitmap 1,256,256
         if Solo_nbCartes > 1
         print Solo_CarteNom$(1)
         get image 11,0,0,200,20
         sprite 11,0,145,11
         cls
         endif
         delete bitmap 1
         create bitmap 1,256,256
         if Solo_nbCartes > 2
         print Solo_CarteNom$(2)
         get image 12,0,0,200,20
         sprite 12,0,185,12
         cls
         endif
         delete bitmap 1
         create bitmap 1,256,256
         if Solo_nbCartes > 3
         print Solo_CarteNom$(3)
         get image 13,0,0,200,20
         sprite 13,0,225,13
         cls
         endif
         delete bitmap 1
         create bitmap 1,256,256
         if Solo_nbCartes > 4
         print Solo_CarteNom$(4)
         get image 15,0,0,200,20
         sprite 15,0,275,15
         cls
         create bitmap 1,256,256
         if Solo_nbCartes > 5
         print Solo_CarteNom$(5)
         get image 16,0,0,200,20
         sprite 16,0,324,16
         cls
         endif
         create bitmap 1,256,256
         if Solo_nbCartes > 6
         print Solo_CarteNom$(6)
         get image 17,0,0,200,20
         sprite 17,0,370,17
         cls
         endif
         create bitmap 1,256,256
         if Solo_nbCartes > 7
         print Solo_CarteNom$(7)
         get image 18,0,0,200,20
         sprite 18,0,410,18
         cls
         endif
         endif
         delete bitmap 1
         create bitmap 1,256,256
         print Fraglimit
         get image 14,0,0,30,30
         sprite 14,990,485,14
         cls
         delete bitmap 1
         create bitmap 1,256,256
         print nbwarmachines
         get image 19,0,0,30,30
         sprite 19,995,271,19
         cls
         delete bitmap 1
         create bitmap 1,256,256
         print nbsentinelles
         get image 20,0,0,30,30
         sprite 20,995,335,20
         cls
         delete bitmap 1
         create bitmap 1,256,256
         print nballies
         get image 21,0,0,30,30
         sprite 21,995,435,21
         cls
         delete bitmap 1
if boutton2(987,473,1012,487)=1 then inc Fraglimit
if boutton2(987,508,1012,521)=1 then dec Fraglimit
if boutton2(987,258,1012,272)=1 then inc nbwarmachines
if boutton2(987,293,1012,306)=1 and nbwarmachines > 0 then dec nbwarmachines
if boutton2(987,318,1012,332)=1 then inc nbsentinelles
if boutton2(987,353,1012,366)=1 and nbsentinelles > 0 then dec nbsentinelles
if boutton2(987,424,1012,437)=1 then inc nballies
if boutton2(987,459,1012,471)=1 and nballies > 0 then dec nballies
NbBot = nbwarmachines + nbsentinelles
if mouseX() < 215
      rem le boutton de menu principal
      if mouseY() > 10 and mousey() < 45
      if mouseclick()=1
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      if sprite exist (21) then delete sprite 21
      for Partie_solo = 6 to 246 step 10
      wait 0
      dec Solo_arrive,10
      sprite 4,-257+Solo_arrive,0,4
      sprite 5,param(35)-512,-257+Solo_arrive,5
      sprite 6,param(35)-Solo_arrive,param(36)-512,6
      sprite 7,param(35)/2,param(36)-Solo_arrive,7
      next Partie_solo
      show sprite 1
      show sprite 2
      delete image 4
      delete sprite 4
      delete image 5
      delete sprite 5
      delete image 6
      delete sprite 6
      delete image 7
      delete sprite 7

      goto menu_base
      endif
      endif

      rem les autres
mosXMax = 135 : MosXmin = 100 : index = 0 : gosub elem_matchmort
mosXMax = 265 : MosXmin = 217 : index = 3 : gosub elem_matchmort
if mouseY() > 135 and mousey() < 175
      if Solo_nbCartes > 1
      Solo_carte_en_revue = 2
      Nomcarte$ = Solo_CarteNom$(1)
      set dir CheminMA$+"\Cartes\Match_Mort\"+Nomcarte$
      load image "preview.jpg",8,1
      sprite 8,param(35)-480,0,8
      set sprite 8,1,1
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Match_mort"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
         if sprite exist (10) then delete sprite 10
         if sprite exist (11) then delete sprite 11
         if sprite exist (12) then delete sprite 12
         if sprite exist (13) then delete sprite 13
         if sprite exist (14) then delete sprite 14
         if sprite exist (15) then delete sprite 15
         if sprite exist (16) then delete sprite 16
         if sprite exist (17) then delete sprite 17
         if sprite exist (18) then delete sprite 18
         if sprite exist (19) then delete sprite 19
         if sprite exist (20) then delete sprite 20
         if sprite exist (21) then delete sprite 21
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 2
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif

      if mouseY() > 175 and mousey() < 217
      if Solo_nbCartes > 2
      Solo_carte_en_revue = 3
      Nomcarte$ = Solo_CarteNom$(2)
      set dir CheminMA$+"\Cartes\Match_Mort\"+Nomcarte$
      load image "preview.jpg",8,1
      sprite 8,param(35)-480,0,8
      set sprite 8,1,1
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Match_mort"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      if sprite exist (21) then delete sprite 21
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 3
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif

      if mouseY() > 265 and mousey() < 314
      if Solo_nbCartes > 4
      Solo_carte_en_revue = 5
      Nomcarte$ = Solo_CarteNom$(4)
      set dir CheminMA$+"\Cartes\Match_Mort\"+Nomcarte$
      load image "preview.jpg",8,1
      set sprite 8,1,1
      sprite 8,param(35)-480,0,8
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Match_mort"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      if sprite exist (21) then delete sprite 21
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 4
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif



      if mouseY() > 314 and mousey() < 360
      if Solo_nbCartes > 5
      Solo_carte_en_revue = 6
      Nomcarte$ = Solo_CarteNom$(5)
      set dir CheminMA$+"\Cartes\Match_Mort\"+Nomcarte$
      load image "preview.jpg",8,1
      set sprite 8,1,1
      sprite 8,param(35)-480,0,8
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Match_mort"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      if sprite exist (21) then delete sprite 21
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 5
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif

      if mouseY() > 360 and mousey() < 400
      if Solo_nbCartes > 6
      Solo_carte_en_revue = 7
      Nomcarte$ = Solo_CarteNom$(6)
      set dir CheminMA$+"\Cartes\Match_Mort\"+Nomcarte$
      load image "preview.jpg",8,1
      set sprite 8,1,1
      sprite 8,param(35)-480,0,8
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Match_mort"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      if sprite exist (21) then delete sprite 21
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 6
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif

      if mouseY() > 400 and mousey() < 445
      if Solo_nbCartes > 7
      Solo_carte_en_revue = 8
      Nomcarte$ = Solo_CarteNom$(7)
      set dir CheminMA$+"\Cartes\Match_Mort\"+Nomcarte$
      load image "preview.jpg",8,1
      sprite 8,param(35)-480,0,8
      set sprite 8,1,1
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Match_mort"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      if sprite exist (21) then delete sprite 21
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 7
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif
else
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
endif

loop

elem_matchmort:

      if mouseY() > mosXmin and mousey() < mosXmax

         if Solo_nbCartes > index
         Solo_carte_en_revue = index+1
         Nomcarte$ = Solo_CarteNom$(index)
         set dir CheminMA$+"\Cartes\Match_Mort\"+Nomcarte$
         load image "preview.jpg",8,1
         sprite 8,param(35)-480,0,8
         set sprite 8,1,1
         open to read 1,"descr.txt"
         set text font "arial",1
         set text size 14
         create bitmap 1,256,256
         for Solo_description_ligncount = 0 to 20
         read string 1,Solo_Description_ligne1$
         print Solo_Description_ligne1$
         next Solo_description_ligncount
         get image 9,0,0,256,256
         cls
         delete bitmap 1
         close file 1
         sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
         endif

         if mouseclick() = 1
         game_carte$=Nomcarte$
         type_game$="Match_mort"
         if sprite exist (8) then delete sprite 8
         if sprite exist (9) then delete sprite 9
         if sprite exist (10) then delete sprite 10
         if sprite exist (11) then delete sprite 11
         if sprite exist (12) then delete sprite 12
         if sprite exist (13) then delete sprite 13
         if sprite exist (14) then delete sprite 14
         if sprite exist (15) then delete sprite 15
         if sprite exist (16) then delete sprite 16
         if sprite exist (17) then delete sprite 17
         if sprite exist (18) then delete sprite 18
         if sprite exist (19) then delete sprite 19
         if sprite exist (20) then delete sprite 20
         if sprite exist (21) then delete sprite 21
         goto load_game
         endif

      else
         if Solo_carte_en_revue = index
         Solo_carte_en_revue = 0
         if sprite exist (8) then delete sprite 8
         if sprite exist (9) then delete sprite 9
         endif
      endif
return

Rem *** Include File: Game_Vehicules.dba ***
Rem Created: 23/08/2008 22:05:28

Rem Included in Project: D:\Metal Assault\Metal Assault.dbpro
game_Vehicules:



if gameplay_Type = 3

for t = 0 to nb_vautour-1
      Vautours(t).oldx# = object position x(t+1701)
      Vautours(t).oldy# = object position y(t+1701)
      Vautours(t).oldz# = object position z(t+1701)
next t

for t = 0 to nb_Escompide-1
      Escompides(t).oldx# = object position x(t+1801)
      Escompides(t).oldy# = object position y(t+1801)
      Escompides(t).oldz# = object position z(t+1801)
next t

for t = 0 to nb_v2ci-1
      v2cis(t).oldx# = object position x(t+1901)
      v2cis(t).oldy# = object position y(t+1901)
      v2cis(t).oldz# = object position z(t+1901)
next t

for t = 0 to nb_motoD-1
      motoDs(t).oldx# = object position x(t+2101)
      motoDs(t).oldy# = object position y(t+2101)
      motoDs(t).oldz# = object position z(t+2101)
next t

for t = 0 to nb_coleoptere-1
      coleopteres(t).oldx# = object position x(t+2201)
      coleopteres(t).oldy# = object position y(t+2201)
      coleopteres(t).oldz# = object position z(t+2201)
next t

rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
rem =============================================Vautour=====================================================================
rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.

if Vehicule_type = 0
print
print "X: ",object position x(Vautour_number+1701)," Y: ",object position y(Vautour_number+1701)," Z: ",object position z(Vautour_number+1701)
print "Xspeed : ", Vautours(Vautour_number).xspeed#
print "Yspeed : ", Vautours(Vautour_number).yspeed#

inc Vautours(Vautour_number).anglX#,mousemoveX()/5
inc Vautours(Vautour_number).anglY#,mousemoveY()/5
rotate object Vautour_number+1701,Vautours(Vautour_number).anglY#,Vautours(Vautour_number).anglX#,0
if KEYSTATE(param(48)) then inc Vautours(Vautour_number).xspeed#,0.1
if KEYSTATE(param(49)) then dec Vautours(Vautour_number).xspeed#,0.1
if Vautours(Vautour_number).xspeed# > 2 then Vautours(Vautour_number).xspeed# = 2
if Vautours(Vautour_number).xspeed# < -1.5 then Vautours(Vautour_number).xspeed# = -1.5
if KEYSTATE(param(48))=0 and KEYSTATE(param(49))=0
if Vautours(Vautour_number).xspeed# > 0 then dec Vautours(Vautour_number).xspeed#,0.1
if Vautours(Vautour_number).xspeed# < 0 then inc Vautours(Vautour_number).xspeed#,0.1
if Vautours(Vautour_number).xspeed# > 0 then dec Vautours(Vautour_number).xspeed#,0.1
if Vautours(Vautour_number).xspeed# < 0 then inc Vautours(Vautour_number).xspeed#,0.1
if Vautours(Vautour_number).xspeed# < 0.1 and Vautours(Vautour_number).xspeed# > -0.1 then Vautours(Vautour_number).xspeed# = 0
endif
move object Vautour_number+1701,Vautours(Vautour_number).xspeed#*Extrapolation*1.5
if KEYSTATE(param(51)) then inc Vautours(Vautour_number).yspeed#,0.1
if KEYSTATE(param(50)) then dec Vautours(Vautour_number).yspeed#,0.1
if Vautours(Vautour_number).yspeed# > 1.5 then Vautours(Vautour_number).yspeed# = 1.5
if Vautours(Vautour_number).yspeed# < -1.5 then Vautours(Vautour_number).yspeed# = -1.5
if KEYSTATE(param(51))=0 and KEYSTATE(param(50))=0
if Vautours(Vautour_number).yspeed# > 0 then dec Vautours(Vautour_number).yspeed#,0.1
if Vautours(Vautour_number).yspeed# < 0 then inc Vautours(Vautour_number).yspeed#,0.1
if Vautours(Vautour_number).yspeed# > 0 then dec Vautours(Vautour_number).yspeed#,0.1
if Vautours(Vautour_number).yspeed# < 0 then inc Vautours(Vautour_number).yspeed#,0.1
if Vautours(Vautour_number).yspeed# < 0.1 and Vautours(Vautour_number).yspeed# > -0.1 then Vautours(Vautour_number).yspeed# = 0
endif
move object left Vautour_number+1701,Vautours(Vautour_number).yspeed#*Extrapolation*1.5
position object Vautour_number+1701,object position x(Vautour_number+1701),object position y(Vautour_number+1701)-gravite#/(5/3),object position z(Vautour_number+1701)


if KEYSTATE(16)
do
if KEYSTATE(16)=0 then exit
loop
temp = Vautours(Vautour_number).porte
select temp
case 0:play object Vautour_number+1701,0,50:Vautours(Vautour_number).porte=1:endcase
case 1:play object Vautour_number+1701,50,100:Vautours(Vautour_number).porte=0:endcase
endselect
endif


if keystate(18)
do
if keystate(18) =  0 then exit
loop
exclude object off game_arme_coress(arme)
show sprite 15
gameplay_Type = 1
Vautours(Vautour_number).pilote_occupe = 0
X# = Vautours(t).x#
Y# = Vautours(t).y#+400
Z# = Vautours(t).z#
endif

endif

rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
rem ======================================================Escompide=====================================================================
rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.

if Vehicule_type = 1
print
print "X: ",object position x(escompide_number+1801)," Y: ",object position y(escompide_number+1801)," Z: ",object position z(escompide_number+1801)
print "Xspeed : ", escompides(escompide_number).xspeed#
print "Yspeed : ", escompides(escompide_number).yspeed#
inc escompides(escompide_number).anglX#,mousemoveX()/5
rotate object escompide_number+1801,escompides(escompide_number).anglY#,escompides(escompide_number).anglX#,0
if KEYSTATE(param(48)) then inc escompides(escompide_number).xspeed#,0.1
if KEYSTATE(param(49)) then dec escompides(escompide_number).xspeed#,0.1
if escompides(escompide_number).xspeed# > 2 then escompides(escompide_number).xspeed# = 2
if escompides(escompide_number).xspeed# < -1.5 then escompides(escompide_number).xspeed# = -1.5
if KEYSTATE(param(48))=0 and KEYSTATE(param(49))=0
if escompides(escompide_number).xspeed# > 0 then dec escompides(escompide_number).xspeed#,0.1
if escompides(escompide_number).xspeed# < 0 then inc escompides(escompide_number).xspeed#,0.1
if escompides(escompide_number).xspeed# > 0 then dec escompides(escompide_number).xspeed#,0.1
if escompides(escompide_number).xspeed# < 0 then inc escompides(escompide_number).xspeed#,0.1
if escompides(escompide_number).xspeed# < 0.1 and escompides(escompide_number).xspeed# > -0.1 then escompides(escompide_number).xspeed# = 0
endif
move object escompide_number+1801,escompides(escompide_number).xspeed#*Extrapolation*1.5
if keystate(18)
do
if keystate(18) =  0 then exit
loop
exclude object off game_arme_coress(arme)
show sprite 15
gameplay_Type = 1
escompides(escompide_number).pilote_occupe = 0
X# = escompides(t).x#
Y# = escompides(t).y#+200
Z# = escompides(t).z#
endif
endif

rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
rem ======================================================V2CI=====================================================================
rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
if Vehicule_type = 2
print
print "X: ",object position x(v2ci_number+2001)," Y: ",object position y(v2ci_number+2001)," Z: ",object position z(v2ci_number+2001)
print "Xspeed : ", v2cis(v2ci_number).xspeed#
print "Yspeed : ", v2cis(v2ci_number).yspeed#

inc v2cis(v2ci_number).anglX#,mousemoveX()/5
inc v2cis(v2ci_number).anglY#,mousemoveY()/5
rotate object v2ci_number+2001,v2cis(v2ci_number).anglY#,v2cis(v2ci_number).anglX#,0
if KEYSTATE(param(48)) then inc v2cis(v2ci_number).xspeed#,0.1
if KEYSTATE(param(49)) then dec v2cis(v2ci_number).xspeed#,0.1
if v2cis(v2ci_number).xspeed# > 2 then v2cis(v2ci_number).xspeed# = 2
if v2cis(v2ci_number).xspeed# < -1.5 then v2cis(v2ci_number).xspeed# = -1.5
if KEYSTATE(param(48))=0 and KEYSTATE(param(49))=0
if v2cis(v2ci_number).xspeed# > 0 then dec v2cis(v2ci_number).xspeed#,0.1
if v2cis(v2ci_number).xspeed# < 0 then inc v2cis(v2ci_number).xspeed#,0.1
if v2cis(v2ci_number).xspeed# > 0 then dec v2cis(v2ci_number).xspeed#,0.1
if v2cis(v2ci_number).xspeed# < 0 then inc v2cis(v2ci_number).xspeed#,0.1
if v2cis(v2ci_number).xspeed# < 0.1 and v2cis(v2ci_number).xspeed# > -0.1 then v2cis(v2ci_number).xspeed# = 0
endif
move object v2ci_number+2001,v2cis(v2ci_number).xspeed#*Extrapolation*1.5
if KEYSTATE(param(51)) then inc v2cis(v2ci_number).yspeed#,0.1
if KEYSTATE(param(50)) then dec v2cis(v2ci_number).yspeed#,0.1
if v2cis(v2ci_number).yspeed# > 1.5 then v2cis(v2ci_number).yspeed# = 1.5
if v2cis(v2ci_number).yspeed# < -1.5 then v2cis(v2ci_number).yspeed# = -1.5
if KEYSTATE(param(51))=0 and KEYSTATE(param(50))=0
if v2cis(v2ci_number).yspeed# > 0 then dec v2cis(v2ci_number).yspeed#,0.1
if v2cis(v2ci_number).yspeed# < 0 then inc v2cis(v2ci_number).yspeed#,0.1
if v2cis(v2ci_number).yspeed# > 0 then dec v2cis(v2ci_number).yspeed#,0.1
if v2cis(v2ci_number).yspeed# < 0 then inc v2cis(v2ci_number).yspeed#,0.1
if v2cis(v2ci_number).yspeed# < 0.1 and v2cis(v2ci_number).yspeed# > -0.1 then v2cis(v2ci_number).yspeed# = 0
endif
move object left v2ci_number+2001,v2cis(v2ci_number).yspeed#*Extrapolation*1.5
position object v2ci_number+2001,object position x(v2ci_number+2001),object position y(v2ci_number+2001)-gravite#/(5/3),object position z(v2ci_number+2001)


if KEYSTATE(16)
do
if KEYSTATE(16)=0 then exit
loop
temp = v2cis(v2ci_number).porte
select temp
case 0:play object v2ci_number+2001,0,50:v2cis(v2ci_number).porte=1:endcase
case 1:play object v2ci_number+2001,50,100:v2cis(v2ci_number).porte=0:endcase
endselect
endif


if keystate(18)
do
if keystate(18) =  0 then exit
loop
exclude object off game_arme_coress(arme)
show sprite 15
gameplay_Type = 1
v2cis(v2ci_number).pilote_occupe = 0
X# = v2cis(t).x#
Y# = v2cis(t).y#+400
Z# = v2cis(t).z#
endif

endif


rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
rem ======================================================Moto Droide=====================================================================
rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
if Vehicule_type = 3
print
print "X: ",object position x(motoD_number+2101)," Y: ",object position y(motoD_number+2101)," Z: ",object position z(motoD_number+2101)
print "Xspeed : ", motoDs(motoD_number).xspeed#
inc motoDs(motoD_number).anglX#,mousemoveX()/5
rotate object motoD_number+2101,motoDs(motoD_number).anglY#,motoDs(motoD_number).anglX#,0
if KEYSTATE(param(48)) then inc motoDs(motoD_number).xspeed#,0.1
if KEYSTATE(param(49)) then dec motoDs(motoD_number).xspeed#,0.1
if motoDs(motoD_number).xspeed# > 2 then motoDs(motoD_number).xspeed# = 2
if motoDs(motoD_number).xspeed# < -1.5 then motoDs(motoD_number).xspeed# = -1.5
if KEYSTATE(param(48))=0 and KEYSTATE(param(49))=0
if motoDs(motoD_number).xspeed# > 0 then dec motoDs(motoD_number).xspeed#,0.1
if motoDs(motoD_number).xspeed# < 0 then inc motoDs(motoD_number).xspeed#,0.1
if motoDs(motoD_number).xspeed# > 0 then dec motoDs(motoD_number).xspeed#,0.1
if motoDs(motoD_number).xspeed# < 0 then inc motoDs(motoD_number).xspeed#,0.1
if motoDs(motoD_number).xspeed# < 0.1 and motoDs(motoD_number).xspeed# > -0.1 then motoDs(motoD_number).xspeed# = 0
endif
move object motoD_number+2101,motoDs(motoD_number).xspeed#*Extrapolation*2.5
if keystate(18)
do
if keystate(18) =  0 then exit
loop
exclude object off game_arme_coress(arme)
show sprite 15
gameplay_Type = 1
motoDs(motoD_number).pilote_occupe = 0
X# = motoDs(t).x#
Y# = motoDs(t).y#+200
Z# = motoDs(t).z#
endif
endif



rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
rem ======================================================Char Coléoptère=====================================================================
rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
if Vehicule_type = 4
print
print "X: ",object position x(coleoptere_number+2201)," Y: ",object position y(coleoptere_number+2201)," Z: ",object position z(coleoptere_number+2201)
print "Xspeed : ", coleopteres(coleoptere_number).xspeed#
inc coleopteres(coleoptere_number).anglX#,KEYSTATE(param(50))
dec coleopteres(coleoptere_number).anglX#,KEYSTATE(param(51))
rotate object coleoptere_number+2201,coleopteres(coleoptere_number).anglY#,coleopteres(coleoptere_number).anglX#,0
if KEYSTATE(param(48)) then inc coleopteres(coleoptere_number).xspeed#,0.1
if KEYSTATE(param(49)) then dec coleopteres(coleoptere_number).xspeed#,0.1
if coleopteres(coleoptere_number).xspeed# > 2 then coleopteres(coleoptere_number).xspeed# = 2
if coleopteres(coleoptere_number).xspeed# < -1.5 then coleopteres(coleoptere_number).xspeed# = -1.5
if KEYSTATE(param(48))=0 and KEYSTATE(param(49))=0
if coleopteres(coleoptere_number).xspeed# > 0 then dec coleopteres(coleoptere_number).xspeed#,0.1
if coleopteres(coleoptere_number).xspeed# < 0 then inc coleopteres(coleoptere_number).xspeed#,0.1
if coleopteres(coleoptere_number).xspeed# > 0 then dec coleopteres(coleoptere_number).xspeed#,0.1
if coleopteres(coleoptere_number).xspeed# < 0 then inc coleopteres(coleoptere_number).xspeed#,0.1
if coleopteres(coleoptere_number).xspeed# < 0.1 and coleopteres(coleoptere_number).xspeed# > -0.1 then coleopteres(coleoptere_number).xspeed# = 0
endif
move object coleoptere_number+2201,coleopteres(coleoptere_number).xspeed#*Extrapolation*0.75
if keystate(18)
do
if keystate(18) =  0 then exit
loop
exclude object off game_arme_coress(arme)
show sprite 15
gameplay_Type = 1
coleopteres(coleoptere_number).pilote_occupe = 0
X# = coleopteres(t).x#
Y# = coleopteres(t).y#+200
Z# = coleopteres(t).z#
endif


Coleo_OldYanglsup# = Coleo_Yanglsup#
inc Coleo_Yanglsup#,mousemovey()
if Coleo_OldYanglsup# = Coleo_Yanglsup# then Coleo_Yanglsup# = curvevalue(Coleo_Yanglsup#,0,0.7)

endif



rem ============================================================================================================================
endif
rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
rem =============================================Routines hors gameplay=====================================================================
rem *.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.*.
if nb_vautour > 0
for t = 0 to nb_vautour-1
if Vautours(t).pilote_occupe = 0 then position object t+1701,object position x(t+1701),object position y(t+1701)-gravite#*2,object position z(t+1701)
      Vautours(t).x# =object position x(t+1701)
      Vautours(t).y# =object position y(t+1701)
      Vautours(t).z# =object position z(t+1701)
Vautours(t).collide = sc_SphereSlide(0,Vautours(t).oldx#,Vautours(t).oldy#,Vautours(t).oldz#,Vautours(t).x#,Vautours(t).y#,Vautours(t).z#,object size(t+1701)+10,t+1701)
if Vautours(t).collide > 0
      Vautours(t).x# = sc_getCollisionSlideX()
      Vautours(t).y# = sc_getCollisionslideY()
      Vautours(t).z# = sc_getCollisionSlideZ()
      position object t+1701,Vautours(t).x#,Vautours(t).y#,Vautours(t).z#
endif
SC_updateObject t+1701
if t=Vautour_number and Vehicule_type = 0 and gameplay_Type = 3 then  SET CAMERA TO FOLLOW object position x(Vautour_number+1701),object position y(Vautour_number+1701),object position z(Vautour_number+1701),object angle y(Vautour_number+1701),1000,500,3,0
next t
endif

if nb_escompide > 0
for t = 0 to nb_escompide-1
if escompides(t).collide2 > 0 then  position object t+1801,object position x(t+1801),object position y(t+1801)-gravite#*2,object position z(t+1801)
if escompides(t).collide2 = 0 and escompides(t).collide = 0 then position object t+1801,object position x(t+1801),object position y(t+1801)-gravite#*4,object position z(t+1801)
      escompides(t).x# =object position x(t+1801)
      escompides(t).y# =object position y(t+1801)
      escompides(t).z# =object position z(t+1801)
escompides(t).collide2 = sc_SphereSlide(0,escompides(t).oldx#,escompides(t).oldy#-10,escompides(t).oldz#,escompides(t).x#,escompides(t).y#-10,escompides(t).z#,object size(t+1801)-20,t+1801)
escompides(t).collide = sc_SphereSlide(0,escompides(t).oldx#,escompides(t).oldy#,escompides(t).oldz#,escompides(t).x#,escompides(t).y#,escompides(t).z#,object size(t+1801)+10,t+1801)
if escompides(t).collide > 0
      escompides(t).x# = sc_getCollisionSlideX()
      escompides(t).y# = sc_getCollisionslideY()
      escompides(t).z# = sc_getCollisionSlideZ()
      position object t+1801,escompides(t).x#,escompides(t).y#,escompides(t).z#
endif
SC_updateObject t+1801
if t=escompide_number and Vehicule_type = 1 and gameplay_Type = 3 then  SET CAMERA TO FOLLOW object position x(escompide_number+1801),object position y(escompide_number+1801),object position z(escompide_number+1801),object angle y(escompide_number+1801),1000,500,3,0
next t
endif


if nb_v2ci >0
for t = 0 to nb_v2ci-1
if v2cis(t).pilote_occupe = 0 then position object t+2001,object position x(t+2001),object position y(t+2001)-gravite#*2,object position z(t+2001)
      v2cis(t).x# =object position x(t+2001)
      v2cis(t).y# =object position y(t+2001)
      v2cis(t).z# =object position z(t+2001)
v2cis(t).collide = sc_SphereSlide(0,v2cis(t).oldx#,v2cis(t).oldy#,v2cis(t).oldz#,v2cis(t).x#,v2cis(t).y#,v2cis(t).z#,object size(t+2001)+10,t+2001)
if v2cis(t).collide > 0
      v2cis(t).x# = sc_getCollisionSlideX()
      v2cis(t).y# = sc_getCollisionslideY()
      v2cis(t).z# = sc_getCollisionSlideZ()
      position object t+2001,v2cis(t).x#,v2cis(t).y#,v2cis(t).z#
endif
SC_updateObject t+2001
if t=v2ci_number and Vehicule_type = 2 and gameplay_Type = 3 then  SET CAMERA TO FOLLOW object position x(v2ci_number+2001),object position y(v2ci_number+2001),object position z(v2ci_number+2001),object angle y(v2ci_number+2001),1500,800,3,0
next t
endif

if nb_motoD > 0
for t = 0 to nb_motoD-1
if motoDs(t).collide2 > 0 then  position object t+2101,object position x(t+2101),object position y(t+2101)-gravite#*2,object position z(t+2101)
if motoDs(t).collide2 = 0 and motoDs(t).collide = 0 then position object t+2101,object position x(t+2101),object position y(t+2101)-gravite#*4,object position z(t+2101)
      motoDs(t).x# =object position x(t+2101)
      motoDs(t).y# =object position y(t+2101)
      motoDs(t).z# =object position z(t+2101)
motoDs(t).collide2 = sc_SphereSlide(0,motoDs(t).oldx#,motoDs(t).oldy#-10,motoDs(t).oldz#,motoDs(t).x#,motoDs(t).y#-10,motoDs(t).z#,object size(t+2101)-10,t+2101)
motoDs(t).collide = sc_SphereSlide(0,motoDs(t).oldx#,motoDs(t).oldy#,motoDs(t).oldz#,motoDs(t).x#,motoDs(t).y#,motoDs(t).z#,object size(t+2101)+10,t+2101)
if motoDs(t).collide > 0
      motoDs(t).x# = sc_getCollisionSlideX()
      motoDs(t).y# = sc_getCollisionslideY()
      motoDs(t).z# = sc_getCollisionSlideZ()
      position object t+2101,motoDs(t).x#,motoDs(t).y#,motoDs(t).z#
endif
SC_updateObject t+2101
if t=motoD_number and Vehicule_type = 3 and gameplay_Type = 3 then  SET CAMERA TO FOLLOW object position x(motoD_number+2101),object position y(motoD_number+2101),object position z(motoD_number+2101),object angle y(motoD_number+2101),100,150,3,0
next t
endif

if nb_coleoptere > 0
for t = 0 to nb_coleoptere-1
if coleopteres(t).collide2 > 0 then  position object t+2201,object position x(t+2201),object position y(t+2201)-gravite#*2,object position z(t+2201)
if coleopteres(t).collide2 = 0 and coleopteres(t).collide = 0 then position object t+2201,object position x(t+2201),object position y(t+2201)-gravite#*4,object position z(t+2201)
      coleopteres(t).x# =object position x(t+2201)
      coleopteres(t).y# =object position y(t+2201)
      coleopteres(t).z# =object position z(t+2201)
coleopteres(t).collide2 = sc_SphereSlide(0,coleopteres(t).oldx#,coleopteres(t).oldy#-10,coleopteres(t).oldz#,coleopteres(t).x#,coleopteres(t).y#-10,coleopteres(t).z#,object size(t+2201)-10,t+2201)
coleopteres(t).collide = sc_SphereSlide(0,coleopteres(t).oldx#,coleopteres(t).oldy#,coleopteres(t).oldz#,coleopteres(t).x#,coleopteres(t).y#,coleopteres(t).z#,object size(t+2201)+10,t+2201)
if coleopteres(t).collide > 0
      coleopteres(t).x# = sc_getCollisionSlideX()
      coleopteres(t).y# = sc_getCollisionslideY()
      coleopteres(t).z# = sc_getCollisionSlideZ()
      position object t+2201,coleopteres(t).x#,coleopteres(t).y#,coleopteres(t).z#
endif
SC_updateObject t+2201
if t=coleoptere_number and Vehicule_type = 4 and gameplay_Type = 3 then  SET CAMERA TO FOLLOW object position x(coleoptere_number+2201),object position y(coleoptere_number+2201),object position z(coleoptere_number+2201),coleopteres(coleoptere_number).anglX#+Coleo_Yanglsup#,2500,500,3,0
next t
for t = 0 to nb_coleoptere-1
position object t+2301,object position x(t+2201),object position y(t+2201),object position z(t+2201)
rotate object t+2301,coleopteres(coleoptere_number).anglY#,coleopteres(coleoptere_number).anglX#+Coleo_Yanglsup#,0
next t
endif


   sc_updateObject 1
   sc_updateObject 2
   sc_updateObject 3
   sc_updateObject 4
   sc_updateObject 5

return

Rem *** Include File: Solo_Domination.dba ***
Rem Created: 05/04/2008 17:27:21

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
Rem *** Include File: Solo_matchamort.dba ***
Rem Created: 16/01/2008 07:41:04

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
rem la domination
Domination:

set dir CheminMA$+"\jpegs\menu"
hide sprite 1
hide sprite 2
load image "Solo_select.jpg",4,1
sprite 4,-257,0,4
load image "Solo_preview.jpg",5,1
sprite 5,param(35)-512,-257,5
load image "Solo_Brefing.jpg",6,1
sprite 6,param(35),param(36)-512,6
load image "Solo_Descrition.jpg",7,1
sprite 7,param(35)/2,param(36),7
Solo_arrive = 0

for Partie_solo = 6 to 246 step 10
rem on bouge la camera
NewExtrapolationTimer=timer()
Extrapolation=(NewExtrapolationTimer-OldExtrapolationTimer)/2
OldExtrapolationTimer=NewExtrapolationTimer
inc temporel,Extrapolation*3
inc temporel2#
gosub menu_cammov

wait 0
inc Solo_arrive,10
sprite 4,-257+Solo_arrive,0,4
sprite 5,param(35)-512,-257+Solo_arrive,5
sprite 6,param(35)-Solo_arrive,param(36)-512,6
sprite 7,param(35)/2,param(36)-Solo_arrive,7
next Partie_solo

set dir CheminMA$+"\Cartes\Domination"
open to read 1,"index.ini"
read float 1,Solo_nbCartes#
Solo_nbCartes = int(Solo_nbCartes#)
if Solo_nbCartes = 0 then exit prompt "Il n'y a aucune carte dans le jeu !","Metal assault Erreur" : end
for Carteliste_solo = 0 to Solo_nbCartes
read string 1,Solo_CarteNom$(Carteliste_solo)
next Carteliste_solo
close file 1

rem config default
nbsentinelles = 1
nbwarmachines = 0
Scorelimit = 100

do
rem on bouge la camera
NewExtrapolationTimer=timer()
Extrapolation=(NewExtrapolationTimer-OldExtrapolationTimer)/2
OldExtrapolationTimer=NewExtrapolationTimer
inc temporel,Extrapolation*3
inc temporel2#
gosub menu_cammov

rem affichage des noms des cartes
         set text size 16
         set text to bold
         create bitmap 1,256,256
         if Solo_nbCartes > 0
         print Solo_CarteNom$(0)
         get image 10,0,0,200,20
         sprite 10,0,95,10
         cls
         endif
         delete bitmap 1
         create bitmap 1,256,256
         if Solo_nbCartes > 1
         print Solo_CarteNom$(1)
         get image 11,0,0,200,20
         sprite 11,0,145,11
         cls
         endif
         delete bitmap 1
         create bitmap 1,256,256
         if Solo_nbCartes > 2
         print Solo_CarteNom$(2)
         get image 12,0,0,200,20
         sprite 12,0,185,12
         cls
         endif
         delete bitmap 1
         create bitmap 1,256,256
         if Solo_nbCartes > 3
         print Solo_CarteNom$(3)
         get image 13,0,0,200,20
         sprite 13,0,225,13
         cls
         endif
         delete bitmap 1
         create bitmap 1,256,256
         if Solo_nbCartes > 4
         print Solo_CarteNom$(4)
         get image 15,0,0,200,20
         sprite 15,0,275,15
         cls
         create bitmap 1,256,256
         if Solo_nbCartes > 5
         print Solo_CarteNom$(5)
         get image 16,0,0,200,20
         sprite 16,0,324,16
         cls
         endif
         create bitmap 1,256,256
         if Solo_nbCartes > 6
         print Solo_CarteNom$(6)
         get image 17,0,0,200,20
         sprite 17,0,370,17
         cls
         endif
         create bitmap 1,256,256
         if Solo_nbCartes > 7
         print Solo_CarteNom$(7)
         get image 18,0,0,200,20
         sprite 18,0,410,18
         cls
         endif
         endif
         delete bitmap 1
         create bitmap 1,256,256
         print Scorelimit
         get image 14,0,0,30,30
         sprite 14,990,485,14
         cls
         delete bitmap 1
         create bitmap 1,256,256
         print nbwarmachines
         get image 19,0,0,30,30
         sprite 19,995,271,19
         cls
         delete bitmap 1
         create bitmap 1,256,256
         print nbsentinelles
         get image 20,0,0,30,30
         sprite 20,995,335,20
         cls
         delete bitmap 1
if boutton2(987,473,1012,487)=1 then inc Scorelimit,5
if boutton2(987,508,1012,521)=1 then dec Scorelimit,5
if boutton2(987,258,1012,272)=1 then nbwarmachines = 1 : nbsentinelles = 0
if boutton2(987,293,1012,306)=1 then nbwarmachines = 0 : nbsentinelles = 1
if boutton2(987,318,1012,332)=1 then nbwarmachines = 0 : nbsentinelles = 1
if boutton2(987,353,1012,366)=1 then nbwarmachines = 1 : nbsentinelles = 0
if mouseX() < 215
      rem le boutton de menu principal
      if mouseY() > 10 and mousey() < 45
      if mouseclick()=1
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      for Partie_solo = 6 to 246 step 10
      wait 0
      dec Solo_arrive,10
      sprite 4,-257+Solo_arrive,0,4
      sprite 5,param(35)-512,-257+Solo_arrive,5
      sprite 6,param(35)-Solo_arrive,param(36)-512,6
      sprite 7,param(35)/2,param(36)-Solo_arrive,7
      next Partie_solo
      show sprite 1
      show sprite 2
      delete image 4
      delete sprite 4
      delete image 5
      delete sprite 5
      delete image 6
      delete sprite 6
      delete image 7
      delete sprite 7

      goto menu_base
      endif
      endif

      rem les autres
mosXMax = 135 : MosXmin = 100 : index = 0 : gosub elem_domination
mosXMax = 265 : MosXmin = 217 : index = 3 : gosub elem_domination
if mouseY() > 135 and mousey() < 175
      if Solo_nbCartes > 1
      Solo_carte_en_revue = 2
      Nomcarte$ = Solo_CarteNom$(1)
      set dir CheminMA$+"\Cartes\Domination\"+Nomcarte$
      load image "preview.jpg",8,1
      sprite 8,param(35)-480,0,8
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Domination"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
         if sprite exist (10) then delete sprite 10
         if sprite exist (11) then delete sprite 11
         if sprite exist (12) then delete sprite 12
         if sprite exist (13) then delete sprite 13
         if sprite exist (14) then delete sprite 14
         if sprite exist (15) then delete sprite 15
         if sprite exist (16) then delete sprite 16
         if sprite exist (17) then delete sprite 17
         if sprite exist (18) then delete sprite 18
         if sprite exist (19) then delete sprite 19
         if sprite exist (20) then delete sprite 20
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 2
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif

      if mouseY() > 175 and mousey() < 217
      if Solo_nbCartes > 2
      Solo_carte_en_revue = 3
      Nomcarte$ = Solo_CarteNom$(2)
      set dir CheminMA$+"\Cartes\Domination\"+Nomcarte$
      load image "preview.jpg",8,1
      sprite 8,param(35)-480,0,8
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Domination"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 3
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif

      if mouseY() > 265 and mousey() < 314
      if Solo_nbCartes > 4
      Solo_carte_en_revue = 5
      Nomcarte$ = Solo_CarteNom$(4)
      set dir CheminMA$+"\Cartes\Domination\"+Nomcarte$
      load image "preview.jpg",8,1
      sprite 8,param(35)-480,0,8
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Domination"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 4
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif



      if mouseY() > 314 and mousey() < 360
      if Solo_nbCartes > 5
      Solo_carte_en_revue = 6
      Nomcarte$ = Solo_CarteNom$(5)
      set dir CheminMA$+"\Cartes\Domination\"+Nomcarte$
      load image "preview.jpg",8,1
      sprite 8,param(35)-480,0,8
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Domination"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 5
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif

      if mouseY() > 360 and mousey() < 400
      if Solo_nbCartes > 6
      Solo_carte_en_revue = 7
      Nomcarte$ = Solo_CarteNom$(6)
      set dir CheminMA$+"\Cartes\Domination\"+Nomcarte$
      load image "preview.jpg",8,1
      sprite 8,param(35)-480,0,8
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Domination"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 6
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif

      if mouseY() > 400 and mousey() < 445
      if Solo_nbCartes > 7
      Solo_carte_en_revue = 8
      Nomcarte$ = Solo_CarteNom$(7)
      set dir CheminMA$+"\Cartes\Domination\"+Nomcarte$
      load image "preview.jpg",8,1
      sprite 8,param(35)-480,0,8
      open to read 1,"descr.txt"
      set text font "arial",1
      set text size 14
      create bitmap 1,256,256
      for Solo_description_ligncount = 0 to 20
      read string 1,Solo_Description_ligne1$
      print Solo_Description_ligne1$
      next Solo_description_ligncount
      get image 9,0,0,256,256
      cls
      delete bitmap 1
      close file 1
      sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
      endif
      if mouseclick() = 1
      game_carte$=Nomcarte$
      type_game$="Domination"
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      if sprite exist (10) then delete sprite 10
      if sprite exist (11) then delete sprite 11
      if sprite exist (12) then delete sprite 12
      if sprite exist (13) then delete sprite 13
      if sprite exist (14) then delete sprite 14
      if sprite exist (15) then delete sprite 15
      if sprite exist (16) then delete sprite 16
      if sprite exist (17) then delete sprite 17
      if sprite exist (18) then delete sprite 18
      if sprite exist (19) then delete sprite 19
      if sprite exist (20) then delete sprite 20
      goto load_game
      endif
      else
      if Solo_carte_en_revue = 7
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
      endif
      endif
else
      Solo_carte_en_revue = 0
      if sprite exist (8) then delete sprite 8
      if sprite exist (9) then delete sprite 9
endif

loop

elem_domination:

      if mouseY() > mosXmin and mousey() < mosXmax

         if Solo_nbCartes > index
         Solo_carte_en_revue = index+1
         Nomcarte$ = Solo_CarteNom$(index)
         set dir CheminMA$+"\Cartes\Domination\"+Nomcarte$
         load image "preview.jpg",8,1
         sprite 8,param(35)-480,0,8
         open to read 1,"descr.txt"
         set text font "arial",1
         set text size 14
         create bitmap 1,256,256
         for Solo_description_ligncount = 0 to 20
         read string 1,Solo_Description_ligne1$
         print Solo_Description_ligne1$
         next Solo_description_ligncount
         get image 9,0,0,256,256
         cls
         delete bitmap 1
         close file 1
         sprite 9,(param(35)/2)+20,param(36)-(Solo_arrive-30),9
         endif

         if mouseclick() = 1
         game_carte$=Nomcarte$
         type_game$="Domination"
         if sprite exist (8) then delete sprite 8
         if sprite exist (9) then delete sprite 9
         if sprite exist (10) then delete sprite 10
         if sprite exist (11) then delete sprite 11
         if sprite exist (12) then delete sprite 12
         if sprite exist (13) then delete sprite 13
         if sprite exist (14) then delete sprite 14
         if sprite exist (15) then delete sprite 15
         if sprite exist (16) then delete sprite 16
         if sprite exist (17) then delete sprite 17
         if sprite exist (18) then delete sprite 18
         if sprite exist (19) then delete sprite 19
         if sprite exist (20) then delete sprite 20
         goto load_game
         endif

      else
         if Solo_carte_en_revue = index
         Solo_carte_en_revue = 0
         if sprite exist (8) then delete sprite 8
         if sprite exist (9) then delete sprite 9
         endif
      endif
return


Rem *** Include File: Market_armour.dba ***
Rem Created: 15/05/2008 11:29:34

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
Market_armure:
Autocam On
position camera 0,0,0
set dir CheminMA$+"\Jpegs\jeu\market"
load image "armor.jpg",17,1
set dir  CheminMA$+"\Models\Armures H\"
load object "Humain Top model.X",1
load object "Ultra Légere.X",2
load object "Légere.X",3
load object "poly.x",4
load object "Lourde.X",5
load object "Ultra Lourde.X",6
make object plain 7,1024,768
set object light 7,0
make light 1


texture object 7,17
rotate object 7,object angle X(7)-10,object angle y(7),object angle Z(7)
move camera 730
scale object 1,70,80,80
position object 1,-160,50,-300
set object 1,0,1,0
point object 1,camera position X()-160,camera position y()-50,camera position Z()

scale object 2,70,80,80
position object 2,-160,-90,-300
hide object 2
scale object 3,70,80,80
position object 3,-160,-90,-300
hide object 3
scale object 4,70,80,80
position object 4,-160,-90,-300
hide object 4
scale object 5,70,80,80
position object 5,-160,-90,-300
hide object 5
scale object 6,70,80,80
position object 6,-160,-90,-300
hide object 6

Armour_Rotate = 1
Armour_Boutonable = 1

do
NewExtrapolationTimer=timer()
Extrapolation=(NewExtrapolationTimer-OldExtrapolationTimer)/2
OldExtrapolationTimer=NewExtrapolationTimer
if Armour_Rotate = 1 then inc a,Extrapolation/3
yrotate object 1,a
yrotate object 2,a
yrotate object 3,a
yrotate object 4,a
yrotate object 5,a
yrotate object 6,a

if survol(0,0,500,768)
if mouseclick() = 1
Armour_Rotate = 0
Armour_Boutonable = 0
inc a,mousemovex()*2
else
Armour_Rotate = 1
Armour_Boutonable = 1
endif
endif


if Armour_Boutonable = 1
if boutton2(564,45,914,175)
armure_type = 1
Game_armure_force = 6 : rem on est capable de proter 6kg
Coeff_Vitesse_Joueur# = 2
exit
endif
if survol(564,45,914,175)
show object 2
else
hide object 2
endif
if boutton2(564,175,914,314)
armure_type = 2
Game_armure_force = 10 : rem on est capable de proter 10kg
Coeff_Vitesse_Joueur# = 1.5
exit
endif
if survol(564,175,914,314)
show object 3
else
hide object 3
endif
if boutton2(564,314,914,456)
armure_type = 3 : rem encore inutilisé car la seule UI dispo
Game_armure_force = 15 : rem on est capable de proter 15kg
Coeff_Vitesse_Joueur# = 1.0
exit
endif
if survol(564,314,914,456)
show object 4
else
hide object 4
endif
if boutton2(564,456,914,594)
armure_type = 4
Game_armure_force = 20
Coeff_Vitesse_Joueur# = 0.75
exit
endif
if survol(564,465,914,594)
show object 5
else
hide object 5
endif
if boutton2(564,594,914,723)
armure_type = 5
Game_armure_force = 75 : rem on est capable de proter 15kg
Coeff_Vitesse_Joueur# = 0.5
exit
endif
if survol(564,594,914,723)
show object 6
else
hide object 6
endif

else

if survol(0,45,param(35),175)
show object 2
else
hide object 2
endif
if survol(0,175,param(35),314)
show object 3
else
hide object 3
endif
if survol(0,314,param(35),456)
show object 4
else
hide object 4
endif
if survol(0,465,param(35),594)
show object 5
else
hide object 5
endif
if survol(0,594,param(35),723)
show object 6
else
hide object 6
endif

endif
loop

delete object 1
delete object 2
delete object 3
delete object 4
delete object 5
delete object 6
delete object 7
delete image 17
Autocam Off
return












texture object 2,1
rotate object 2,object angle X(2)-10,object angle y(2),object angle Z(2)
move camera 730

scale object 1,70,80,80
position object 1,-160,50,-300
set object 1,0,1,0
point object 1,camera position X()-160,camera position y()-50,camera position Z()

do
inc a
yrotate object 1,a

loop

Rem *** Include File: Game_tourelle.dba ***
Rem Created: 24/05/2008 11:11:44

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
Game_Goliath:
oldcamy#=camy#
oldcamx#=camx#
camy#=camy#+mousemoveY()*0.005*zoom
camx#=camx#+mousemoveX()*0.005*zoom
if camy#>50 then camy#=50
if camy#<-60 then camy# = -60
yrotate camera camx#
yrotate object Goliath_number,camx#
xrotate camera camy#
position camera object position X(Goliath_number),object position Y(Goliath_number)+120,object position Z(Goliath_number)
move camera -50

if keystate(18) = 1
do
if keystate(18) =  0 then exit
loop
gameplay_Type = 1
Dans_le_goliath_le_joueur_est = 0
exclude object off game_arme_coress(arme)
stop sound 8000
stop sound 8001
stop sound 8002
endif


rem le tir
if mouseclick() = 1 then inc Goliaths(Goliath_number-1281).Vitesse : Goliaths(Goliath_number-1281).Gachette_etat = 2 : else : dec Goliaths(Goliath_number-1281).Vitesse : Goliaths(Goliath_number-1281).Gachette_etat = 1
if Goliaths(Goliath_number-1281).Vitesse > 7 then Goliaths(Goliath_number-1281).Vitesse = 7
if Goliaths(Goliath_number-1281).Vitesse < 0 then Goliaths(Goliath_number-1281).Vitesse = 0
if Goliaths(Goliath_number-1281).Vitesse > 0
if 6>Goliaths(Goliath_number-1281).Vitesse>0 and Goliaths(Goliath_number-1281).Gachette_etat = 2
play object Goliath_number,0,30
if sound playing(8000) = 0 then play sound 8000
endif
if Goliaths(Goliath_number-1281).Vitesse > 5
   if object looping (Goliath_number) = 0 then loop object Goliath_number,30,70
   if sound looping (8001) = 0 then stop sound 8000 : loop sound 8001
   if Goliath_bal_en_cour > 8000+Goliath_nb_bal-32 then Goliath_bal_en_cour = 8000 + (Goliath_bal_en_cour-(8000+Goliath_nb_bal-32))
   inc Goliath_bal_en_cour,7
   t = 0
   for t = 0 to 7
   position object Goliath_bal_en_cour-t+1,newxvalue(camera position X(),camera angle Y()+90,60),camera position Y(),newzvalue(camera position z(),camera angle Y()+90,60)
   rotate object Goliath_bal_en_cour-t+1,camera angle X(),camera angle Y(),camera angle Z()
   Goliath_bal_life(Goliath_bal_en_cour-t-8000) = 50
   show object Goliath_bal_en_cour-t+1
   next t
   inc Goliath_bal_en_cour,8
   t= 0
   for t = 0 to 7
   position object Goliath_bal_en_cour-t+1,newxvalue(camera position X(),camera angle Y()-90,60),camera position Y(),newzvalue(camera position z(),camera angle Y()-90,60)
   rotate object Goliath_bal_en_cour-t+1,camera angle X(),camera angle Y(),camera angle Z()
   Goliath_bal_life(Goliath_bal_en_cour-t-8000) = 50
   next t
   t=0
   for t =0 to 15
   if Goliath_bal_life(Goliath_bal_en_cour-t-8000) > 0
   move object Goliath_bal_en_cour-t+1,30
   sc_updateobject Goliath_bal_en_cour-t+1
   dec Goliath_bal_life(Goliath_bal_en_cour-t-8000)
   else
   position object Goliath_bal_en_cour-t+1,0,90000000,0
   hide object Goliath_bal_en_cour-t+1
   endif
   next t
endif
if 0<Goliaths(Goliath_number-1281).Vitesse < 6 and Goliaths(Goliath_number-1281).Gachette_etat = 1
stop sound 8000
stop sound 8001
play sound 8002
play object Goliath_number,70,100
Goliaths(Goliath_number-1281).Gachette_etat = 0
endif
endif

rem on fait avancer les Muns
if Goliath_bal_en_cour > 8000 : rem si on a déja tiré au moins une fois
t=0
   for t =0 to 15
   if Goliath_bal_life(Goliath_bal_en_cour-t-8000) > 0
   move object Goliath_bal_en_cour-t+1,30
   point object Goliath_bal_en_cour-t+1,camera position x(),camera position y(),camera position z()
   sc_updateobject Goliath_bal_en_cour-t+1
   dec Goliath_bal_life(Goliath_bal_en_cour-t-8000)
   else
   position object Goliath_bal_en_cour-t+1,0,90000000,0
   hide object Goliath_bal_en_cour-t+1
   endif
   next t
endif

t= 0
for t= 8000 to 8000+Goliath_nb_bal-32
if Goliath_bal_life(t-8000) <= 0 then  hide object t+1 : position object t+1,0,90000000,0
if Goliath_bal_life(t-8000) > 0
   move object t+1,30
      point object t+1,camera position x(),camera position y(),camera position z()
   sc_updateobject t+1
   dec Goliath_bal_life(t-8000)
    for i= 0 to nbbot-1
    Gholiath_collide = sc_objectcollision(t+1,Bot(i).objet)
    if Gholiath_collide > 0 then exit
    next i
   if Gholiath_collide > 0 then dec Bot(i).Vie,rnd(50) : Goliath_bal_life(t-8000) = 0
endif
next t



`=== Control Hologram Constants ===========================
 set vector4 2,camera position x(),camera position y(),camera position z(),0.0
 set effect constant vector 2,"EyePos",2
return

Rem *** Include File: Game_aux.dba ***
Rem Created: 29/03/2008 10:24:35

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
dam_warn:
if dam_warn > 1
show sprite 18
sprite 18,0,0,18
set sprite alpha 18,dam_warn
dec dam_warn,10
if dam_warn <= 1 then hide sprite 18
endif
return

skyfrag:
if script_found  =1
if sc_spherecast(5,oldx3#,oldy3#,oldz3#,x4#,y4#,z4#,radius#,0)
vie = 0
endif
endif
return


rotate_sky:
if rotate_sky_x = 1 then xrotate object 5,temporel*sky_speed
if rotate_sky_y = 1 then yrotate object 5,temporel*sky_speed
if rotate_sky_z = 1 then zrotate object 5,temporel*sky_speed
return

Reaprovisionement_Muns:
if object exist(1257) =1
if distance(3,1257) < 150 and reapp_etat = 0 and Player_stats(0) >= (listarme(game_arme_coress(arme)-1000).price)/100
reapp_etat = 1
inc listarme(game_arme_coress(arme)-1000).bulets_Stock,5
dec Player_stats(0),(listarme(game_arme_coress(arme)-1000).price)/10
else
reapp_etat = 0
endif
endif
return


switch_gameplay:
if gameplay_Type = 1

for t = 0 to nb_goliath-1
if object exist(t+1281) =1
if distance(3,t+1281) < 500
show sprite 24
if keystate(18) = 1
hide sprite 24
do
if keystate(18) =  0 then exit
loop
exclude object on game_arme_coress(arme)
gameplay_Type = 2
Dans_le_goliath_le_joueur_est = 1
Goliath_number = 1281+t
endif
else
hide sprite 24
endif
endif
next t

if nb_Vautour > 0
for t = 0 to nb_Vautour-1
if object exist(t+1701) =1
if distance(3,t+1701) < 700
New_txt(3,"Vautour",26,255,255,255,screen width()/2,screen height()/2+150,256,258)
show sprite 24
if keystate(18) = 1
hide sprite 24
do
if keystate(18) =  0 then exit
loop
exclude object on game_arme_coress(arme)
hide sprite 15 : rem le réticule
gameplay_Type = 3
Vehicule_type = 0
Vautour_number = t
Vautours(Vautour_number).pilote_occupe = 1
endif
else
hide sprite 24
endif
endif
next t
endif

if nb_escompide > 0
for t = 0 to nb_escompide-1
if object exist(t+1801) =1
if distance(3,t+1801) < 700
New_txt(3,"Escompide",26,255,255,255,screen width()/2,screen height()/2+150,256,258)
show sprite 24
if keystate(18) = 1
hide sprite 24
do
if keystate(18) =  0 then exit
loop
exclude object on game_arme_coress(arme)
hide sprite 15 : rem le réticule
gameplay_Type = 3
Vehicule_type = 1
escompide_number = t
escompides(escompide_number).pilote_occupe = 1
endif
else
hide sprite 24
endif
endif
next t
endif

if nb_v2ci
for t = 0 to nb_v2ci-1
if object exist(t+2001) =1
if distance(3,t+2001) < 700
New_txt(3,"V2CI",26,255,255,255,screen width()/2,screen height()/2+150,256,258)
show sprite 24
if keystate(18) = 1
hide sprite 24
do
if keystate(18) =  0 then exit
loop
exclude object on game_arme_coress(arme)
hide sprite 15 : rem le réticule
gameplay_Type = 3
Vehicule_type = 2
v2ci_number = t
v2cis(escompide_number).pilote_occupe = 1
endif
else
hide sprite 24
endif
endif
next t
endif

if nb_MotoD > 0
for t = 0 to nb_MotoD-1
if object exist(t+2101) =1
if distance(3,t+2101) < 700
New_txt(3,"Moto Droide",26,255,255,255,screen width()/2,screen height()/2+150,256,258)
show sprite 24
if keystate(18) = 1
hide sprite 24
do
if keystate(18) =  0 then exit
loop
exclude object on game_arme_coress(arme)
hide sprite 15 : rem le réticule
gameplay_Type = 3
Vehicule_type = 3
MotoD_number = t
MotoDs(MotoD_number).pilote_occupe = 1
endif
else
hide sprite 24
endif
endif
next t
endif

if nb_coleoptere > 0
for t = 0 to nb_coleoptere-1
if object exist(t+2201) =1
if distance(3,t+2201) < 1000
New_txt(3,"Char Coléoptère",26,255,255,255,screen width()/2,screen height()/2+150,256,258)
show sprite 24
if keystate(18) = 1
hide sprite 24
do
if keystate(18) =  0 then exit
loop
exclude object on game_arme_coress(arme)
hide sprite 15 : rem le réticule
gameplay_Type = 3
Vehicule_type = 4
coleoptere_number = t
coleopteres(coleoptere_number).pilote_occupe = 1
endif
else
hide sprite 24
endif
endif
next t
endif


endif
return





Rem *** Include File: Console.dba ***
Rem Created: 25/02/2008 13:44:05

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
console:

ink rgb(255,255,255),0
set cursor 0,param(36)-160
print game_console$(1)
ink rgb(200,200,200),0
set cursor 0,param(36)-180
print game_console$(2)
ink rgb(150,150,150),0
set cursor 0,param(36)-200
print game_console$(3)
ink rgb(100,100,100),0
set cursor 0,param(36)-220
print game_console$(4)
ink rgb(50,50,50),0
set cursor 0,param(36)-240
print game_console$(5)
ink rgb(255,255,255),0

if game_console_txtametr$ = ""
else
game_console$(0)=game_console_txtametr$
game_console_txtametr$ = ""
for t=1 to 5
game_console$(6-t)=game_console$(5-t)
next t
endif

if keystate(param(56)) = 1 then game_console_inputmsg = 1
if game_console_inputmsg = 1 then game_console_txtametr$ = pseudo_input(300,24,">>:",250)
if keystate(28) = 1 then game_console_inputmsg = 0 : cls

return

Rem *** Include File: Config.dba ***
Rem Included in Project: C:\DBP\Projects\Metal Assault\Metal Assault.dbpro

Config:
global config_menu_id
rem on enlève le menu principal
hide sprite 1
hide sprite 2
rem et on met le panneau de conf
set dir CheminMA$+"\jpegs\menu"
load image "config_général.bmp",10,1
cls
paste image 10,0,0
config_menu_id = 1
Config_delprofilestatus = 1
Config_profilselectOLD = 999
Config_selectprofilestatus = 1

rem les menus latéraux
do
if mouseX() > 10 and mouseX() < 190
   if mousey() > 30 and mouseY() < 65 and mouseclick() = 1
   delete image 10
   cls
   set dir CheminMA$+"\jpegs\menu"
   load image "config_général.bmp",10,1
   paste image 10,0,0
   config_menu_id = 1
   endif

   if mousey() > 75 and mouseY() < 110 and mouseclick() = 1
   delete image 10
   cls
   set dir CheminMA$+"\jpegs\menu"
   load image "config_Video.bmp",10,1
   paste image 10,0,0
   config_menu_id = 2
   endif

   if mousey() > 125 and mouseY() < 155 and mouseclick() = 1
   delete image 10
   cls
   set dir CheminMA$+"\jpegs\menu"
   load image "config_audio.bmp",10,1
   paste image 10,0,0
   config_menu_id = 3
   endif

   if mousey() > 720 and mouseY() < 755 and mouseclick() = 1
set dir CheminMA$+"\configs\"+Configjoueur$
delete file "param.txt"
save array "param.txt",param(60)
   delete image 10
   cls
   show sprite 1
   show sprite 2
   rem le fond

   rem l'image de fond
   set dir CheminMA$+"\jpegs\menu"
   load image "Fond.jpg",100,1
   paste image 100,0,0
   goto menu_base
   set display mode param(35),param(36),param(37)
   endif
endif



select config_menu_id
case 1
gosub menu1
endcase
case 2
gosub menu2
endcase
case 3
gosub menu3
endcase
case 4
gosub menu4
endcase
endselect

loop


menu1:
confoption(507,530,57,70,92,103,0,1,1)
confoption(392,416,96,108,131,142,-999,999,2)
confoption(432,455,132,144,167,178,1,999,3)
confoption(395,418,167,179,202,213,1,999,4)
confoption(530,553,207,219,242,254,1,999,5)
confoption(583,606,249,262,284,295,-999,999,6)
confoption(550,573,286,298,320,332,-999,999,7)
confoption(587,610,325,337,360,372,-999,999,8)
confoption(632,655,368,380,403,415,-999,999,9)
confoption(578,600,413,425,448,460,0,999,10)
confoption(468,491,457,469,492,503,-999,999,11)
confoption(502,525,499,511,534,545,-999,999,12)
confoption(549,572,541,553,576,587,-999,999,13)
confoption(595,918,579,591,614,625,1,999,14)
confoption(516,539,619,631,654,666,1,999,15)
confoption(552,576,658,670,693,704,1,999,16)
confoption(585,608,696,707,730,742,-999,999,17)
confoption(638,662,718,732,753,764,-999,999,18)
confoption(949,972,97,109,132,143,-999,999,19)
confoption(918,942,138,150,173,184,0,999,20)
confoption(889,913,179,191,214,226,0,999,21)
confoption(921,944,221,234,257,268,0,999,22)
confoption(956,980,271,283,306,318,-999,999,23)
confoption(876,900,312,324,347,359,1,999,24)
confoption(838,861,358,370,393,404,1,999,25)
confoption(876,899,400,412,435,446,1,999,26)
confoption(854,877,449,461,484,495,1,999,27)
confoption(963,986,488,500,524,534,-999,999,28)
confoption(887,910,529,541,564,575,0,999,29)
confoption(854,877,574,586,610,620,-999,999,30)
rem le boutton config autre
if mouseX() > 660 and mouseX() < 965 and mouseY() > 655 and mousey() < 710 and mouseclick() = 1
set dir CheminMA$+"\jpegs\menu"
load image "config_autre.bmp",11,1
set dir CheminMA$+"\configs\"
open to read 1,"index.ini"

read string 1,config_nblignes$
config_nblignes = val(config_nblignes$)
for i = 0 to config_nblignes
read string 1,temp$
Config_listeprofil$(i) = temp$
next i
close file 1
config_menu_id = 4
endif
return







menu2:
confoption(380,404,119,131,154,165,0,99999,35)
confoption(415,449,119,131,154,165,0,99999,36)
confoption(433,456,168,180,203,215,0,99,37)
confoption(425,448,222,234,257,269,0,3,38)
confoption(465,488,269,281,304,315,0,3,39)
confoption(414,437,316,328,351,362,0,1,40)
confoption(375,398,364,376,399,410,0,1,41)
confoption(411,434,411,423,446,456,0,1,42)
confoption(471,494,467,479,502,513,0,100,43)
confoption(406,429,509,521,544,555,0,999,44)
confoption(403,426,559,571,594,605,0,1,45)
confoption(433,456,600,612,635,647,0,3,46)
confoption(363,386,644,656,679,691,0,1,47)
return




menu3:
confoption(469,495,90,100,125,136,0,100,31)
confoption(420,443,122,135,158,169,0,100,32)
confoption(460,483,159,171,194,205,0,100,33)
confoption(398,421,208,220,243,254,0,1,34)
return





menu4:
confoption(0,0,0,0,0,0,0,0,0)
if boutton2(685,87,707,104) = 1 then delete image 11 : config_menu_id = 1

if boutton2(322,638,508,670) = 1
set dir CheminMA$+"\configs\"
for i = 0 to config_nblignes
set cursor 360,470+i*15 : print Config_listeprofil$(i)
temp = 470+i*15+15
next i
set cursor 360,temp
input ">:",Config_newdrname$
make directory Config_newdrname$
copy file "default\param.txt",Config_newdrname$+"\param.txt"
copy file "default\keymap.txt",Config_newdrname$+"\keymap.txt"
copy file "default\stats.txt",Config_newdrname$+"\stats.txt"
delete file "index.ini"
open to write 1,"index.ini"
write string 1,str$(config_nblignes+1)
for i = 0 to config_nblignes-1
temp$ = Config_listeprofil$(i)
write string 1,temp$
next i
write string 1,Config_newdrname$
close file 1
open to read 1,"index.ini"
read string 1,config_nblignes$
config_nblignes = val(config_nblignes$)
for i = 0 to config_nblignes
read string 1,temp$
Config_listeprofil$(i) = temp$
next i
close file 1
endif


if mousex() > 358 and  622 > mousex() and mouseclick() = 1 and Config_selectprofilestatus = 1
Config_selectprofilestatus = 0
Config_profilselectOLD = Config_profilselect
if 470<mousey() and mousey()<480
Config_profilselect = 0
endif
if 480<mousey() and mousey()<495
Config_profilselect = 1
endif
if 500<mousey() and  mousey()<510
Config_profilselect = 2
endif
if 510<mousey() and mousey()<525
Config_profilselect = 3
endif
if 525<mousey() and mousey()<540
Config_profilselect = 4
endif
if 540<mousey() and mousey()<555
Config_profilselect = 5
endif
if 555<mousey() and mousey()<570
Config_profilselect = 6
endif
if 570<mousey() and mousey()<595
Config_profilselect = 7
endif
if 595<mousey() and mousey()<610
Config_profilselect = 8
endif
if 610<mousey() and mousey()<625
Config_profilselect = 9
endif
endif
if Config_selectprofilestatus = 0 and mouseclick() =0 then Config_selectprofilestatus = 1

if boutton2(508,638,881,670) = 1 and Config_delprofilestatus = 1 and config_nblignes>0 and Config_profilselect > 0
Config_delprofilestatus = 0
delete directory Config_listeprofil$(Config_profilselect)
dec config_nblignes
for i = Config_profilselect to 8
Config_listeprofil$(i) = Config_listeprofil$(i+1)
next i
delete file "index.ini"
open to write 1,"index.ini"
write string 1,str$(config_nblignes)
for i = 0 to config_nblignes
temp$ = Config_listeprofil$(i)
write string 1,temp$
next i
close file 1
Config_profilselect = 0
Config_profilselectOLD = 999
endif
if Config_delprofilestatus = 0 and mouseclick() =0 then Config_delprofilestatus = 1


if Config_profilselectOLD = Config_profilselect
gosub Config_Switch_profile
endif

if 608<mousex() and mousex()<702 and mouseclick() = 1

if 128<mousey() and mousey()<150 then param(48) = getkey(0)
if 150<mousey() and mousey()<180 then param(49) = getkey(1)
if 180<mousey() and mousey()<207 then param(50) = getkey(2)
if 207<mousey() and mousey()<234 then param(51) = getkey(3)
if 234<mousey() and mousey()<261 then param(52) = getkey(4)
if 261<mousey() and mousey()<290 then param(53) = getkey(5)
if 290<mousey() and mousey()<321 then param(54) = getkey(6)
if 321<mousey() and mousey()<355 then param(55) = getkey(7)
if 355<mousey() and mousey()<384 then param(56) = getkey(8)

endif

return





Config_Switch_profile:
set dir CheminMA$+"\configs\"
if path exist(CheminMA$+"\configs\"+Configjoueur$) = 1
set dir CheminMA$+"\configs\"+Configjoueur$
delete file "param.txt"
save array "param.txt",param(60)
delete file "keymap.txt"
save array "keymap.txt",Config_keymap$(9)
delete file "stats.txt"
save array "Stats.txt",Player_stats(10)
endif
Configjoueur$ = Config_listeprofil$(Config_profilselect)
set dir CheminMA$+"\configs\"+Configjoueur$
load array "param.txt",param(60)
load array "keymap.txt",Config_keymap$(9)
load array "Stats.txt",Player_stats(10)
set dir CheminMA$
delete file "Metal Assault.ini"
open to write 1,"Metal Assault.ini"
write string 1,Configjoueur$
write string 1,Lireintro$
close file 1
return













end
function majconf(menu)
select menu
case 1
cls
ink rgb(255,255,255),1
paste image 10,0,0
set cursor 507,72 : print param(1)
set cursor 392,111 : print param(2)
set cursor 432,148 : print param(3)
set cursor 395,183 : print param(4)
set cursor 530,223 : print param(5)
set cursor 583,264 : print param(6)
set cursor 550,302 : print param(7)
set cursor 587,340 : print param(8)
set cursor 632,383 : print param(9)
set cursor 578,428 : print param(10)
set cursor 468,472 : print param(11)
set cursor 502,514 : print param(12)
set cursor 549,556 : print param(13)
set cursor 595,594 : print param(14)
set cursor 516,634 : print param(15)
set cursor 552,673 : print param(16)
set cursor 585,710 : print param(17)
set cursor 638,735 : print param(18)
set cursor 949,112 : print param(19)
set cursor 918,153 : print param(20)
set cursor 889,194 : print param(21)
set cursor 921,237 : print param(22)
set cursor 956,286 : print param(23)
set cursor 876,327 : print param(24)
set cursor 838,373 : print param(25)
set cursor 876,415 : print param(26)
set cursor 854,464 : print param(27)
set cursor 963,503 : print param(28)
set cursor 887,544 : print param(29)
set cursor 854,589 : print param(30)
endcase
case 2
cls
ink rgb(255,255,255),1
paste image 10,0,0
set cursor 375,135 : print param(35)
set cursor 425,135 : print param(36)
set cursor 433,183 : print param(37)
set cursor 425,237 : print param(38)
set cursor 465,284 : print param(39)
set cursor 414,331 : print param(40)
set cursor 375,378 : print param(41)
set cursor 411,426 : print param(42)
set cursor 471,482 : print param(43)
set cursor 406,525 : print param(44)
set cursor 403,575 : print param(45)
set cursor 433,615 : print param(46)
set cursor 363,659 : print param(47)
endcase
case 3
cls
ink rgb(255,255,255),1
paste image 10,0,0
set cursor 469,105 : print param(31)
set cursor 420,138 : print param(32)
set cursor 460,174 : print param(33)
set cursor 398,223 : print param(34)
endcase
case 4
cls
ink rgb(255,255,255),1
paste image 10,0,0
set cursor 507,72 : print param(1)
set cursor 392,111 : print param(2)
set cursor 432,148 : print param(3)
set cursor 395,183 : print param(4)
set cursor 530,223 : print param(5)
set cursor 583,264 : print param(6)
set cursor 550,302 : print param(7)
set cursor 587,340 : print param(8)
set cursor 632,383 : print param(9)
set cursor 578,428 : print param(10)
set cursor 468,472 : print param(11)
set cursor 502,514 : print param(12)
set cursor 549,556 : print param(13)
set cursor 595,594 : print param(14)
set cursor 516,634 : print param(15)
set cursor 552,673 : print param(16)
set cursor 585,710 : print param(17)
set cursor 638,735 : print param(18)
set cursor 949,112 : print param(19)
set cursor 918,153 : print param(20)
set cursor 889,194 : print param(21)
set cursor 921,237 : print param(22)
set cursor 956,286 : print param(23)
set cursor 876,327 : print param(24)
set cursor 838,373 : print param(25)
set cursor 876,415 : print param(26)
set cursor 854,464 : print param(27)
set cursor 963,503 : print param(28)
set cursor 887,544 : print param(29)
set cursor 854,589 : print param(30)
paste image 11,312,84
set cursor 640,132 :print Config_keymap$(0)
set cursor 640,160 :print Config_keymap$(1)
set cursor 640,186 :print Config_keymap$(2)
set cursor 640,215 :print Config_keymap$(3)
set cursor 610,240 :print Config_keymap$(4)
set cursor 610,270 :print Config_keymap$(5)
set cursor 610,300 :print Config_keymap$(6)
set cursor 640,330 :print Config_keymap$(7)
set cursor 640,365 :print Config_keymap$(8)
for i = 0 to 9
ink rgb(255,255,255),1
temp$ = Config_listeprofil$(i)
if temp$ = Configjoueur$
ink rgb(0,0,255),1
endif
if temp$ = Config_listeprofil$(Config_profilselect)
ink rgb(120,120,120),1
endif
set cursor 360,470+i*15 : print Config_listeprofil$(i)
next i
endcase
endselect
endfunction

function confoption(droite,gauche,haut1,bas1,haut2,bas2,min,max,index)
if boutton(droite,gauche,haut1,bas1) = 1 then inc param(index)
if boutton(droite,gauche,haut2,bas2) = 1 then dec param(index)
if param(index) > max then param(index) = max
if param(index) < min then param(index) = min
majconf(config_menu_id)
endfunction

function getkey(index)
position mouse param(35)/2,param(36)/2
do
if mouseclick() = 0 then exit
loop
set dir CheminMA$+"\jpegs\menu"
load image "Config_Presskey.bmp",12,1
oldmousz = mousez()
do
majconf(config_menu_id)
paste image 12,312,450
if scancode() > 0 or mouseclick() > 0 then exit
mousz = mousez()
if mousz = oldmousz
else
exit
endif
loop
delete image 12
temp  =  scancode()
Config_keymap$(index) = inkey$()
if temp=57 then key$="Espace"
if temp=29 or code=157 then key$="Ctrl"
if temp=42 or code=54 then key$="Maj"
if temp=200 then key$="Up"
if temp=208 then key$="Down"
if temp=203 then key$="Left"
if temp=205 then key$="Right"
if temp = 0
if mouseclick() = 1 then Config_keymap$(index) = "Click gauche"
if mouseclick() = 2 then Config_keymap$(index) = "Click droit"
if mouseclick() = 4 then Config_keymap$(index) = "Click Milieu"
if mousz > oldmousz then Config_keymap$(index) = "Molette haut"
if mousz < oldmousz then Config_keymap$(index) = "Molette Bas"
endif
endfunction temp





Rem *** Include File: Intro.dba ***
Rem Created: 11/12/2007 20:45:37

Rem Included in Project: D:\DBP\Projects\Metal Assault\Metal Assault.dbpro

intro:
set dir CheminMA$+"\jpegs\menu"
set image colorkey 25,25,2
load image "Intro01.jpg",1,1
sprite 1,0,0,1
size sprite 1,param(35),param(36)
set sprite diffuse 1,0,0,0
for t = 0 to 255
set sprite diffuse 1,t,t,t
wait 1
if escapekey() = 1 then goto intro_video
next t
wait 500
x= 256
for t = 0 to 124
dec x,2
set sprite diffuse 1,x,x,x
wait 1
if escapekey() = 1 then goto intro_video
next t

intro_video:

delete image 1
delete sprite 1
set image colorkey 0,0,0

rem la musique
set dir CheminMA$+"\musiques"
load music "menu.mp3",1
loop music 1
set music volume 1,30

rem l'intro
set dir CheminMA$+"\anims"
load animation "Intro.avi",1
place animation 1,0,0,param(35),param(36)
play animation 1
set animation speed 1,125
repeat
until animation playing(1) = 0 or returnkey() = 1 or escapekey() = 1
stop animation 1
place animation 1,0,0,1,1
delete animation 1

return








Rem *** Include File: funtions.dba ***
Rem Created: 03/01/2008 09:15:58

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
function distance(a,b)
   distance#=sqrt((object position x(b)-object position x(a))^2+(object position y(b)-object position y(a))^2+(object position z(b)-object position z(a))^2)
endfunction distance#

function boutton(droite,gauche,haut,bas)
if mouseX() > droite and mouseX() < gauche and mousey() > haut and mouseY() < bas and mouseclick() = 1
result = 1
else
result = 0
endif
endfunction result

function pseudo_input(pos_x AS INTEGER, pos_y AS INTEGER, txt$ AS STRING, max_longueur_ligne AS INTEGER)
   ` si on ne veux pas de son, mettre à 0 la variable : 'jouer_le_son'
   jouer_le_son=0 : son_numero=1023
   ` si on ne veux pas afficher la frappe en cours mettre à 1 la variable : 'cache_caracteres'  (des * seront affichées à la place)
   cache_caracteres=0

   time=TIMER()
   if max_longueur_ligne>0 then max_longueur_ligne=max_longueur_ligne&&255 else max_longueur_ligne=255
   pseu_old_saisie_clavier$=pseu_saisie_clavier$
   pseu_saisie_clavier$=INKEY$()
   if pseu_old_saisie_clavier$<>pseu_saisie_clavier$ then pseu_old_saisie_clavier$=""
   ` si ce n'est pas un caractère alphabétique
   if pseu_saisie_clavier$<" "
      pseu_saisie_clavier$="" : pseu_old_saisie_clavier$=""
      ` alors on teste les touches supp, droite, gauche, etc .
      pseu_old_azerty=pseu_azerty
      pseu_azerty=SCANCODE()
      if pseu_old_azerty<>pseu_azerty then pseu_old_azerty=0
      selection_scancode=0
      if pseu_azerty>pseu_old_azerty
         selection_scancode=pseu_azerty
         ` délai avant répétition
         pseu_newtime=time+500
      endif
      if time >= pseu_newtime
         selection_scancode=pseu_azerty
         ` délai des répétitions
         pseu_newtime=time+30
      endif
   else
      ` sinon on fabrique la chaine de caractère alphabétique
      if pseu_longueur_ligne<max_longueur_ligne
         if pseu_saisie_clavier$>pseu_old_saisie_clavier$
            pseu_ligne$=pseu_a_gauche_du_curseur$+pseu_saisie_clavier$+pseu_a_droite_du_curseur$
            INC pseu_cursor_position
            selection_scancode=1
            ` délai avant répétition
            pseu_newtime=time+500
            play_son=jouer_le_son
         endif
         if time >= pseu_newtime
            pseu_ligne$=pseu_a_gauche_du_curseur$+pseu_saisie_clavier$+pseu_a_droite_du_curseur$
            INC pseu_cursor_position
            selection_scancode=1
            ` délai des répétitions
            pseu_newtime=time+30
            play_son=jouer_le_son
         endif
      endif
   endif

   ` mise à jour des chaines de caratère
   pseu_longueur_ligne=LEN(pseu_ligne$)
   pseu_a_gauche_du_curseur$=LEFT$(pseu_ligne$,pseu_cursor_position-1)
   pseu_a_droite_du_curseur$=RIGHT$(pseu_ligne$,pseu_longueur_ligne-pseu_cursor_position+1)
   screen_cursor=TEXT WIDTH(txt$+pseu_a_gauche_du_curseur$)

   ` on bloque le clignotement du curseur pendant l'appui/répétion d'une touche
   if selection_scancode then pseu_curseur_visible=TIMER()

   select selection_scancode
      ` backspace
      case 14
         if pseu_longueur_ligne>0
            DEC pseu_cursor_position
            if pseu_cursor_position<1 then pseu_cursor_position=1 else play_son=jouer_le_son
            pseu_ligne$=LEFT$(pseu_a_gauche_du_curseur$,pseu_cursor_position-1)+pseu_a_droite_du_curseur$
            fr=pseu_cursor_position-1
         endif
      endcase

      ` supprime
      case 211
         if LEN(pseu_a_droite_du_curseur$)>0
            play_son=jouer_le_son
            pseu_ligne$=pseu_a_gauche_du_curseur$+RIGHT$(pseu_a_droite_du_curseur$,pseu_longueur_ligne-pseu_cursor_position)
         endif
      endcase

      ` return
      case 28
         pseu_ligne_final$=pseu_ligne$
         pseu_ligne$=""
         pseu_a_gauche_du_curseur$=""
         pseu_a_droite_du_curseur$=""
         pseu_saisie_clavier$=""
         pseu_old_saisie_clavier$=""
         pseu_cursor_position=1
      endcase

      ` enter
      case 156
         pseu_ligne_final$=pseu_ligne$
         pseu_ligne$=""
         pseu_a_gauche_du_curseur$=""
         pseu_a_droite_du_curseur$=""
         pseu_saisie_clavier$=""
         pseu_old_saisie_clavier$=""
         pseu_cursor_position=1
      endcase

      ` gauche
      case 203
         DEC pseu_cursor_position
         if pseu_cursor_position<1 then pseu_cursor_position=1 else play_son=jouer_le_son
      endcase

      ` droite
      case 205
         if pseu_cursor_position<pseu_longueur_ligne+1 then INC pseu_cursor_position : play_son=jouer_le_son
      endcase

      ` end
      case 207
         pseu_cursor_position=pseu_longueur_ligne+1
      endcase

      ` home
      case 199
         pseu_cursor_position=1
      endcase

   endselect

   ` affichage de la ligne en cours de frappe
   if cache_caracteres
      for i=1 TO pseu_longueur_ligne
      tmp$=tmp$+"*"
      next i
      ` affiche des *
      screen_cursor=TEXT WIDTH(txt$+LEFT$(tmp$,pseu_cursor_position-1))
      TEXT pos_x,pos_y,txt$+tmp$
   else
      ` sinon affiche le texte en clair
      TEXT pos_x,pos_y,txt$+pseu_ligne$
   endif


   `  et d'un curseur
   if TIMER()<=pseu_curseur_visible+500
      ` vertical clignotant
      TEXT pos_x+screen_cursor-(TEXT WIDTH("|")/2),pos_y,"|"

      ` ou horizontal clignotant
      ` TEXT pos_x+screen_cursor,pos_y,"_"
   else
      if TIMER()>pseu_curseur_visible+1000 then pseu_curseur_visible=time
   endif

   ` jouer un son
   if play_son
      ` joue un son de machine à écrire, par exemple
      if SOUND EXIST(son_numero) then STOP SOUND son_numero : PLAY SOUND son_numero
   endif

endfunction pseu_ligne_final$

function boutton2(gauche,haut,droite,bas)
if mouseX() < droite and gauche < mouseX() and mousey() > haut and mouseY() < bas and mouseclick() = 1
result = 1
else
result = 0
endif
endfunction result

function Survol(gauche,haut,droite,bas)
if mouseX() < droite and gauche < mouseX() and mousey() > haut and mouseY() < bas
result = 1
else
result = 0
endif
endfunction result

function texte(i,tx$,f$,t,t$)
 if t>85 then  mt#=t/85.0:t=85
 load bitmap t$,1 : create bitmap 2,1024,t
 set text font f$ : set text size t : set text opaque
 ink RGB(0,0,0),RGB(20,20,20)
 for a=1 to 20:tx$=tx$ +"                 ":next
 print tx$ : get image i,0,0,1024,t,1
 for a=0 to 1024/t : copy bitmap 1,0,0,bitmap width(1),bitmap height(1),2,a*t,0,a*t+t,t : next
 paste image i,0,0,1 : get image i,0,0,1024,t,1 : delete bitmap 1
 make memblock from image 1,i : px=memblock dword(1,0):py=memblock dword(1,4)
 write memblock dword 1,8,32 : c=memblock dword(1,12)
 for x=0 to px-1
  for y=0 to py-1
  pos=(x+y*px)*4
  if c=memblock dword(1,pos+12)
   write memblock dword 1,pos+12,0
  else
   if x1=0 then x1=x else x2=x
   if y1=0 then y1=y
  endif
  next y
 next x
 make image from memblock i,1
 set current bitmap 2
 cls : paste image i,0,0,1
 if mt#>1
  create bitmap 1,(x2-x1)*mt#,85*mt#
  copy bitmap 2,x1,0,x2,t,1,0,0,(x2-x1)*mt#,85*mt#
  get image i,0,0,(x2-x1)*mt#,85*mt#,1 : delete bitmap 1
 else
  get image i,x1,0,x2,t,1
 endif
 delete bitmap 2 : set current bitmap 0
endfunction

function New_txt(txt_nb,string$,txt_size,red,green,blue,X,Y,img_nb,sprite_nb)
if txt(txt_nb).temp = 0
txt(txt_nb).string$ = string$
txt(txt_nb).size = txt_size
txt(txt_nb).red = red
txt(txt_nb).green =green
txt(txt_nb).blue = blue
txt(txt_nb).X = X
txt(txt_nb).Y = Y
txt(txt_nb).img_nb = img_nb
txt(txt_nb).sprite_nb = sprite_nb
else
txt(txt_nb).temp = 0
set sprite alpha txt(txt_nb).sprite_nb,0
txt(txt_nb).string$ = string$
txt(txt_nb).size = txt_size
txt(txt_nb).red = red
txt(txt_nb).green =green
txt(txt_nb).blue = blue
txt(txt_nb).X = X
txt(txt_nb).Y = Y
txt(txt_nb).img_nb = img_nb
txt(txt_nb).sprite_nb = sprite_nb
endif
set text size txt_size
set text to normal
ink rgb(red,green,blue),1
set cursor 0,0
create bitmap 1,text width(string$),text height(string$)+1
print string$
get image img_nb,0,3,text width(string$),text height(string$)
delete bitmap 1
txt(txt_nb).temp = 255
sprite txt(txt_nb).sprite_nb,txt(txt_nb).X,txt(txt_nb).Y,txt(txt_nb).img_nb
show sprite txt(txt_nb).sprite_nb
set sprite alpha sprite_nb,txt(txt_nb).temp
offset sprite sprite_nb,sprite width(sprite_nb)/2,sprite height(sprite_nb)/2
ink rgb(255,255,255),1
set text size 16
endfunction

function Update_txt(txt_nb,speed)
txt(txt_nb).lastspeed = speed
if txt(txt_nb).temp > speed then dec txt(txt_nb).temp,speed : else : txt(txt_nb).temp = 0 : hide sprite txt(txt_nb).sprite_nb
set sprite alpha txt(txt_nb).sprite_nb,txt(txt_nb).temp
sprite txt(txt_nb).sprite_nb,txt(txt_nb).X,txt(txt_nb).Y,txt(txt_nb).img_nb
endfunction

function txt_exist(txt_nb)
if txt(txt_nb).temp > txt(txt_nb).lastspeed then result =1 else result = 0
endfunction result

function reset_txt(txt_nb,valeur)
if valeur = 0 then valeur = 255
txt(txt_nb).temp = valeur
show sprite txt(txt_nb).sprite_nb
endfunction

function update_fx(alpha,bloom_on,spec,temp) `fx
REM Prepare
set camera to image 0,100000,1024,1024
sprite 100000,0,0,100000
set sprite 100000,0,1
size sprite 100000,screen width(),screen height()
REM Motion blur
set sprite alpha 100000,alpha
REM Soft
if bloom_on=1
if sprite exist(100001)=0
sprite 100001,screen width()/2,screen height()/2,100000
set sprite 100001,0,1
offset sprite 100001,screen width()/2,screen height()/2
set sprite alpha 100001,35
clone sprite 100001,100002:clone sprite 100001,100003
clone sprite 100001,100004:clone sprite 100001,100005
size sprite 100001,screen width()+10,screen height()+10
size sprite 100002,screen width()+5,screen height()
size sprite 100003,screen width()+10,screen height()
size sprite 100004,screen width(),screen height()+5
size sprite 100005,screen width(),screen height()+10
endif
set ambient light 25
show sprite 100001:show sprite 100002
show sprite 100003:show sprite 100004
show sprite 100005
else
if sprite exist(100001)=1
hide sprite 100001:hide sprite 100002
hide sprite 100003:hide sprite 100004
hide sprite 100005
endif
set ambient light 20
endif
REM Misc fx
REM Quake
if spec=1
paste sprite 100000,0+rnd(2)-rnd(2),0+rnd(2)-rnd(2)
endif
REM Unnormal
if spec=2
if sprite exist(100006)=0
sprite 100006,screen width()/2,screen height()/2,100000
offset sprite 100006,screen width()/2,screen height()/2
set sprite 100006,0,1
size sprite 100006,screen width(),screen height()
set sprite alpha 100006,50
clone sprite 100006,100007:clone sprite 100006,100008
clone sprite 100006,100009
endif
rotate sprite 100006,wrapvalue(temp)
rotate sprite 100007,360-wrapvalue(temp)
rotate sprite 100008,wrapvalue(180+temp)
rotate sprite 100009,wrapvalue(180-temp)
show sprite 100006:show sprite 100007
show sprite 100008:show sprite 100009
else
if sprite exist(100006)=1
hide sprite 100006:hide sprite 100007
hide sprite 100008:hide sprite 100009
endif
endif
REM Lines
if spec=3
for t=1 to 100
sprite 100010+(t-1),0,(t-1)*(screen height()/100),100000
size sprite 100010+(t-1),screen width(),screen height()/100
set sprite alpha 100010+(t-1),10
show sprite 100010+(t-1)
next t
else
if sprite exist(100010)=1
for t=1 to 100
hide sprite 100010+(t-1)
next t
endif
endif
endfunction

function distance2D(X1,Y1,X2,Y2)
result = sqrt((X2-X1)^2+(Y2-Y1)^2)
endfunction result

remstart
Technique
0 Reflection + Refraction
1 Idem, mais en moins bien
2 Reflection
3 RefrAction
4 Reflection Coloriée
5 Reflection Texturée
remend




Function Make_old_eau(index,ObjNum,ImgNum,FXNum,CamA,CamB,technique,R,G,B,Image$,SX,SZ,X,WaterHeight#,Z,Ghost)

Water(index).ObjNum = ObjNum
Water(index).ImgNum = ImgNum
Water(index).FxNum = FxNum
Water(index).technique = technique
Water(index).R = R
Water(index).G = G
Water(index).B = B
Water(index).Image$ = Image$
Water(index).SX = SX
Water(index).SZ = SZ
Water(index).WaterHeight# = WaterHeight#
Water(index).Ghost = Ghost
Water(index).CamA = CamA
Water(index).CamB = CamB

set dir CheminMA$+"\FX\Water\"
if effect exist(Water(index).FXNum) = 0 then load effect "Fresnel Water.fx",Water(index).FXNum,0
      if Water(index).technique=0
            set effect technique FXNum,"FresnelRefractReflect"
            Water(index).Refract=1
            Water(index).Reflect=1
      endif
      if technique=1
            set effect technique FXNum,"RefractReflect"
            Water(index).Refract=1
            Water(index).Reflect=1
      endif
      if technique=2
            set effect technique FXNum,"Reflect"
            Water(index).Refract=0
            Water(index).Reflect=1
      endif
      if technique=3
            set effect technique FXNum,"Refract"
            Water(index).Refract=1
            Water(index).Reflect=0
      endif
      if technique=4
            set effect technique FXNum,"Refract"
            Water(index).Refract=1
            Water(index).Reflect=0
      endif
      if technique=5
            set effect technique FXNum,"Refract"
            Water(index).Refract=1
            Water(index).Reflect=0
      endif
            make camera Water(index).CamA
            set camera range Water(index).CamA,1,50000
            set camera aspect Water(index).CamA,1.325
            backdrop off Water(index).CamA
            set camera fov Water(index).CamA,65
            if Water(index).technique>3
            if Water(index).technique=4
            create bitmap 1,512,512
            ink RGB(Water(index).R,Water(index).G,Water(index).B),0
            box 0,0,512,512
            get image ImgNum,0,0,512,512
            delete bitmap 1
            ink rgb(255,255,255),0
            endif
            if Water(index).technique=5
            Load image Water(index).Image$,Water(index).ImgNum
            endif
            else
            set camera to image Water(index).CamA,Water(index).ImgNum,256,256 ` 512 pour plus de kalité
            endif

            make camera Water(index).CamB
            set camera range Water(index).CamB,1,50000
            set camera aspect Water(index).CamB,1.325
            backdrop off Water(index).CamB
            set camera to image Water(index).CamB,Water(index).ImgNum+1,256,256 ` 512 pour plus de kalité
            set camera fov Water(index).CamB,65

            load image "Waves.dds",Water(index).ImgNum+2
            make object plain Water(index).ObjNum,Water(index).SX,Water(index).SZ
            texture object Water(index).ObjNum,0,Water(index).ImgNum+2
            texture object Water(index).ObjNum,1,Water(index).ImgNum
            texture object Water(index).ObjNum,2,Water(index).ImgNum+1
            set object effect Water(index).ObjNum,Water(index).FXNum
            xrotate object Water(index).ObjNum,270
            set object transparency Water(index).ObjNum,1
            if Water(index).ghost > 0 then ghost object on Water(index).ObjNum,Water(index).ghost-1
endfunction

function Update_old_eau(index)

         `UpDate Water plain
            position object Water(index).ObjNum,object position x(Water(index).ObjNum),Water(index).WaterHeight#,object position z(Water(index).ObjNum)
            Water(index).WaterCamY#=camera position y()-Water(index).WaterHeight#
            Hide object Water(index).ObjNum

   `Upade Refract/Reflect cameras
   if Water(index).Refract=1
            `UpDate Refraction camera
           position camera Water(index).CamA,camera position x(),camera position y(),camera position z()
           rotate camera Water(index).CamA,camera angle x(),camera angle y(),camera angle z()

         `Clip Camera
           set camera clip Water(index).CamA,1,0,Water(index).WaterHeight#+(5+Water(index).WaterCamY#/25),0,0,-1,0
           set camera clip Water(index).CamB,0,0,0,0,0,0,0

         `Only sync Camera 30
            sync mask 0x40000000
            fastsync
            fog off
   endif

   if Water(index).Reflect=1
            `UpDate Reflection camera
            position camera Water(index).CamB,camera position x(),Water(index).WaterHeight#-Water(index).WaterCamY#,camera position z()
            rotate camera Water(index).CamB,-camera angle x(),camera angle y(),camera angle z()

         `Clip Camera
            Water(index).ClipY#=Water(index).WaterCamY#
            if Water(index).ClipY#>100 then Water(index).ClipY#=100
            set camera clip Water(index).CamB,1,0,Water(index).WaterHeight#-(1+(Water(index).ClipY#/25)),0,0,1,0
            set camera clip Water(index).CamA,0,0,0,0,0,0,0

`Only sync Camera 31
            sync mask 0x80000000
            fastsync
   endif

         `Show Water
            show object Water(index).ObjNum


         `Mask
            sync mask 0x3fffffff

      endfunction

remstart
Ocean Params comments :
Index : meme que celui de de Water, obligatoirement unique
OBJnum : un n° j'objet libre pour y faire l'eau (plain)
ImgnumX : image libre pour y faire des rendu intermédiaires
Fxnum : un n° de shader libre
WaterHeight# : le niveau de l'eau (Ypos du plain)
SX et SZ : les dimentions X et Z de l'eau (du plain)
X et Z : Position de l'eau (du plain)
CamX : deux n° de cameras libres
remend

Function make_Ocean(index,objnum,imgnum,imgnum2,imgnum3,imgnum4,FXNum,WaterHeight#,SX,SZ,X,Z,CamA,CamB)
Water_Exist = 1
Water(index).ObjNum = ObjNum
Water(index).ImgNum = ImgNum
Water(index).ImgNum2 = ImgNum2
Water(index).ImgNum3 = ImgNum3
Water(index).ImgNum4 = ImgNum4
Water(index).FxNum = FxNum
Water(index).SX = SX
Water(index).SZ = SZ
Water(index).X = X
Water(index).Z = Z
Water(index).WaterHeight# = WaterHeight#
Water(index).CamA = CamA
Water(index).CamB = CamB
      load image CheminMA$ + "\FX\Ocean\Waves.dds",imgnum3
      load image CheminMA$ + "\FX\Ocean\Fresnel.bmp",imgnum4
      make object plain objnum,SX,SY
      position object objnum,X,WaterHeight#,Z
      texture object objnum,0,imgnum
      texture object objnum,1,imgnum2
      texture object objnum,2,imgnum3
      texture object objnum,3,imgnum4
      xrotate object objnum,90
      load effect CheminMA$ + "\FX\Ocean\Water.fx",FXNum,0
      set object effect objnum,FXNum
Endfunction






function Update_Ocean(Index)

   `UpDate Water plain
      Hide object Water(index).ObjNum

   `Upade Refract/Reflect cameras
      set effect technique Water(index).FxNum,"Refract"
 position camera Water(index).CamA,camera position x(),camera position y(),camera position z()
   rotate camera Water(index).CamA,camera angle x(),camera angle y(),camera angle z()
   if camera position y()>Water(index).WaterHeight#
      set camera clip Water(index).CamA,1,0,Water(index).WaterHeight#+8,0,0,-1,0
   endif
   if camera position y()<Water(index).WaterHeight#
      set camera clip Water(index).CamA,1,0,Water(index).WaterHeight#-8,0,0,1,0
   endif
   set camera clip Water(index).CamB,0,0,0,0,0,0,0
   sync mask 2^Water(index).CamA
   fastsync


      if camera position y()>Water(index).WaterHeight#
         set effect technique Water(index).FxNum,"ReflectRefract"
   position camera Water(index).CamB,camera position x(),Water(index).WaterHeight#-(camera position y()-Water(index).WaterHeight#),camera position z()
   rotate camera Water(index).CamB,-camera angle x(),camera angle y(),camera angle z()
   set camera clip Water(index).CamA,0,0,0,0,0,0,0
   set camera clip Water(index).CamB,1,0,Water(index).WaterHeight#-4,0,0,1,0
   sync mask 2^Water(index).CamB
   fastsync
      endif

   `Show Water
      show object Water(index).ObjNum
      sync mask 2^0

endfunction

function make_contour(num,obj1,obj2,img,epaisseur)
contour(num,1) = obj1
contour(num,2) = obj2
contour(num,3) = img
contour(num,4) = 0
create bitmap 1,1,1
dot 0,0
get image img,0,0,1,1
delete bitmap 1
clone object obj2,obj1
texture object obj2,img
scale object obj2,((object size x(obj1)+epaisseur)/object size x(obj1))*-100,((object size y(obj1)+epaisseur)/object size y(obj1))*-100,((object size z(obj1)+epaisseur)/object size z(obj1))*-100
set object light obj2,0
endfunction

function set_contour_color_speed(num,speed)
contour(num,4) = speed
endfunction

function update_contour(num)
rotate object contour(num,2),object angle x(contour(num,1)),object angle y(contour(num,1)),object angle z(contour(num,1))
position object contour(num,2),object position x(contour(num,1)),object position y(contour(num,1)),object position z(contour(num,1))
if contour(num,4) > 0 then SET ALPHA MAPPING ON contour(num,2),abs(100*sin(timer()/contour(num,4)))
endfunction

function get_contour_data(num,object) : rem 1 ==> objet source  2 ==> object de contour 3 ==> image de texture de l'objet contour
a = contour(num,object)
endfunction a

function delete_contour(num,flag) : rem Si flag = 1 ==> delete object source aussi
delete object contour(num,2)
if flag = 1 then delete object contour(num,1)
delete image contour(num,3)
contour(num,1) = 0
contour(num,2) = 0
contour(num,3) = 0
endfunction















































































































































































Rem *** Include File: Script.dba ***
Rem Created: 13/04/2008 12:23:24

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
Solo_Script_lecture:
set dir CheminMA$+"\cartes\"+type_game$+"\"+game_carte$+"\"
if file exist(game_carte$ + ".ini") = 1
open to read 1,game_carte$ + ".ini"


read string 1,Script_nblignes$
Script_nblignes = val(Script_nblignes$)

for t = 0 to Script_nblignes
read string 1,temp$
Script_datas$(t) = temp$
next t

for i = 1 to Script_nblignes+1
Script_temp1$ = lower$(Script_datas$(i-1))
Script_temp2$ = Script_datas$(i)
Script_temp3$ = Script_datas$(i+1)
Script_temp4$ = Script_datas$(i+2)



  select Script_temp1$
  case "[scale]"
  scale object 1,val(Script_temp2$),val(Script_temp3$),val(Script_temp4$)
  endcase
   case "[ghost]"
   if val(Script_temp2$) = 1 then ghost object on 1
   endcase
   case "[backdrop color]"
   color backdrop rgb(val(Script_temp2$),val(Script_temp3$),val(Script_temp4$))
   endcase
   case "[sky diameter]"
   scale object 5,val(Script_temp2$)*-1,val(Script_temp3$)*-1,val(Script_temp4$)*-1
   SKY_SCALED  = 1
   endcase
   case "[sky orientation]"
   rotate object 5,val(Script_temp2$),val(Script_temp3$),val(Script_temp4$)
   endcase
   case "[sky rotation]"
   rotate_sky_x = val(Script_temp2$)
   rotate_sky_y = val(Script_temp3$)
   rotate_sky_z = val(Script_temp4$)
   endcase
   case "[sky rotation speed]"
   sky_speed = val(Script_temp2$)
   endcase
   case "[y frag level]"
   Yfrag_level = val(Script_temp2$)*-1
   endcase
   case "[goliath]"
   Goliaths(nb_goliath).x = val(Script_temp2$)
   Goliaths(nb_goliath).y = val(Script_temp3$)
   Goliaths(nb_goliath).z = val(Script_temp4$)
   inc nb_goliath
   endcase
   case "[water]"
   Water = 1
   Water_level = val(Script_temp2$)
   endcase
   case "[vautour]"
   Vautours(nb_vautour).x# = val(Script_temp2$)
   Vautours(nb_vautour).y# = val(Script_temp3$)
   Vautours(nb_vautour).z# = val(Script_temp4$)
   inc nb_vautour
   endcase
   case "[escompide]"
   Escompides(nb_Escompide).x# = val(Script_temp2$)
   Escompides(nb_Escompide).y# = val(Script_temp3$)
   Escompides(nb_Escompide).z# = val(Script_temp4$)
   inc nb_Escompide
   endcase
   case "[v2ci]"
   v2cis(nb_v2ci).x# = val(Script_temp2$)
   v2cis(nb_v2ci).y# = val(Script_temp3$)
   v2cis(nb_v2ci).z# = val(Script_temp4$)
   inc nb_v2ci
   endcase
   case "[motod]"
   MotoDs(nb_MotoD).x# = val(Script_temp2$)
   MotoDs(nb_MotoD).y# = val(Script_temp3$)
   MotoDs(nb_MotoD).z# = val(Script_temp4$)
   inc nb_motod
   endcase
   case "[coléoptère]"
   coleopteres(nb_coleoptere).x# = val(Script_temp2$)
   coleopteres(nb_coleoptere).y# = val(Script_temp3$)
   coleopteres(nb_coleoptere).z# = val(Script_temp4$)
   inc nb_coleoptere
   endcase
   endselect

next i
close file 1
script_found  =1
else
script_found  =0
scale object 5,-18000,-18000,-18000
sc_setupobject 5,5,0
Yfrag_level = -999999
endif
if SKY_SCALED  = 0 then scale object 5,-20000,-20000,-20000

rem a enlever losque tout sa serat au point
script_found  =1




return

















Rem *** Include File: Multi_Rejoindre.dba ***
Rem Created: 19/04/2008 17:27:19

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
Multi_Rejoindre:
set dir CheminMA$+"\jpegs\menu"
hide sprite 1
hide sprite 2
delete object 1
set image colorkey 0,252,0
load image "Multi_PartieSelect.jpg",4,1
Multi_Rejoindre_etatptispoints# = 0


do
rem l'extrapolation
NewExtrapolationTimer=timer()
Extrapolation=(NewExtrapolationTimer-OldExtrapolationTimer)/2
print Extrapolation
OldExtrapolationTimer=NewExtrapolationTimer
rem le boutton retour
if boutton2(0,84,220,134)
delete image 4
show sprite 1
show sprite 2
set image colorkey 0,0,0
goto debut
endif
rem l'affichage
paste image 4,0,0,4
if Multi_Rejoindre_etatptispoints# = 0
set cursor 70,200
print "Recherche d'un serveur"
inc Multi_Rejoindre_etatptispoints#,0.05
endif
if Multi_Rejoindre_etatptispoints# > 0 and  Multi_Rejoindre_etatptispoints# <= 1
set cursor 70,200
print "Recherche d'un serveur"
inc Multi_Rejoindre_etatptispoints#,0.05
endif
if Multi_Rejoindre_etatptispoints# > 1 and  Multi_Rejoindre_etatptispoints# <= 2
set cursor 70,200
print "Recherche d'un serveur."
inc Multi_Rejoindre_etatptispoints#,0.05
endif
if Multi_Rejoindre_etatptispoints# > 2 and  Multi_Rejoindre_etatptispoints# <= 3
set cursor 70,200
print "Recherche d'un serveur.."
inc Multi_Rejoindre_etatptispoints#,0.05
endif
if Multi_Rejoindre_etatptispoints# > 3
set cursor 70,200
print "Recherche d'un serveur..."
inc Multi_Rejoindre_etatptispoints#,0.05
endif
if Multi_Rejoindre_etatptispoints# > 4
Multi_Rejoindre_etatptispoints# = 0
endif
loop


Rem *** Include File: Config_arme.dba ***
Rem Created: 28/05/2008 07:03:30

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
Config_arme:
show mouse
show mouse
set text size 24
set text to bold
set image colorkey 0,0,0
set dir CheminMA$+"\Jpegs\Jeu\market"
load image "menu.jpg",17,1
load image "Element.bmp",18,1


set dir CheminMA$+"\Jpegs\Jeu\market"
load image "menu.jpg",17,1
load image "Element.bmp",18,1


for t = 0 to 100
if game_arme_embaquee(t) = 1
select t

case 10
do
paste image 17,0,0
sprite 18,0,0,18

set cursor 0,param(36)-100
ink rgb(255,255,255),0
print "Solde (initiale) : ",Player_stats(0)
ink rgb(0,0,0),0
set cursor 304,15
set text size 72
ink rgb(30,30,30),0
print listarme(t).name$
ink rgb(0,0,0),0
set text size 24

set cursor 250,170
if Glock_17_Silencieux = 1
   ink rgb(255,0,0),0
   print "Silencieux  (100 €)"
   ink rgb(0,0,0),0
else
   print "Silencieux  (100 €)"
endif


if boutton2(227,156,400,200)
if Glock_17_Silencieux = 1
do
if mouseclick() =  0 then exit
loop
Glock_17_Silencieux = 0
else
do
if mouseclick() =  0 then exit
loop
Glock_17_Silencieux = 1
endif
endif

if boutton2(750,690,1015,758)
   do
   if mouseclick() =  0 then exit
   loop
   exit
endif

loop
if sprite exist(18) then delete sprite 18
if sprite exist(19) then delete sprite 19
if sprite exist(20) then delete sprite 20
if sprite exist(21) then delete sprite 21
endcase

case 40
do
paste image 17,0,0
sprite 18,0,0,18
sprite 19,0,200,18
sprite 20,0,400,18
sprite 21,400,130,18

set cursor 0,param(36)-100
ink rgb(255,255,255),0
print "Solde (initiale) : ",Player_stats(0)
ink rgb(0,0,0),0
set cursor 304,15
set text size 72
ink rgb(30,30,30),0
print listarme(t).name$
ink rgb(0,0,0),0
set text size 24

set cursor 250,170
if Famas_Silencieux = 1
   ink rgb(255,0,0),0
   print "Silencieux  (300 €)"
   ink rgb(0,0,0),0
else
   print "Silencieux  (300 €)"
endif

set cursor 250,380
if Famas_Lazer = 1
   ink rgb(255,0,0),0
   print "Lazer  (350 €)"
   ink rgb(0,0,0),0
else
   print "Lazer  (350 €)"
endif

set cursor 250,580
if Famas_ACOG = 1
   ink rgb(255,0,0),0
   print "Viseur A.C.O.G.  (500 €)"
   ink rgb(0,0,0),0
else
   print "Viseur A.C.O.G.  (500 €)"
endif

set cursor 650,300
if Famas_Vlourd = 1
   ink rgb(255,0,0),0
   print "Version Lourde  (1500 €)"
   ink rgb(0,0,0),0
else
   print "Version Lourde  (1500 €)"
endif

if boutton2(227,156,400,200)
   if Famas_Silencieux = 1
      do
      if mouseclick() =  0 then exit
      loop
      Famas_Silencieux = 0
   else
      do
      if mouseclick() =  0 then exit
      loop
      Famas_Silencieux = 1
   endif
endif

if boutton2(227,356,400,400)
   if Famas_Lazer = 1
      do
      if mouseclick() =  0 then exit
      loop
      Famas_Lazer = 0
   else
      do
      if mouseclick() =  0 then exit
      loop
      Famas_Lazer = 1
      Famas_ACOG = 0
   endif
endif

if boutton2(227,556,400,600)
   if Famas_ACOG = 1
      do
      if mouseclick() =  0 then exit
      loop
      Famas_ACOG = 0
   else
      do
      if mouseclick() =  0 then exit
      loop
      Famas_ACOG = 1
      Famas_Lazer = 0
   endif
endif

if boutton2(627,286,830,330)
   if Famas_Vlourd = 1
      do
      if mouseclick() =  0 then exit
      loop
      Famas_Vlourd = 0
   else
      do
      if mouseclick() =  0 then exit
      loop
      Famas_Vlourd = 1
   endif
endif

if boutton2(750,690,1015,758)
   do
   if mouseclick() =  0 then exit
   loop
   exit
endif

loop
if sprite exist(18) then delete sprite 18
if sprite exist(19) then delete sprite 19
if sprite exist(20) then delete sprite 20
if sprite exist(21) then delete sprite 21
endcase

case 41
do
paste image 17,0,0
sprite 18,0,0,18
sprite 19,0,200,18

set cursor 0,param(36)-100
ink rgb(255,255,255),0
print "Solde (initiale) : ",Player_stats(0)
ink rgb(0,0,0),0
set cursor 304,15
set text size 72
ink rgb(30,30,30),0
print listarme(t).name$
ink rgb(0,0,0),0
set text size 24

set cursor 250,170
if Ak_74_Silencieux = 1
   ink rgb(255,0,0),0
   print "Silencieux  (300 €)"
   ink rgb(0,0,0),0
else
   print "Silencieux  (300 €)"
endif

set cursor 250,380
if AK_74_Lazer = 1
   ink rgb(255,0,0),0
   print "Lazer  (300 €)"
   ink rgb(0,0,0),0
else
   print "Lazer  (300 €)"
endif

if boutton2(227,156,400,200)
if Ak_74_Silencieux = 1
do
if mouseclick() =  0 then exit
loop
Ak_74_Silencieux = 0
else
do
if mouseclick() =  0 then exit
loop
Ak_74_Silencieux = 1
endif
endif

if boutton2(227,356,400,400)
   if AK_74_Lazer = 1
      do
      if mouseclick() =  0 then exit
      loop
      AK_74_Lazer = 0
   else
      do
      if mouseclick() =  0 then exit
      loop
      AK_74_Lazer = 1
   endif
endif

if boutton2(750,690,1015,758)
   do
   if mouseclick() =  0 then exit
   loop
   exit
endif

loop
if sprite exist(18) then delete sprite 18
if sprite exist(19) then delete sprite 19
if sprite exist(20) then delete sprite 20
if sprite exist(21) then delete sprite 21
endcase

case 70
do
paste image 17,0,0
sprite 18,0,0,18
set cursor 0,param(36)-100
ink rgb(255,255,255),0
print "Solde (initiale) : ",Player_stats(0)
ink rgb(0,0,0),0

set cursor 304,15
set text size 72
ink rgb(30,30,30),0
print listarme(t).name$
ink rgb(0,0,0),0
set text size 24

set cursor 250,170
if CsniperR_Silencieux = 1
   ink rgb(255,0,0),0
   print "Silencieux  (1800 €)"
   ink rgb(0,0,0),0
else
   print "Silencieux  (1800 €)"
endif

if boutton2(227,156,400,200)
if CsniperR_Silencieux = 1
do
if mouseclick() =  0 then exit
loop
CsniperR_Silencieux = 0
else
do
if mouseclick() =  0 then exit
loop
CsniperR_Silencieux = 1
endif
endif

if boutton2(750,690,1015,758)
   do
   if mouseclick() =  0 then exit
   loop
   exit
endif

loop
endcase

endselect
endif
next t


if sprite exist(18) then delete sprite 18
if sprite exist(19) then delete sprite 19
if sprite exist(20) then delete sprite 20
if sprite exist(21) then delete sprite 21
hide mouse
delete image 17
delete image 18
set text size 12
set text to normal

if Glock_17_Silencieux = 1 then dec Player_stats(0),100
if Famas_Silencieux = 1 then dec Player_stats(0),300
if Famas_Lazer = 1 then dec Player_stats(0),350
if Famas_ACOG = 1 then dec Player_stats(0),500
if Famas_Vlourd = 1 then dec Player_stats(0),1500
if Ak_74_Silencieux = 1 then dec Player_stats(0),300
if Ak_74_lazer = 1 then dec Player_stats(0),300
if CsniperR_Silencieux = 1 then dec Player_stats(0),1800
set dir CheminMA$+"\configs\"+Configjoueur$
delete file "stats.txt"
save array "Stats.txt",Player_stats(10)
return

Rem *** Include File: Bases de données.dba ***
Rem Created: 25/06/2008 12:04:10

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
Setup_database:
i = 0
nomhumain$(i) = "Roger"
inc i
nomhumain$(i) = "Robert"
inc i
nomhumain$(i) = "bertrand"
inc i
nomhumain$(i) = "gugus"
inc i
nomhumain$(i) = "Anonyme"
inc i
nomhumain$(i) = "Antoine"
inc i
nomhumain$(i) = "Gurvan"
inc i
nomhumain$(i) = "Colomban"
inc i
nomhumain$(i) = "Edouard"
inc i
nomhumain$(i) = "Marc"
inc i
nomhumain$(i) = "marin"
inc i
nomhumain$(i) = "Charles"
inc i
nomhumain$(i) = "Philipe"
inc i
nomhumain$(i) = "Roland"
inc i
nomhumain$(i) = "louis"
inc i
nomhumain$(i) = "Kevin"
inc i
nomhumain$(i) = "Paul"
inc i
nomhumain$(i) = "Damien"
inc i
nomhumain$(i) = "Raphael"
inc i
nomhumain$(i) = "Malrick"
inc i
nomhumain$(i) = "Romain"
inc i
nomhumain$(i) = "Pierre"
inc i
nomhumain$(i) = "Marie"
inc i
nomhumain$(i) = "Steven"
inc i
nomhumain$(i) = "Thomas"
inc i
nomhumain$(i) = "Alexandre"
inc i
nomhumain$(i) = "Yann"
inc i
nomhumain$(i) = "Gilles"
inc i
nomhumain$(i) = "Alain"
inc i
nomhumain$(i) = "Mathéo"
inc i
nomhumain$(i) = "Mahius"
inc i
nomhumain$(i) = "tristan"
inc i
nomhumain$(i) = "Olivier"
inc i
nomhumain$(i) = "Martin"
inc i
nomhumain$(i) = "Nicolas"
inc i
nomhumain$(i) = "Roméo"
inc i
nomhumain$(i) = "Matthieu"
inc i
nomhumain$(i) = "Jason"
inc i
nomhumain$(i) = "jean"
inc i
nomhumain$(i) = "Hervé"
inc i
nomhumain$(i) = "Stéphane"
inc i
return

Rem *** Include File: Scores.dba ***
Rem Created: 02/07/2008 10:58:09

Rem Included in Project: E:\DBP\Projects\Metal Assault\Metal Assault.dbpro
Scores:
set dir CheminMA$+"\configs\"+Configjoueur$
delete file "stats.txt"
save array "Stats.txt",Player_stats(10)

set dir CheminMA$+"\Jpegs\Jeu"
load image "Scores.jpg",18
set sprite alpha 18,255
show sprite 18

if mort = 0
Bonus = Frag * 500
Player_stats(0) = Player_stats(0) + Bonus
set dir CheminMA$+"\configs\"+Configjoueur$
delete file "stats.txt"
save array "Stats.txt",Player_stats(10)
endif

do
sync
sprite 18,0,0,18
set sprite alpha 18,100

ink RGB(128,128,255),0
set cursor 70,63
print Configjoueur$
set cursor 455,63
print Frag
set cursor 650,63
print mort
set cursor 865,63
if mort > 0
frag# = Frag
mort# = mort
Ratio# = Frag#/mort#
print Ratio#
else
print str$(Frag)+"*"
endif

for t = 0 to nballies-1
set cursor 70,83+t*20
print allie(t).name$
set cursor 455,83+t*20
print allie(t).frag
set cursor 650,83+t*20
print allie(t).mort
set cursor 865,83+t*20
if allie(t).mort > 0
temp1# =allie(t).frag
temp2# =allie(t).mort
Ratio# = temp1#/temp2#
print Ratio#
else
print str$(allie(t).frag) + "*"
endif
next t

ink RGB(255,0,0),0
for t = nballies to nballies+NbBot-1
set cursor 70,83+t*20
print bot(t).name$
set cursor 455,83+t*20
print bot(t).frag
set cursor 650,83+t*20
print bot(t).mort
set cursor 865,83+t*20
if bot(t).mort > 0
temp1# =bot(t).frag
temp2# =bot(t).mort
Ratio# = temp1#/temp2#
print Ratio#
else
print str$(bot(t).frag) + "*"
endif
next t


if Match_Mort_RHL_PTS > Match_Mort_CID_PTS
ink RGB(128,128,255),0
center text param(35)/2,param(36)/2+50,"La RHL l'emporte !"
else
ink RGB(255,0,0),0
center text param(35)/2,param(36)/2+50,"La CID l'emporte !"
endif
if mort = 0
center text param(35)/2,param(36)/2+80,"Pas De Failles ! Bonus : " + str$(Bonus) +"€"
endif

if escapekey() = 1
set dir CheminMA$+"\configs\"+Configjoueur$
delete file "stats.txt"
save array "Stats.txt",Player_stats(10)
close file 1
delete animation 1
for t = 1 to 60000
if object exist(t) = 1 then delete object t
next t
for t = 1 to 60000
if image exist(t) = 1 then delete image t
next t
for t = 1 to 60000
if sprite exist(t) = 1 then delete sprite t
next t
for t = 1 to 60000
if sound exist(t) = 1 then delete sound t
next t
for t = 1 to 60000
if light exist(t) = 1 then delete light t
next t
for t = 1 to 60000
if object exist(t)
SC_setupObject t,0,0
SC_removeObject t
endif
next t
delete music 1
goto debut
endif
loop

return
